$(function () {
  let win = null, vm = null;
  note.on("play.info.rainfall", () => {
    if (win == null) {
      win = new MyWindow($("#module-comparison"), {
        title: "降雨量对比",
        width: "55vw",
        height: "90vh",
        left: "calc(50vw - 55vw/2)",
        top: "calc(50vh - 90vh/2)"
      });
      vm = new Vue({
        el: "#module-comparison",
        data: {
          DOWNLOAD_URL,
          list: [],
          type: "ZY000000",
          width: 100
        },
        methods: {
          loadData() {
            ajaxCallJson({type: this.type}, "/weather/rainfall-image", (data) => {
              data.resflag && (this.list = data.data);
            });
          },
          onWheel(event) {
            this.scale(event.deltaY < 0 ? 1 : -1);
          },
          scale(dir, factor = 5) {
            let width = this.width + dir * factor;
            this.width = Math.min(Math.max(width, 10), 100);
          }
        },
        computed: {
          listed() {
            return this.list.filter(e => e.intv <= 72);
          }
        }
      });
    }
    win.show();
    vm.$nextTick(vm.loadData);
  });
});
// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.9/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../geometry/support/scaleUtils ./ArcGISMapService ./ScaleRangeLayer ../support/ExportImageParameters".split(" "),function(r,t,k,l,c,d,m,n,p,q){return function(h){function b(){var a=h.call(this)||this;a.dpi=96;a.gdbVersion=null;a.imageFormat="png24";a.imageMaxHeight=2048;a.imageMaxWidth=2048;a.imageTransparency=!0;a.loaded=
!1;return a}l(b,h);b.prototype.readImageFormat=function(a,b){return(a=b.supportedImageFormatTypes)&&-1<a.indexOf("PNG32")?"png32":"png24"};b.prototype.createExportImageParameters=function(a,b,d,c){a&&10<=this.version&&(a=a.clone().shiftCentralMeridian());var e=new q({layer:this,scale:m.getScale({extent:a,width:b})}),g=e.toJSON();e.layer=null;e.destroy();var e=!c||!c.rotation||10.3>this.version?{}:{rotation:-c.rotation},f=a&&a.spatialReference,f=f.wkid||JSON.stringify(f.toJSON());c&&null!=c.pixelRatio&&
(g.dpi*=c.pixelRatio);return k({bbox:a&&a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,bboxSR:f,imageSR:f,size:b+","+d},g,e)};c([d.property()],b.prototype,"dpi",void 0);c([d.property()],b.prototype,"gdbVersion",void 0);c([d.property()],b.prototype,"imageFormat",void 0);c([d.reader("imageFormat",["supportedImageFormatTypes"])],b.prototype,"readImageFormat",null);c([d.property({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],b.prototype,"imageMaxHeight",void 0);c([d.property({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],
b.prototype,"imageMaxWidth",void 0);c([d.property()],b.prototype,"imageTransparency",void 0);c([d.property()],b.prototype,"loaded",void 0);return b=c([d.subclass("esri.layers.mixins.ArcGISDynamicMapService")],b)}(d.declared(n,p))});
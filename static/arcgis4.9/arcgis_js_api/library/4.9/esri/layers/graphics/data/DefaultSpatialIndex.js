// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.9/esri/copyright.txt for details.
//>>built
define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../../../core/Error ../../../core/Logger ./FeatureStore".split(" "),function(h,k,n,p,l,q,r){Object.defineProperty(k,"__esModule",{value:!0});var m=q.getLogger("esri.layers.graphics.data.FeatureStore"),g=[];h=function(){function a(b){this._featuresById=new p.default;this._store=new r.default(b)}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._store.featureInfo.geometryType},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"hasM",{get:function(){return this._store.featureInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._store.featureInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._store.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){return this._store.bounds},enumerable:!0,configurable:!0});a.prototype.setEngine=
function(b){this._engine=b};a.prototype.add=function(b){if(b){var c=b.objectId;if(null==c)m.error(new l("featurestore:invalid-feature","feature id is missing",{feature:b}));else{var d=this._featuresById.get(c);d?this._store.replace(d,b):this._store.add(b);this._featuresById.set(c,b);this._clearCache()}}};a.prototype.addMany=function(b){for(var c=0;c<b.length;c++){var d=b[c];if(d){var a=d.objectId;if(null==a)m.error(new l("featurestore:invalid-feature","feature id is missing",{feature:d}));else{var e=
this._featuresById.get(a);e?this._store.replace(e,d):g.push(d);this._featuresById.set(a,d)}}}this._store.addMany(g);g.length=0;this._clearCache()};a.prototype.clear=function(){this._featuresById.clear();this._store.clear();this._clearCache()};a.prototype.removeManyById=function(b){for(var c=0;c<b.length;c++){var a=b[c];this._store.remove(this._featuresById.get(a));this._featuresById.delete(a)}this._clearCache()};a.prototype.forEachBounds=function(b,a){this._store.forEachBounds(b,a)};a.prototype.getAllFeatures=
function(){return n.from(this._featuresById,function(b){return b[1]})};a.prototype.getFeature=function(b){return this._featuresById.get(b)};a.prototype.hasFeature=function(b){return this._featuresById.has(b)};a.prototype.forEachFeatureInBounds=function(b,a){this._store.forEachFeatureInBounds(b,a)};a.prototype.mapFeaturesInBounds=function(b,a){return this._store.mapFeaturesInBounds(b,a)};a.prototype.transferIds=function(b,a){for(var c=[],f=0;f<a.length;f++){var e=this._featuresById.get(a[f]);e&&(this._store.remove(e),
this._featuresById.delete(e.objectId),c.push(e))}b.addMany(c);this._clearCache()};a.prototype.transferIdRange=function(a,c,d){for(var b=[];c<d;c++){var e=this._featuresById.get(c);e&&(this._store.remove(e),this._featuresById.delete(e.objectId),b.push(e))}a.addMany(b);this._clearCache()};a.prototype.transferIf=function(a,c){var b=this,f=[];this._featuresById.forEach(function(a,d){c(a)&&(b._store.remove(a),b._featuresById.delete(a.objectId),f.push(a))});a.addMany(f);this._clearCache()};a.prototype.transferAll=
function(a){var b=this,d=[];this._featuresById.forEach(function(a,c){b._store.remove(a);b._featuresById.delete(a.objectId);d.push(a)});a.addMany(d);this._clearCache()};a.prototype._clearCache=function(){this._engine&&this._engine.clearCache()};return a}();k.default=h});
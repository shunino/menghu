// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.9/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/BreakpointsOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper dojo/dom-class ../core/Accessor ../core/ArrayPool ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ./DOMContainer".split(" "),function(n,m,h,a,l,d,k,g,f,b,e,c){var t={widthBreakpoint:{getValue:function(a){var c=a.viewSize[0];a=a.breakpoints;var b=this.values;return c<=a.xsmall?b.xsmall:c<=a.small?
b.small:c<=a.medium?b.medium:c<=a.large?b.large:b.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",
large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(a){var c=a.viewSize[1];a=a.breakpoints;var b=this.values;return c<=a.xsmall?b.xsmall:c<=a.small?b.small:c<=a.medium?b.medium:
c<=a.large?b.large:b.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",
large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(a){a=a.viewSize;var c=this.values;return a[1]>=a[0]?c.portrait:c.landscape},values:{portrait:"portrait",landscape:"landscape"},
valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},p={xsmall:544,small:768,medium:992,large:1200};return function(c){function k(){var a=null!==c&&c.apply(this,arguments)||this;a._breakpointsHandles=new f;a.breakpoints=p;a.orientation=null;a.widthBreakpoint=null;a.heightBreakpoint=null;return a}h(k,c);k.prototype.initialize=function(){this._breakpointsHandles.add([b.init(this,["breakpoints","size"],this._updateClassNames)])};k.prototype.destroy=
function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)};k.prototype._updateClassNames=function(){if(this.container){var a=g.acquire(),c=g.acquire(),b=!1,e,f,k;for(e in t)f=this[e],k=t[e].getValue({viewSize:this.size,breakpoints:this.breakpoints}),f!==k&&(b=!0,this[e]=k,c.push(t[e].valueToClassName[f]),a.push(t[e].valueToClassName[k]));b&&(this._applyClassNameChanges(a,c),g.release(a),g.release(c))}};k.prototype._applyClassNameChanges=
function(a,c){var b=this.container;b&&(d.remove(b,c),d.add(b,a))};k.prototype._removeActiveClassNames=function(){var a=this.container;if(a)for(var c in t)d.remove(a,t[c].valueToClassName[this[c]])};a([e.property({set:function(a){var c=this._get("breakpoints");if(a!==c){c=(c=a)&&c.xsmall<c.small&&c.small<c.medium&&c.medium<c.large;if(!c){var b=JSON.stringify(p,null,2);console.warn("provided breakpoints are not valid, using defaults:"+b)}a=c?a:p;this._set("breakpoints",l({},a))}}})],k.prototype,"breakpoints",
void 0);a([e.property()],k.prototype,"orientation",void 0);a([e.property()],k.prototype,"widthBreakpoint",void 0);a([e.property()],k.prototype,"heightBreakpoint",void 0);return k=a([e.subclass("esri.views.BreakpointsOwner")],k)}(e.declared(k,c))})},"esri/views/DOMContainer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/dom dojo/dom-construct dojo/on ../core/Accessor ../core/Evented ../core/Handles ../core/scheduling ../core/watchUtils ../core/accessorSupport/decorators ./PopupManager ./overlay/ViewOverlay ../widgets/Popup".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r){var q=[0,0];return function(f){function g(){var a=f.call(this)||this;a._domHandles=new b;a._freqInfo={freq:16,time:750};a._overlayRenderTaskHandle=null;a.height=0;a.popup=new r({view:a});a.position=null;a.resizing=!1;a.root=null;a.surface=null;a.suspended=!0;a.ui=null;a.userContent=null;a.width=0;a.watch("cursor",function(c){var b=a.surface;b&&b.setAttribute("data-cursor",c)});a.watch("interacting",function(c){var b=a.surface;b&&b.setAttribute("data-interacting",
c.toString())});a._focusEvent=a._focusEvent.bind(a);a._blurEvent=a._blurEvent.bind(a);return a}h(g,f);g.prototype.initialize=function(){this.watch("ui",this._handleUIChange);this._wireUI(this.ui)};g.prototype.destroy=function(){this.ui.destroy();this.popup&&!this.popup.destroyed&&this.popup.destroy();this.container=null;this._domHandles.destroy()};Object.defineProperty(g.prototype,"container",{set:function(a){var b=this,f=this._get("container");if(f!==a){this._domHandles.remove("dom-size");this._stopMeasuring();
if(f){var g=this.surface;g&&(g.removeEventListener("focus",this._focusEvent),g.removeEventListener("blur",this._blurEvent));f.classList.remove("esri-view");this.popupManager.destroy();this._set("popupManager",null);this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);this.overlay.destroy();this._set("overlay",null);d.destroy(this.root);this._set("root",null);d.destroy(this.userContent);this._set("userContent",null)}if(a){a.classList.add("esri-view");
f=document.createElement("div");for(f.className="esri-view-user-storage";a.hasChildNodes();)f.appendChild(a.firstChild);a.appendChild(f);f=document.createElement("div");f.className="esri-view-root";a.insertBefore(f,a.firstChild);this._set("root",f);var k=document.createElement("div");k.className="esri-view-surface";k.setAttribute("role","application");k.tabIndex=0;k.addEventListener("focus",this._focusEvent);k.addEventListener("blur",this._blurEvent);l.setSelectable(k,!1);f.appendChild(k);this._set("surface",
k);g=new v;f.appendChild(g.surface);this._set("overlay",g);g.watch("needsRender",function(a){a&&!b._overlayRenderTaskHandle?b._overlayRenderTaskHandle=e.addFrameTask({render:function(){b.overlay.render()}}):b._overlayRenderTaskHandle&&(b._overlayRenderTaskHandle.remove(),b._overlayRenderTaskHandle=null)});this._forceReadyCycle();this._domHandles.add(c.init(this,"size",function(a){var c=a[1];k.classList.toggle("esri-view-surface--inset-outline",a[0]>=document.body.clientWidth||c>=document.body.clientHeight)}),
"dom-size");this._set("container",a);this._startMeasuring();a=new p({enabled:!0,view:this});this._set("popupManager",a)}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"focused",{get:function(){return document.activeElement===this.surface},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"size",{get:function(){return[this.width,
this.height]},enumerable:!0,configurable:!0});g.prototype.blur=function(){this.surface&&this.surface.blur()};g.prototype.focus=function(){this.surface&&this.surface.focus()};g.prototype.pageToContainer=function(a,c,b){var e=this.position;a-=e[0];c-=e[1];b?(b[0]=a,b[1]=c):b=[a,c];return b};g.prototype.containerToPage=function(a,c,b){var e=this.position;a+=e[0];c+=e[1];b?(b[0]=a,b[1]=c):b=[a,c];return b};g.prototype._handleUIChange=function(a,c){c&&(this._domHandles.remove("ui"),c.destroy());a&&this._wireUI(a);
this._set("ui",a)};g.prototype._wireUI=function(a){this._domHandles.remove("ui");a&&(a.view=this,this._domHandles.add([c.init(this,"root",function(c){a.container=c?d.create("div",null,c):null}),c.init(this,"popup",function(c,b){b&&(a.remove(b,"popup"),b!==c&&b.destroy());c&&(c.view=a.view,a.add(c,{key:"popup",position:"manual"}))})],"ui"))};g.prototype._focusEvent=function(a){this.notifyChange("focused");this.emit("focus",{native:a})};g.prototype._blurEvent=function(a){this.notifyChange("focused");
this.emit("blur",{native:a})};g.prototype._stopMeasuring=function(){this._domHandles.remove("measuring");this._get("resizing")&&this._set("resizing",!1)};g.prototype._startMeasuring=function(){var a=this,c=this._freqInfo;c.freq=16;c.time=750;this._domHandles.add([k(window,"resize",function(){c.freq=16;c.time=750}),e.addFrameTask({prepare:function(c){var b=a._measure(),e=a._freqInfo;e.time+=c.deltaTime;b&&(e.freq=16,a._get("resizing")||a._set("resizing",!0));e.time<e.freq||(e.time=0,a._position()||
b?e.freq=16:e.freq=Math.min(750,2*e.freq),!b&&512<=e.freq&&a._get("resizing")&&a._set("resizing",!1))}})],"measuring");this._measure();this._position()};g.prototype._measure=function(){var a=this.container,c=a?a.clientWidth:0,b=a?a.clientHeight:0;if(0===c||0===b||"hidden"===window.getComputedStyle(a).visibility)return this.suspended||this._set("suspended",!0),!1;var a=this.width,e=this.height;if(c===a&&b===e)return this.suspended&&this._set("suspended",!1),!1;this._set("width",c);this._set("height",
b);this.suspended&&this._set("suspended",!1);this.emit("resize",{oldWidth:a,oldHeight:e,width:c,height:b});return!0};g.prototype._position=function(){var a=this.container,c=this.position,b=(a.ownerDocument||window.document).defaultView,a=a.getBoundingClientRect();q[0]=a.left+b.pageXOffset;q[1]=a.top+b.pageYOffset;return c&&q[0]===c[0]&&q[1]===c[1]?!1:(this._set("position",[q[0],q[1]]),!0)};a([t.property({value:null,cast:function(a){return l.byId(a)}})],g.prototype,"container",null);a([t.property({readOnly:!0,
dependsOn:["surface"]})],g.prototype,"focused",null);a([t.property({readOnly:!0})],g.prototype,"height",void 0);a([t.property({type:r})],g.prototype,"popup",void 0);a([t.property({type:p})],g.prototype,"popupManager",void 0);a([t.property({type:v})],g.prototype,"overlay",void 0);a([t.property({readOnly:!0})],g.prototype,"position",void 0);a([t.property({readOnly:!0})],g.prototype,"resizing",void 0);a([t.property({readOnly:!0})],g.prototype,"root",void 0);a([t.property({value:null,dependsOn:["width",
"height"],readOnly:!0})],g.prototype,"size",null);a([t.property({readOnly:!0})],g.prototype,"surface",void 0);a([t.property({readOnly:!0})],g.prototype,"suspended",void 0);a([t.property()],g.prototype,"ui",void 0);a([t.property({readOnly:!0})],g.prototype,"userContent",void 0);a([t.property({readOnly:!0})],g.prototype,"width",void 0);return g=a([t.subclass("esri.views.DOMContainer")],g)}(t.declared(g,f))})},"esri/views/overlay/ViewOverlay":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators maquette".split(" "),
function(n,m,h,a,l,d,k,g,f){return function(b){function e(){var a=null!==b&&b.apply(this,arguments)||this;a.items=new k;a._callbacks=new Map;a._projector=f.createProjector();a._hiddenProjector=f.createProjector();return a}h(e,b);Object.defineProperty(e.prototype,"needsRender",{get:function(){return 0<this.items.length},enumerable:!0,configurable:!0});e.prototype.initialize=function(){var a=this,b=document.createElement("div");b.className="esri-overlay-surface";l.setSelectable(b,!1);this._set("surface",
b);this._hiddenSurface=document.createElement("div");this._hiddenSurface.setAttribute("style","visibility: hidden;");b.appendChild(this._hiddenSurface);this._itemsChangeHandle=this.items.on("change",function(c){c.added.map(function(c){var b=function(){return c.render()};a._callbacks.set(c,b);a._projector.append(a.surface,b)});c.removed.map(function(c){var b=a._projector.detach(a._callbacks.get(c));a.surface.removeChild(b.domNode);a._callbacks.delete(c)})})};e.prototype.addItem=function(a){this.items.add(a)};
e.prototype.removeItem=function(a){this.items.remove(a)};e.prototype.destroy=function(){this.items.removeAll();this._itemsChangeHandle.remove();this._projector=this._callbacks=null};e.prototype.render=function(){this._projector.renderNow()};e.prototype.computeBoundingRect=function(a){var c=this._hiddenSurface,b=this._hiddenProjector,e=null,f=function(){return e=a.render()};b.append(c,f);b.renderNow();var k={left:0,top:0,right:0,bottom:0};if(e&&e.domNode){var g=e.domNode.getBoundingClientRect();k.left=
g.left;k.top=g.top;k.right=g.right;k.bottom=g.bottom}for(b.detach(f);c.firstChild;)c.removeChild(c.firstChild);return k};e.prototype.overlaps=function(a,b){a=this.computeBoundingRect(a);b=this.computeBoundingRect(b);return Math.max(a.left,b.left)<=Math.min(a.right,b.right)&&Math.max(a.top,b.top)<=Math.min(a.bottom,b.bottom)};a([g.property({readOnly:!0})],e.prototype,"surface",void 0);a([g.property({readOnly:!0})],e.prototype,"items",void 0);a([g.property({readOnly:!0,dependsOn:["items.length"]})],
e.prototype,"needsRender",null);return e=a([g.subclass("esri.views.overlay.ViewOverlay")],e)}(g.declared(d))})},"esri/widgets/Popup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper dojo/dom-geometry dojo/i18n!./Popup/nls/Popup dojo/keys ../core/Handles ../core/lang ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ./Feature ./Spinner ./Widget ./Popup/PopupViewModel ./support/widget ./support/widgetUtils".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q,u,A){function z(a,b){return void 0===b?"esri-popup__"+a:"esri-popup__"+a+"-"+b}var x={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},y=e.getLogger("esri.widgets.Popup");return function(e){function r(a){a=e.call(this)||this;a._blurContainer=!1;a._containerNode=null;a._mainContainerNode=null;a._featureMenuNode=null;a._focusContainer=!1;a._focusDockButton=!1;a._focusFeatureMenuButton=!1;a._focusFirstFeature=!1;a._handles=new f;a._displayActionTextLimit=
2;a._pointerOffsetInPx=16;a._spinner=null;a.actions=null;a.alignment="auto";a.autoCloseEnabled=null;a.content=null;a.collapsed=!1;a.collapseEnabled=!0;a.dockEnabled=!1;a.featureCount=null;a.features=null;a.featureNavigationEnabled=!0;a.goToOverride=null;a.highlightEnabled=null;a.location=null;a.featureWidgets=[];a.promises=null;a.selectedFeature=null;a.selectedFeatureIndex=null;a.selectedFeatureWidget=null;a.spinnerEnabled=!0;a.title=null;a.updateLocationEnabled=null;a.view=null;a.viewModel=new q;
a.visible=null;return a}h(r,e);r.prototype.postInitialize=function(){var a=this;this._addSelectedFeatureIndexHandle();this.own(c.watch(this,"viewModel.screenLocation",function(){return a._positionContainer()}),c.watch(this,["viewModel.visible","dockEnabled"],function(){return a._toggleScreenLocationEnabled()}),c.watch(this,"viewModel.screenLocation",function(b,c){!!b!==!!c&&a.reposition()}),c.watch(this,"viewModel.features",function(b){return a._createFeatureWidgets(b)}),c.watch(this,"viewModel.view.padding viewModel.view.size viewModel.visible viewModel.waitingForResult viewModel.location alignment".split(" "),
function(){return a.reposition()}),c.watch(this,"spinnerEnabled",function(b){return a._spinnerEnabledChange(b)}),c.watch(this,"viewModel.view.size",function(b,c){return a._updateDockEnabledForViewSize(b,c)}),c.watch(this,"viewModel.view",function(b,c){return a._viewChange(b,c)}),c.watch(this,"viewModel.view.ready",function(b,c){return a._viewReadyChange(b,c)}),c.watch(this,["viewModel.waitingForResult","viewModel.location"],function(){return a._displaySpinner()}),c.watch(this,["featureWidgets","viewModel.selectedFeatureIndex"],
function(){return a._updateFeatureWidget()}),c.watch(this,"selectedFeatureWidget.viewModel.title",function(b){return a._setTitleFromFeatureWidget(b)}),c.watch(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],function(){return a._setContentFromFeatureWidget()}),c.on(this,"viewModel","trigger-action",function(b){return a._zoomToAction(b)}))};r.prototype.destroy=function(){this._destroyFeatureWidgets();this._destroySpinner();this._handles&&this._handles.destroy();
this._handles=null};Object.defineProperty(r.prototype,"currentAlignment",{get:function(){return this._getCurrentAlignment()},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"currentDockPosition",{get:function(){return this._getCurrentDockPosition()},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"dockOptions",{get:function(){return this._get("dockOptions")||x},set:function(a){var b=l({},x),c=this.get("viewModel.view.breakpoints"),e={};c&&(e.width=c.xsmall,e.height=
c.xsmall);a=l({},b,a);b=l({},b.breakpoint,e);e=a.breakpoint;!0===e?a.breakpoint=b:"object"===typeof e&&(a.breakpoint=l({},b,e));this._set("dockOptions",a);this._setCurrentDockPosition();this.reposition()},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"featureMenuOpen",{get:function(){return this.viewModel.visible?this._get("featureMenuOpen"):!1},set:function(a){this._set("featureMenuOpen",!!a)},enumerable:!0,configurable:!0});r.prototype.blur=function(){this.visible||y.warn("Popup cannot be blurred while visible is false");
this._blurContainer=!0;this.scheduleRender()};r.prototype.clear=function(){};r.prototype.close=function(){this.visible=!1};r.prototype.focus=function(){this.visible||y.warn("Popup cannot be focused while visible is false");this._focusContainer=!0;this.scheduleRender()};r.prototype.next=function(){return null};r.prototype.open=function(a){this._handles.remove("selected-index");this.set({featureMenuOpen:a?!!a.featureMenuOpen:!1});this.viewModel.open(a);this._addSelectedFeatureIndexHandle()};r.prototype.previous=
function(){return null};r.prototype.reposition=function(){this.renderNow();this._positionContainer();this._setCurrentAlignment()};r.prototype.triggerAction=function(a){return null};r.prototype.render=function(){var a,c,e,f,g,l,d,t=this.collapsed,p=this.collapseEnabled,q=this.dockEnabled,h=this.featureMenuOpen,r=this.featureNavigationEnabled,v=this.featureWidgets,m=this.visible,x=this.viewModel,n=x.allActions,y=x.content,w=x.featureCount,B=x.pendingPromisesCount,R=x.selectedFeatureIndex,S=x.title,
x=1<w&&r,r=1<w&&h,T=p&&!r&&t,t=n&&n.length,L=x&&this._getPageText(w,R),V=this._renderContent(),O=A.isRtl(),U=this.get("selectedFeatureWidget")?this.get("selectedFeatureWidget.viewModel.waitingForContent")||this.get("selectedFeatureWidget.viewModel.content"):V,Z=q?k.undock:k.dock,w=this.currentAlignment,n=this.currentDockPosition,B=B?u.tsx("div",{key:z("loading-container"),role:"presentation",class:"esri-popup__loading-container","aria-label":k.loading,title:k.loading},u.tsx("span",{"aria-hidden":"true",
class:this.classes("esri-popup__icon","esri-icon-loading-indicator","esri-rotating")})):null,W=(a={},a["esri-icon-layer-list"]=!r,a["esri-icon-close"]=r,a);a=u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",W)});W=(c={},c["esri-icon-right-triangle-arrow"]=O,c["esri-popup__pagination-previous-icon--rtl"]=O,c["esri-icon-left-triangle-arrow"]=!O,c["esri-popup__pagination-previous-icon"]=!O,c);c=u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",W)});W=u.tsx("div",
{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes("esri-popup__button","esri-popup__pagination-previous"),"aria-label":k.previous,title:k.previous},c);c=(e={},e["esri-icon-left-triangle-arrow"]=O,e["esri-popup__pagination-next-icon--rtl"]=O,e["esri-icon-right-triangle-arrow"]=!O,e["esri-popup__pagination-next-icon"]=!O,e);e=u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",c)});O=u.tsx("div",{role:"button",tabIndex:0,bind:this,
onclick:this._next,onkeydown:this._next,class:this.classes("esri-popup__button","esri-popup__pagination-next"),"aria-label":k.next,title:k.next},e);c=A.cssTransition("enter","esri-popup--feature-updated");e=this.id+"-feature-menu";h=u.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes("esri-popup__button","esri-popup__feature-menu-button"),
"aria-haspopup":"true","aria-controls":e,"aria-expanded":h,"aria-label":k.menu,title:k.menu},a);L=u.tsx("div",{class:"esri-popup__pagination-page-text"},L);h=x?u.tsx("div",{class:"esri-popup__navigation-buttons",enterAnimation:c},W,L,O,B||h):null;L=this._wouldDockTo();L=(f={},f["esri-icon-minimize"]=q,f["esri-popup__icon--dock-icon"]=!q,f["esri-icon-dock-right"]=!q&&("top-right"===L||"bottom-right"===L),f["esri-icon-dock-left"]=!q&&("top-left"===L||"bottom-left"===L),f["esri-icon-maximize"]=!q&&"top-center"===
L,f["esri-icon-dock-bottom"]=!q&&"bottom-center"===L,f);f=u.tsx("span",{"aria-hidden":"true",class:this.classes(L,"esri-popup__icon")});f=this.get("dockOptions.buttonEnabled")?u.tsx("div",{role:"button","aria-label":Z,title:Z,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes("esri-popup__button","esri-popup__button--dock")},f):null;p=p&&S&&(U||t||x);Z=(g={},g["esri-popup__header-title--button"]=
p,g);L=p?"button":"heading";B=p?T?k.expand:k.collapse:"";g=this.id+"-popup-title";S=S?u.tsx("h2",{class:this.classes("esri-popup__header-title",Z),key:S,enterAnimation:c,id:g,role:L,"aria-label":B,title:B,bind:this,tabIndex:p?0:-1,onclick:this._toggleCollapsed,onkeydown:this._toggleCollapsed,innerHTML:S}):null;p=u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon","esri-icon-close")});p=u.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:"esri-popup__button",
"aria-label":k.close,title:k.close},p);p=u.tsx("header",{class:"esri-popup__header"},S,u.tsx("div",{class:"esri-popup__header-buttons"},f,p));f=this.id+"-popup-content";y=U&&!T?u.tsx("article",{key:y,enterAnimation:c,id:f,class:"esri-popup__content"},V):null;V=!T&&("bottom-left"===w||"bottom-center"===w||"bottom-right"===w||"top-left"===n||"top-center"===n||"top-right"===n);T=!T&&("top-left"===w||"top-center"===w||"top-right"===w||"bottom-left"===n||"bottom-center"===n||"bottom-right"===n);U=r?null:
u.tsx("div",{key:z("actions"),class:"esri-popup__actions"},this._renderActions());c=u.tsx("section",{key:z("navigation"),class:"esri-popup__navigation"},h);x=x||t?u.tsx("div",{key:z("feature-buttons"),class:"esri-popup__feature-buttons"},U,c):null;R=this._renderFeatureMenuNode(v,R,r,e);v=b.substitute({total:v.length},k.selectedFeatures);e=u.tsx("section",{key:z("menu"),class:"esri-popup__feature-menu"},u.tsx("h2",{class:"esri-popup__feature-menu-header"},v),u.tsx("nav",{class:"esri-popup__feature-menu-viewport",
afterCreate:this._featureMenuViewportNodeUpdated,afterUpdate:this._featureMenuViewportNodeUpdated},R));v=q?null:u.tsx("div",{key:z("pointer"),class:"esri-popup__pointer",role:"presentation"},u.tsx("div",{class:this.classes("esri-popup__pointer-direction","esri-popup--shadow")}));R=this.get("selectedFeature.layer.title");t=this.get("selectedFeature.layer.id");U=(l={},l["esri-popup--shadow"]=q,l);l=(d={},d["esri-popup--aligned-top-center"]=m&&"top-center"===w,d["esri-popup--aligned-bottom-center"]=
m&&"bottom-center"===w,d["esri-popup--aligned-top-left"]=m&&"top-left"===w,d["esri-popup--aligned-bottom-left"]=m&&"bottom-left"===w,d["esri-popup--aligned-top-right"]=m&&"top-right"===w,d["esri-popup--aligned-bottom-right"]="bottom-right"===w,d["esri-popup--is-docked"]=m&&q,d["esri-popup--shadow"]=m&&!q,d["esri-popup--is-docked-top-left"]=m&&"top-left"===n,d["esri-popup--is-docked-top-center"]=m&&"top-center"===n,d["esri-popup--is-docked-top-right"]=m&&"top-right"===n,d["esri-popup--is-docked-bottom-left"]=
m&&"bottom-left"===n,d["esri-popup--is-docked-bottom-center"]=m&&"bottom-center"===n,d["esri-popup--is-docked-bottom-right"]=m&&"bottom-right"===n,d["esri-popup--feature-menu-open"]=m&&r,d);d=V?e:null;q=T?e:null;r=V?x:null;w=T?x:null;d=u.tsx("div",{class:this.classes("esri-popup__main-container","esri-widget",U),tabIndex:-1,role:"dialog","aria-labelledby":S?g:"","aria-describedby":y?f:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},
r,d,p,y,w,q);return u.tsx("div",{key:z("base"),class:this.classes("esri-popup",l),role:"presentation","data-layer-title":R,"data-layer-id":t,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},m?[d,v]:null)};r.prototype._featureMenuOpenChanged=function(a){a?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0};r.prototype._setTitleFromFeatureWidget=function(a){this.selectedFeatureWidget&&(this.viewModel.title=a||"")};r.prototype._setContentFromFeatureWidget=function(){var a=
this.selectedFeatureWidget;a&&(this.viewModel.content=a)};r.prototype._handleFeatureMenuKeyup=function(a){a.keyCode===g.ESCAPE&&(a.stopPropagation(),this.featureMenuOpen=!1)};r.prototype._handleFeatureMenuItemKeyup=function(a){var b=a.keyCode,c=this._featureMenuNode,e=this.get("features.length"),f=a.currentTarget["data-feature-index"];c&&(c=c.querySelectorAll("li"),b===g.UP_ARROW?(a.stopPropagation(),c[(f-1+e)%e].focus()):b===g.DOWN_ARROW?(a.stopPropagation(),c[(f+1+e)%e].focus()):b===g.HOME?(a.stopPropagation(),
c[0].focus()):b===g.END&&(a.stopPropagation(),c[c.length-1].focus()))};r.prototype._handleMainKeyup=function(a){var b=a.keyCode;b===g.LEFT_ARROW&&(a.stopPropagation(),this.previous());b===g.RIGHT_ARROW&&(a.stopPropagation(),this.next())};r.prototype._zoomToAction=function(a){a.action&&!a.action.disabled&&"zoom-to"===a.action.id&&this.viewModel.zoomToLocation()};r.prototype._spinnerEnabledChange=function(a){this._destroySpinner();a&&(a=this.get("viewModel.view"),this._createSpinner(a))};r.prototype._displaySpinner=
function(){var a=this._spinner;if(a){var b=this.viewModel,c=b.location;b.waitingForResult?a.show({location:c}):a.hide()}};r.prototype._getIconStyles=function(a){return{"background-image":a?"url("+a+")":""}};r.prototype._renderAction=function(a,e,f,g){var l=this,d,t,p=c.watch(a,"active className disabled id title image visible".split(" "),function(){return l.scheduleRender()});this._handles.add(p,g);p=this.get("selectedFeature.attributes");"zoom-to"===a.id&&(a.title=k.zoom,a.className="esri-icon-zoom-in-magnifying-glass");
g=a.title;var q=a.className,h=a.image,q=h||q?q:"esri-icon-default-action";g=g&&p?b.substitute(p,g):g;var r=q&&p?b.substitute(p,q):q,p=h&&p?b.substitute(p,h):h,h=(d={},d["esri-icon-loading-indicator"]=a.active,d["esri-rotating"]=a.active,d["esri-popup__icon"]=!!q,d["esri-popup__action-image"]=!a.active&&!!p,d);r&&(h[r]=!a.active);d=(t={},t["esri-popup__action"]="toggle"!==a.type,t["esri-popup__action-toggle"]="toggle"===a.type,t["esri-popup__action-toggle--on"]="toggle"===a.type&&a.value,t["esri-popup__button--disabled"]=
a.disabled,t);f=f<=this._displayActionTextLimit?u.tsx("span",{key:"text",class:"esri-popup__action-text"},g):null;return a.visible?u.tsx("div",{key:a,role:"button",tabIndex:0,title:g,"aria-label":g,class:this.classes("esri-popup__button",d),bind:this,"data-action-index":e,onclick:this._triggerAction,onkeydown:this._triggerAction},u.tsx("span",{key:"icon","aria-hidden":"true",class:this.classes("esri-popup__icon",h),styles:this._getIconStyles(p)}),f):null};r.prototype._renderActions=function(){var a=
this;this._handles.remove("actions");var b=this.viewModel.allActions;if(b){var c=b.length;return b.map(function(b,e){return a._renderAction(b,e,c,"actions")}).toArray()}};r.prototype._addSelectedFeatureIndexHandle=function(){var a=this,b=c.watch(this,"viewModel.selectedFeatureIndex",function(b,c){return a._selectedFeatureIndexUpdated(b,c)});this._handles.add(b,"selected-index")};r.prototype._selectedFeatureIndexUpdated=function(a,b){var c=this.featureMenuOpen;this.featureCount&&c&&a!==b&&-1!==a&&
(this.featureMenuOpen=!1)};r.prototype._updateFeatureWidget=function(){var a=this.featureWidgets[this.viewModel.selectedFeatureIndex]||null;a&&!a.contentEnabled&&(a.contentEnabled=!0);this._set("selectedFeatureWidget",a)};r.prototype._destroyFeatureWidgets=function(){this.featureWidgets.forEach(function(a){return a.destroy()});this._set("featureWidgets",[])};r.prototype._createFeatureWidgets=function(a){var b=this.featureWidgets.slice(0),c=this.get("viewModel.view"),e=[];a.forEach(function(a,f){if(a){var g=
null;b.some(function(c,e){c&&c.graphic===a&&(g=c,b.splice(e,1));return!!g});e[f]=g||new p({contentEnabled:!1,graphic:a,view:c})}});b.forEach(function(a){return a&&a.destroy()});this._set("featureWidgets",e)};r.prototype._isScreenLocationWithinView=function(a,b){return-1<a.x&&-1<a.y&&a.x<=b.width&&a.y<=b.height};r.prototype._isOutsideView=function(a){var b=a.popupHeight,c=a.popupWidth,e=a.screenLocation,f=a.side;a=a.view;if(isNaN(c)||isNaN(b)||!a||!e)return!1;var g=a.padding;return"right"===f&&e.x+
c/2>a.width-g.right||"left"===f&&e.x-c/2<g.left||"top"===f&&e.y-b<g.top||"bottom"===f&&e.y+b>a.height-g.bottom?!0:!1};r.prototype._determineCurrentAlignment=function(){var a=this._pointerOffsetInPx,b=this._containerNode,c=this._mainContainerNode,e=this.viewModel,f=e.screenLocation,e=e.view;if(!f||!e||!b)return"top-center";if(!this._isScreenLocationWithinView(f,e))return this._get("currentAlignment")||"top-center";var g=c?window.getComputedStyle(c,null):null,c=g?parseInt(g.getPropertyValue("max-height").replace(/[^-\d\.]/g,
""),10):0,g=g?parseInt(g.getPropertyValue("height").replace(/[^-\d\.]/g,""),10):0,k=d.getContentBox(b),b=k.w+a,k=Math.max(k.h,c,g)+a,a=this._isOutsideView({popupHeight:k,popupWidth:b,screenLocation:f,side:"right",view:e}),c=this._isOutsideView({popupHeight:k,popupWidth:b,screenLocation:f,side:"left",view:e}),g=this._isOutsideView({popupHeight:k,popupWidth:b,screenLocation:f,side:"top",view:e}),f=this._isOutsideView({popupHeight:k,popupWidth:b,screenLocation:f,side:"bottom",view:e});return c?g?"bottom-right":
"top-right":a?g?"bottom-left":"top-left":g?f?"top-center":"bottom-center":"top-center"};r.prototype._getCurrentAlignment=function(){var a=this.alignment;return this.dockEnabled?null:"auto"===a?this._determineCurrentAlignment():"function"===typeof a?a.call(this):a};r.prototype._setCurrentAlignment=function(){this._set("currentAlignment",this._getCurrentAlignment())};r.prototype._setCurrentDockPosition=function(){this._set("currentDockPosition",this._getCurrentDockPosition())};r.prototype._getDockPosition=
function(){var a=this.get("dockOptions.position");return"auto"===a?this._determineCurrentDockPosition():"function"===typeof a?a.call(this):a};r.prototype._getCurrentDockPosition=function(){return this.dockEnabled?this._getDockPosition():null};r.prototype._wouldDockTo=function(){return this.dockEnabled?null:this._getDockPosition()};r.prototype._renderFeatureMenuItemNode=function(a,b,c,e){var f,g=b===c;e=(f={},f["esri-popup__feature-menu-item--selected"]=g,f);f=g?u.tsx("span",{key:z("feature-menu-selected-feature-"+
c),title:k.selectedFeature,"aria-label":k.selectedFeature,class:"esri-icon-check-mark"}):null;a=u.tsx("span",{innerHTML:a.title||k.untitled});return u.tsx("li",{role:"menuitem",tabIndex:-1,key:z("feature-menu-feature-"+c),class:this.classes(e,"esri-popup__feature-menu-item"),bind:this,"data-feature-index":b,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},u.tsx("span",{class:"esri-popup__feature-menu-title"},a,f))};r.prototype._renderFeatureMenuNode=
function(a,b,c,e){var f=this;return 1<a.length?u.tsx("ol",{class:"esri-popup__feature-menu-list",id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},a.map(function(a,e){return f._renderFeatureMenuItemNode(a,e,b,c)})):null};r.prototype._determineCurrentDockPosition=function(){var a=this.get("viewModel.view"),b=A.isRtl()?"top-left":"top-right";if(!a)return b;var c=a.padding||{left:0,right:0,top:0,bottom:0},
c=a.width-c.left-c.right;return(a=a.get("breakpoints"))&&c<=a.xsmall?"bottom-center":b};r.prototype._renderContent=function(){var a=this.get("viewModel.content");if("string"===typeof a)return u.tsx("div",{key:a,innerHTML:a});if(u.isWidget(a))return u.tsx("div",{key:a},a.render());if(a instanceof HTMLElement)return u.tsx("div",{key:a,bind:a,afterCreate:this._attachToNode});if(u.isWidgetBase(a))return u.tsx("div",{key:a,bind:a.domNode,afterCreate:this._attachToNode})};r.prototype._attachToNode=function(a){a.appendChild(this)};
r.prototype._positionContainer=function(a){void 0===a&&(a=this._containerNode);a&&(this._containerNode=a);if(a){var b=this.viewModel.screenLocation,c=d.getContentBox(a);if(b=this._calculatePositionStyle(b,c))a.style.top=b.top,a.style.left=b.left,a.style.bottom=b.bottom,a.style.right=b.right}};r.prototype._calculateFullWidth=function(a){var b=this.currentAlignment,c=this._pointerOffsetInPx;return"top-left"===b||"bottom-left"===b||"top-right"===b||"bottom-right"===b?a+c:a};r.prototype._calculateAlignmentPosition=
function(a,b,c,e){var f=this.currentAlignment,g=this._pointerOffsetInPx;e/=2;var k=c.height-b;c=c.width-a;var l=this.view.padding;if("bottom-center"===f)return{top:b+g-l.top,left:a-e-l.left};if("top-left"===f)return{bottom:k+g-l.bottom,right:c+g-l.right};if("bottom-left"===f)return{top:b+g-l.top,right:c+g-l.right};if("top-right"===f)return{bottom:k+g-l.bottom,left:a+g-l.left};if("bottom-right"===f)return{top:b+g-l.top,left:a+g-l.left};if("top-center"===f)return{bottom:k+g-l.bottom,left:a-e-l.left}};
r.prototype._calculatePositionStyle=function(a,b){var c=this.view;if(c){if(this.dockEnabled)return{left:"",top:"",right:"",bottom:""};if(a&&b&&(b=this._calculateFullWidth(b.w),a=this._calculateAlignmentPosition(a.x,a.y,c,b)))return{top:void 0!==a.top?a.top+"px":"auto",left:void 0!==a.left?a.left+"px":"auto",bottom:void 0!==a.bottom?a.bottom+"px":"auto",right:void 0!==a.right?a.right+"px":"auto"}}};r.prototype._viewChange=function(a,b){a&&b&&(this.close(),this.clear())};r.prototype._viewReadyChange=
function(a,b){a?(a=this.get("viewModel.view"),this._wireUpView(a)):b&&(this.close(),this.clear())};r.prototype._wireUpView=function(a){this._destroySpinner();a&&(this.spinnerEnabled&&this._createSpinner(a),this._setDockEnabledForViewSize(this.dockOptions))};r.prototype._dockingThresholdCrossed=function(a,b,c){var e=a[0];a=a[1];var f=b[0];b=b[1];var g=c.width;c=c.height;return e<=g&&f>g||e>g&&f<=g||a<=c&&b>c||a>c&&b<=c};r.prototype._updateDockEnabledForViewSize=function(a,b){if(a&&b){var c=this.get("viewModel.view.padding")||
{left:0,right:0,top:0,bottom:0},e=c.left+c.right,f=c.top+c.bottom,c=[],g=[];c[0]=a[0]-e;c[1]=a[1]-f;g[0]=b[0]-e;g[1]=b[1]-f;a=this.dockOptions;this._dockingThresholdCrossed(c,g,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._setCurrentDockPosition()}};r.prototype._focusDockButtonNode=function(a){this._focusDockButton&&(this._focusDockButton=!1,a.focus())};r.prototype._mainContainerNodeUpdated=function(a){this._mainContainerNode=a;this._focusContainer?(this._focusContainer=!1,a.focus()):this._blurContainer&&
(this._blurContainer=!1,a.blur())};r.prototype._featureMenuNodeUpdated=function(a){(this._featureMenuNode=a)&&this._focusFirstFeature&&(this._focusFirstFeature=!1,a=a.querySelectorAll("li"),a.length&&a[0].focus())};r.prototype._focusFeatureMenuButtonNode=function(a){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,a.focus())};r.prototype._featureMenuViewportNodeUpdated=function(a){a&&(a.scrollTop=0)};r.prototype._toggleScreenLocationEnabled=function(){var a=this.dockEnabled,b=this.viewModel;
b&&(b.screenLocationEnabled=this.visible&&!a)};r.prototype._shouldDockAtCurrentViewSize=function(a){a=a.breakpoint;var b=this.get("viewModel.view.ui"),c=b.width,b=b.height;if(isNaN(c)||isNaN(b))return!1;c=a.hasOwnProperty("width")&&c<=a.width;a=a.hasOwnProperty("height")&&b<=a.height;return c||a};r.prototype._setDockEnabledForViewSize=function(a){a.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(a))};r.prototype._getPageText=function(a,c){return b.substitute({index:c+1,total:a},k.pageText)};
r.prototype._destroySpinner=function(){var a=this._spinner,b=this.view;a&&(b&&b.ui.remove(this._spinner,"popup-spinner"),a.destroy(),this._spinner=null)};r.prototype._createSpinner=function(a){a&&(this._spinner=new v({view:a}),a.ui.add(this._spinner,{key:"popup-spinner",position:"manual"}))};r.prototype._toggleCollapsed=function(){this.collapsed=!this.collapsed};r.prototype._close=function(){this.close();this.view&&this.view.focus()};r.prototype._toggleDockEnabled=function(){this.dockEnabled=!this.dockEnabled;
this._focusDockButton=!0;this.scheduleRender()};r.prototype._toggleFeatureMenu=function(){var a=!this.featureMenuOpen;this._featureMenuOpenChanged(a);this.featureMenuOpen=a};r.prototype._triggerAction=function(a){a=a.currentTarget["data-action-index"];var b=this.viewModel.allActions.getItemAt(a);b&&"toggle"===b.type&&(b.value=!b.value);this.viewModel.triggerAction(a)};r.prototype._selectFeature=function(a){a=a.currentTarget["data-feature-index"];isNaN(a)||(this.viewModel.selectedFeatureIndex=a)};
r.prototype._next=function(){this.next()};r.prototype._previous=function(){this.previous()};a([t.aliasOf("viewModel.actions"),u.renderable()],r.prototype,"actions",void 0);a([t.property()],r.prototype,"alignment",void 0);a([t.aliasOf("viewModel.autoCloseEnabled")],r.prototype,"autoCloseEnabled",void 0);a([t.aliasOf("viewModel.content"),u.renderable()],r.prototype,"content",void 0);a([t.property(),u.renderable()],r.prototype,"collapsed",void 0);a([t.property(),u.renderable()],r.prototype,"collapseEnabled",
void 0);a([t.property({readOnly:!0,dependsOn:["dockEnabled","alignment"]}),u.renderable()],r.prototype,"currentAlignment",null);a([t.property({readOnly:!0,dependsOn:["viewModel.view.ready","dockEnabled","dockOptions"]}),u.renderable()],r.prototype,"currentDockPosition",null);a([t.property(),u.renderable()],r.prototype,"dockOptions",null);a([t.property(),u.renderable()],r.prototype,"dockEnabled",void 0);a([t.aliasOf("viewModel.featureCount"),u.renderable()],r.prototype,"featureCount",void 0);a([t.property({dependsOn:["viewModel.visible"]}),
u.renderable()],r.prototype,"featureMenuOpen",null);a([t.aliasOf("viewModel.features"),u.renderable()],r.prototype,"features",void 0);a([t.property(),u.renderable()],r.prototype,"featureNavigationEnabled",void 0);a([t.aliasOf("viewModel.goToOverride")],r.prototype,"goToOverride",void 0);a([t.aliasOf("viewModel.highlightEnabled")],r.prototype,"highlightEnabled",void 0);a([t.aliasOf("viewModel.location"),u.renderable()],r.prototype,"location",void 0);a([t.property({readOnly:!0}),u.renderable()],r.prototype,
"featureWidgets",void 0);a([t.aliasOf("viewModel.promises")],r.prototype,"promises",void 0);a([t.aliasOf("viewModel.selectedFeature"),u.renderable()],r.prototype,"selectedFeature",void 0);a([t.aliasOf("viewModel.selectedFeatureIndex"),u.renderable()],r.prototype,"selectedFeatureIndex",void 0);a([t.property({readOnly:!0}),u.renderable()],r.prototype,"selectedFeatureWidget",void 0);a([t.property()],r.prototype,"spinnerEnabled",void 0);a([t.aliasOf("viewModel.title"),u.renderable()],r.prototype,"title",
void 0);a([t.aliasOf("viewModel.updateLocationEnabled")],r.prototype,"updateLocationEnabled",void 0);a([t.aliasOf("viewModel.view")],r.prototype,"view",void 0);a([t.property({type:q}),u.renderable("viewModel.allActions viewModel.screenLocation viewModel.screenLocationEnabled viewModel.state viewModel.pendingPromisesCount viewModel.promiseCount viewModel.waitingForResult".split(" ")),u.vmEvent(["triggerAction","trigger-action"])],r.prototype,"viewModel",void 0);a([t.aliasOf("viewModel.visible"),u.renderable()],
r.prototype,"visible",void 0);a([t.aliasOf("viewModel.clear")],r.prototype,"clear",null);a([t.aliasOf("viewModel.next")],r.prototype,"next",null);a([t.aliasOf("viewModel.previous")],r.prototype,"previous",null);a([t.aliasOf("viewModel.triggerAction")],r.prototype,"triggerAction",null);a([u.accessibleHandler()],r.prototype,"_toggleCollapsed",null);a([u.accessibleHandler()],r.prototype,"_close",null);a([u.accessibleHandler()],r.prototype,"_toggleDockEnabled",null);a([u.accessibleHandler()],r.prototype,
"_toggleFeatureMenu",null);a([u.accessibleHandler()],r.prototype,"_triggerAction",null);a([u.accessibleHandler()],r.prototype,"_selectFeature",null);a([u.accessibleHandler()],r.prototype,"_next",null);a([u.accessibleHandler()],r.prototype,"_previous",null);return r=a([t.subclass("esri.widgets.Popup")],r)}(t.declared(r))})},"esri/widgets/Feature":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Feature/nls/Feature dojo/keys ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Feature/FeatureViewModel ./Feature/support/attachmentUtils ./support/uriUtils ./support/widget".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p){function v(a,b){return void 0===b?"esri-feature__"+a:"esri-feature__"+a+"-"+b}return function(b){function q(a){a=b.call(this)||this;a._chartMap=new Map;a._activeMediaMap=new Map;a._chartRequirePromise=null;a._refreshTimers=new Map;a._mediaInfo=new Map;a.contentEnabled=null;a.graphic=null;a.title=null;a.view=null;a.viewModel=new e;return a}h(q,b);q.prototype.postInitialize=function(){var a=this;this.own(g.init(this,"viewModel.content",function(){return a._setupMediaRefreshTimers()}))};
q.prototype.destroy=function(){this._clearMediaRefreshTimers();this._activeMediaMap.clear();this._activeMediaMap=null;this._cancelChartModules();this._destroyCharts()};q.prototype.render=function(){var a=p.tsx("div",{key:v("loading-container"),class:"esri-feature__loading-container"},p.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")})),a=this.viewModel.waitingForContent?a:this._renderContent();return p.tsx("div",{class:"esri-feature"},p.tsx("div",
{class:"esri-feature__size-container"},p.tsx("div",{class:"esri-feature__main-container"},a)))};q.prototype.goToMedia=function(a,b){this._setContentElementMedia(a,b)};q.prototype.nextMedia=function(a){this._pageContentElementMedia(a,"next")};q.prototype.previousMedia=function(a){this._pageContentElementMedia(a,"previous")};q.prototype._cancelChartModules=function(){var a=this._chartRequirePromise;a&&a.cancel();this._chartRequirePromise=null};q.prototype._destroyChart=function(a){var b=this._chartMap.get(a);
b&&(b.chart.destroy(),b.tooltip.destroy());this._chartMap.delete(a)};q.prototype._destroyCharts=function(){this._chartMap.forEach(function(a){a.chart.destroy();a.tooltip.destroy()});this._chartMap.clear()};q.prototype._renderContent=function(){this._destroyCharts();var a=this.viewModel.content;if("string"===typeof a)return p.tsx("div",{key:v("content-string"),innerHTML:a});if(p.isWidget(a))return p.tsx("div",{key:v("content-widget")},a.render());if(a instanceof HTMLElement)return p.tsx("div",{key:v("content-html-element"),
bind:a,afterCreate:this._attachToNode});if(p.isWidgetBase(a))return p.tsx("div",{key:v("content-dijit"),bind:a.domNode,afterCreate:this._attachToNode});if(Array.isArray(a))return a.length?p.tsx("div",{key:v("content-content-elements")},a.map(this._renderContentElement,this)):null};q.prototype._renderContentElement=function(a,b){switch(a.type){case "attachments":return this._renderAttachments(a,b);case "fields":return this._renderFields(a,b);case "media":return this._renderMedia(a,b);case "text":return this._renderText(a,
b);default:return null}};q.prototype._renderAttachmentInfo=function(a){var b,e,f=a.attachmentInfo,g=a.supportsResizeAttachments,k=f.contentType;a=f.name;var d=f.url,t=g&&c.isSupportedImage(k),q=-1===d.indexOf("?")?"?":"\x26",k=t?""+d+q+"w\x3d48":c.getIconPath(k),t=(b={},b["esri-feature__attachment-item-mask--icon"]=!t,b);b=(e={},e["esri-feature__attachments-image--resizable"]=g,e);return p.tsx("li",{class:"esri-feature__attachments-item",key:f},p.tsx("a",{class:"esri-feature__attachments-item-link",
href:d,target:"_blank"},p.tsx("div",{class:this.classes(t,"esri-feature__attachment-item-mask")},p.tsx("img",{alt:a,class:this.classes(b,"esri-feature__attachments-image"),title:a,src:k}),p.tsx("span",{class:"esri-feature__attachments-image-overlay"},p.tsx("span",{"aria-hidden":"true",class:"esri-feature__attachments-link-icon esri-icon-link-external"}))),p.tsx("span",{class:"esri-feature__attachments-filename"},a||l.noTitle)))};q.prototype._renderAttachments=function(a,b){var c=this,e,f=a.displayType,
g=(b=a.attachmentInfos)&&b.length,k=this.get("graphic.layer.capabilities.operations.supportsResizeAttachments"),f=(e={},e["esri-feature__attachments--list"]="preview"!==f,e["esri-feature__attachments--preview"]="preview"===f,e);return g?p.tsx("div",{key:v("attachments-element"),class:this.classes("esri-feature__attachments","esri-feature__content-element",f)},p.tsx("div",{class:"esri-feature__attachments-title"},l.attach),p.tsx("ul",{class:"esri-feature__attachments-items"},b.map(function(b,e){return c._renderAttachmentInfo({attachmentInfo:b,
attachmentInfoIndex:e,supportsResizeAttachments:k,contentElement:a})}))):null};q.prototype._forceLTR=function(a){return"\x26lrm;"+a};q.prototype._renderFieldInfo=function(a,b){var c,e=this.viewModel.formattedAttributes,f=e?e.content[b]||e.global:null,g=a.fieldName,e=a.label||g,f=f?null==f[g]?"":f[g]:"";a=!(!a.format||!a.format.dateFormat);f="number"!==typeof f||a?t.autoLink(f):this._forceLTR(f);a=(c={},c["esri-feature__field-data--date"]=a,c);return p.tsx("tr",{key:v("fields-element-info-row",b)},
p.tsx("th",{key:v("fields-element-info-row-header",b),class:"esri-feature__field-header",innerHTML:e}),p.tsx("td",{key:v("fields-element-info-row-data",b),class:this.classes("esri-feature__field-data",a),innerHTML:f}))};q.prototype._renderFields=function(a,b){var c=this;return(a=a.fieldInfos)?p.tsx("div",{key:v("fields-element",b),class:this.classes("esri-feature__fields","esri-feature__content-element")},p.tsx("table",{class:"esri-widget__table",summary:l.fieldsSummary,key:v("fields-element-table",
b)},p.tsx("tbody",{key:v("fields-element-table-body",b)},a.map(function(a){return c._renderFieldInfo(a,b)})))):null};q.prototype._shouldOpenInNewTab=function(a){void 0===a&&(a="");return!/^(?:mailto:|tel:)/.test(a.trim().toLowerCase())};q.prototype._clearMediaRefreshTimers=function(){this._refreshTimers.forEach(function(a){return clearTimeout(a)});this._refreshTimers.clear()};q.prototype._clearMediaRefreshTimer=function(a){var b=this._refreshTimers.get(a);b&&(clearTimeout(b),this._refreshTimers.delete(a))};
q.prototype._getImageSource=function(a,b){var c=-1!==a.indexOf("?")?"\x26":"?";a=a.split("#");var e=a[1],e=void 0===e?"":e;return""+a[0]+c+"timestamp\x3d"+b+(e?"#":"")+e};q.prototype._setupMediaRefreshTimer=function(a){var b=this.get("viewModel.content");if(Array.isArray(b)&&(b=b[a])&&"media"===b.type){var c=this._activeMediaMap.get(a);isNaN(c)&&(c=0);(b=b.mediaInfos[c])&&"image"===b.type&&b.refreshInterval&&this._setRefreshTimeout(a,b)}};q.prototype._setupMediaRefreshTimers=function(){var a=this;
this._clearMediaRefreshTimers();var b=this.get("viewModel.content");Array.isArray(b)&&b.forEach(function(b,c){return a._setupMediaRefreshTimer(c)})};q.prototype._updateMediaInfoTimestamp=function(a,b){var c=Date.now();this._mediaInfo.set(b,{timestamp:c,sourceURL:this._getImageSource(a,c)});this.scheduleRender()};q.prototype._setRefreshTimeout=function(a,b){var c=this,e=b.refreshInterval,f=b.value;e&&(b=6E4*e,this._updateMediaInfoTimestamp(f.sourceURL,a),b=setInterval(function(){c._updateMediaInfoTimestamp(f.sourceURL,
a)},b),this._refreshTimers.set(a,b))};q.prototype._renderMediaInfoType=function(a,b){var c=a.value,e=a.title,e=void 0===e?"":e,f=a.type,g=a.refreshInterval,k=c.sourceURL,c=c.linkURL;if("image"===f)return a=this._shouldOpenInNewTab(c)?"_blank":"_self",k=(g=g?this._mediaInfo.get(b):null)?g.sourceURL:k,b=p.tsx("img",{alt:e,key:v("media-image-"+(g?g.timestamp:0),b),src:k}),(e=c?p.tsx("a",{title:e,href:c,target:a},b):null)?e:b;if(-1!==f.indexOf("chart"))return p.tsx("div",{key:v("chart",b),bind:this,"data-media-info":a,
"data-content-element-index":b,class:"esri-feature__media-chart",afterCreate:this._getChartDependencies,afterUpdate:this._getChartDependencies})};q.prototype._getChartDependencies=function(a){var b=this,c=a["data-media-info"],e=a["data-content-element-index"],f=c.value,g=f.theme||"Claro",l=c.type,d=g;"string"===typeof g&&(d=g.replace(/\./g,"/"));this._cancelChartModules();this._chartRequirePromise=k.create(function(a){return n(["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip","dojox/charting/themes/"+
d],function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a(b)})}).then(function(c){b._renderChart(a,e,l,f,c[0],c[1],c[2]);b._chartRequirePromise=null})};q.prototype._renderChart=function(a,b,c,e,f,g,k){a=new f(a,{margins:{l:4,t:4,r:4,b:4}});k&&a.setTheme(k);switch(c){case "pie-chart":a.addPlot("default",{type:"Pie",labels:!1});a.addSeries("Series A",e.chartOptions);break;case "line-chart":a.addPlot("default",{type:"Markers"});a.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,
majorLabels:!1,minorLabels:!1});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.chartOptions.forEach(function(a,b){a.x=b+1});a.addSeries("Series A",e.chartOptions);break;case "column-chart":a.addPlot("default",{type:"Columns",gap:3});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});a.addSeries("Series A",e.chartOptions);break;case "bar-chart":a.addPlot("default",{type:"Bars",gap:3}),a.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),a.addAxis("y",{vertical:!0,
majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),a.addSeries("Series A",e.chartOptions)}c=new g(a);a.render();this._chartMap.set(b,{chart:a,tooltip:c})};q.prototype._renderMediaInfo=function(a,b){this._destroyChart(b);var c=this._renderMediaInfoType(a,b),e=a.title?p.tsx("div",{key:v("media-title",b),class:"esri-feature__media-item-title",innerHTML:a.title}):null;a=a.caption?p.tsx("div",{key:v("media-caption",b),class:"esri-feature__media-item-caption",innerHTML:a.caption}):null;return p.tsx("div",
{key:v("media-container",b),class:"esri-feature__media-item-container"},p.tsx("div",{key:v("media-item-container",b),class:"esri-feature__media-item"},c),e,a)};q.prototype._renderMediaStatsItem=function(a,b,c){c="chart"===c?this.classes("esri-feature__media-chart-icon","esri-icon-chart"):this.classes("esri-feature__media-image-icon","esri-icon-media");return p.tsx("li",{class:"esri-feature__media-image-summary"},p.tsx("span",{"aria-hidden":"true",class:c}),p.tsx("span",{class:"esri-feature__media-count",
"aria-label":a},"("+b+")"))};q.prototype._renderMediaPageButton=function(a,b){var c=(a="previous"===a)?l.previous:l.next,e=a?this.classes("esri-feature__button","esri-feature__media-previous"):this.classes("esri-feature__button","esri-feature__media-next"),f=a?this.classes("esri-feature__icon","esri-feature__media-previous-icon","esri-icon-left-triangle-arrow"):this.classes("esri-feature__icon","esri-feature__media-next-icon","esri-icon-right-triangle-arrow"),g=a?this.classes("esri-feature__icon",
"esri-feature__media-previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes("esri-feature__icon","esri-feature__media-next-icon--rtl","esri-icon-left-triangle-arrow"),k=a?this._previousClick:this._nextClick;return p.tsx("div",{key:v(a?"previous":"next",b),title:c,tabIndex:0,role:"button",class:e,"data-content-element-index":b,bind:this,onkeydown:k,onclick:k},p.tsx("span",{"aria-hidden":"true",class:f}),p.tsx("span",{"aria-hidden":"true",class:g}),p.tsx("span",{class:"esri-icon-font-fallback-text"},
c))};q.prototype._handleMediaKeyup=function(a){var b=a.currentTarget["data-content-element-index"],c=a.keyCode;c===d.LEFT_ARROW&&(a.stopPropagation(),this.previousMedia(b));c===d.RIGHT_ARROW&&(a.stopPropagation(),this.nextMedia(b))};q.prototype._renderMedia=function(a,b){var c;a=a.mediaInfos;var e=this._getMediaStats(a),f=e.total,g=(c={},c["esri-feature--media-pagination-visible"]=1<e.total,c);c=this._renderMediaStatsItem(l.numImages,e.images,"image");var e=this._renderMediaStatsItem(l.numCharts,
e.charts,"chart"),k=this._renderMediaPageButton("previous",b),d=this._renderMediaPageButton("next",b),t=this._activeMediaMap.get(b);isNaN(t)&&(this._activeMediaMap.set(b,0),t=0);return f?p.tsx("div",{key:v("media-element",b),"data-content-element-index":b,bind:this,onkeyup:this._handleMediaKeyup,class:this.classes("esri-feature__media","esri-feature__content-element",g)},p.tsx("ul",{class:"esri-feature__media-summary"},c,e),p.tsx("div",{key:v("media-element-container",b),class:"esri-feature__media-container"},
k,this._renderMediaInfo(a[t],b),d)):null};q.prototype._renderText=function(a,b){return a.text?p.tsx("div",{key:v("text-element",b),innerHTML:a.text,class:this.classes("esri-feature__text","esri-feature__content-element")}):null};q.prototype._attachToNode=function(a){a.appendChild(this)};q.prototype._getMediaStats=function(a){var b=0,c=0;a.forEach(function(a){a=a.type;"image"===a?b++:-1!==a.indexOf("chart")&&c++});return{total:c+b,images:b,charts:c}};q.prototype._setContentElementMedia=function(a,
b){this._clearMediaRefreshTimer(a);var c=this.viewModel.content;(c=(c=c&&c[a])&&c.mediaInfos)&&c.length&&(this._activeMediaMap.set(a,(b+c.length)%c.length),this._setupMediaRefreshTimer(a),this.scheduleRender())};q.prototype._pageContentElementMedia=function(a,b){b="previous"===b?-1:1;b=this._activeMediaMap.get(a)+b;this._setContentElementMedia(a,b)};q.prototype._previousClick=function(a){this.previousMedia(a.currentTarget["data-content-element-index"])};q.prototype._nextClick=function(a){this.nextMedia(a.currentTarget["data-content-element-index"])};
a([f.aliasOf("viewModel.contentEnabled")],q.prototype,"contentEnabled",void 0);a([f.aliasOf("viewModel.graphic")],q.prototype,"graphic",void 0);a([f.aliasOf("viewModel.title")],q.prototype,"title",void 0);a([f.aliasOf("viewModel.view")],q.prototype,"view",void 0);a([f.property({type:e}),p.renderable(["viewModel.waitingForContent","viewModel.content"])],q.prototype,"viewModel",void 0);a([p.accessibleHandler()],q.prototype,"_previousClick",null);a([p.accessibleHandler()],q.prototype,"_nextClick",null);
return q=a([f.subclass("esri.widgets.Feature")],q)}(f.declared(b))})},"esri/widgets/Feature/FeatureViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper dojo/i18n!dojo/cldr/nls/number ../../Graphic ../../core/date ../../core/Error ../../core/Handles ../../core/lang ../../core/Logger ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../support/arcadeUtils ../../tasks/support/AttachmentQuery ./support/featureUtils ./support/RelatedFeatures ../support/widget".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q,u,A,z){function x(a,b){return a&&"feature"===a.type?a.getField(b):null}function y(a){return a.replace(/[\u00A0-\u99999<>\&]/gim,function(a){return"\x26#"+a.charCodeAt(0)+";"})}var B=c.getLogger("esri.widgets.FeatureViewModel"),w=/^\s*expression\//i,H=new RegExp(""+d.group,"g"),E=new f("cancelled-query","cancelled feature query"),I=g.getFormat("short-date-short-time"),F="DateFormat"+I;return function(c){function f(a){a=c.call(this)||this;a._handles=new b;
a._featurePromise=void 0;a._layerDateFields=null;a._expressionAttributes=null;a.content=null;a.contentEnabled=!0;a.formattedAttributes=null;a.title="";a.view=null;return a}h(f,c);f.prototype.destroy=function(){this._clear();this._handles.destroy();this._expressionAttributes=this._layerDateFields=this.graphic=this.view=this._handles=null};Object.defineProperty(f.prototype,"graphic",{get:function(){return this._get("graphic")||null},set:function(a){if(a){var b=u.getSourceLayer(a);this._layerDateFields=
b?this._getDateFields(b):[]}this._set("graphic",a);this._graphicChanged(a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"waitingForContent",{get:function(){return!!this._featurePromise},enumerable:!0,configurable:!0});f.prototype._clear=function(){this._cancelFeatureQuery();this._set("title","");this._set("content",null);this._set("formattedAttributes",null)};f.prototype._graphicChanged=function(a){var b=this,c=this._handles;if(c&&(c.remove("graphic"),this._clear(),a)){c.add(p.watch(this,
"graphic.sourceLayer.popupTemplate.title graphic.sourceLayer.popupTemplate.content graphic.sourceLayer.popupTemplate.fieldInfos graphic.popupTemplate.title graphic.popupTemplate.content graphic.popupTemplate.fieldInfos contentEnabled".split(" "),function(){b._graphicChanged(b.graphic)}),"graphic");var e=!1;a=this._queryFeature().catch(function(a){a!==E&&B.error("error","error loading template",a)}).then(function(){e=!0;b._featurePromise=null;b.notifyChange("waitingForContent")});e||(this._featurePromise=
a,this.notifyChange("waitingForContent"))}};f.prototype._cancelFeatureQuery=function(){var a=this._featurePromise;a&&"function"===typeof a.cancel&&a.cancel(E);this._featurePromise=null;this.notifyChange("waitingForContent")};f.prototype._compileContent=function(a,b){var c=this;if(a&&(a.nodeName||a&&z.isWidgetBase(a)||z.isWidget(a)))return a;if("string"===typeof a)return this._compileText({type:"text",text:a}).text;if(Array.isArray(a))return a.map(function(a,e){e=(e=b&&b[e])&&e.value;var f=a.type;
if("attachments"===f)return c._compileAttachments(a,e);if("fields"===f)return c._compileFields(a);if("media"===f)return c._compileMedia(a);if("text"===f)return c._compileText(a)});a&&B.warn("invalid content type.")};f.prototype._compileFields=function(a){var b=this,c=this.graphic;a=e.clone(a);var f=(c=c.getEffectivePopupTemplate())&&c.expressionInfos,c=a.fieldInfos?void 0:c&&c.fieldInfos,c=a.fieldInfos||e.clone(c),g=[];c&&c.forEach(function(a){var c=a.fieldName.toLowerCase();if(!a.hasOwnProperty("visible")||
a.visible)c=b._isExpressionField(c)?b._getExpressionInfo(f,c):null,a.label=c?c.title:a.label,g.push(a)});a.fieldInfos=g;return a};f.prototype._setImageValue=function(a){var b=a.value,c=a.formattedAttributes;a=a.layer;var e=b.linkURL,f=b.sourceURL;f&&(f=this._fixTokens(f,a),b.sourceURL=this._substituteAttributes(c,f));e&&(a=this._fixTokens(e,a),b.linkURL=this._substituteAttributes(c,a))};f.prototype._compileMedia=function(a){var b=this,c=this._expressionAttributes,f=this._layerDateFields,g=this.graphic;
a=e.clone(a);var k=a.mediaInfos||[],d=l({},g.attributes,c),t=u.getSourceLayer(g),p=this.formattedAttributes.global,q={dateFormat:{properties:f,formatter:F}};a.mediaInfos=k.map(function(a){if(a=e.clone(a)){var c=a.value,f=a.type,g=a.title?b._processFieldsInLinks(a.title,d):"",k=a.caption?b._processFieldsInLinks(a.caption,d):"";a.title=g?b._substituteAttributes(p,g,q):"";a.caption=k?b._substituteAttributes(p,k,q):"";if("image"===f)return b._setImageValue({value:c,formattedAttributes:p,layer:t}),a.value.sourceURL?
a:void 0;if("pie-chart"===f||"line-chart"===f||"column-chart"===f||"bar-chart"===f)return b._setChartValue({value:c,attributes:d,formattedAttributes:p,layer:t}),a}}).filter(Boolean);return a};f.prototype._substituteAttributes=function(a,b,c){return(""+this._removeEmptyHref(e.substitute(a,b,c))).trim()};f.prototype._compileText=function(a){var b=this._expressionAttributes,c=this._layerDateFields,f=this.graphic;(a=e.clone(a))&&a.text&&(f=l({},f.attributes,b),b=this.formattedAttributes.global,c={dateFormat:{properties:c,
formatter:F}},f=this._processFieldsInLinks(a.text,f),a.text=this._substituteAttributes(b,f,c));return a};f.prototype._compileTitle=function(){var a=this._expressionAttributes,b=this._layerDateFields,c=this.graphic,e=c.getEffectivePopupTemplate(),e=e&&e.title,a=l({},c.attributes,a),b={dateFormat:{properties:b,formatter:F}},f=this.formattedAttributes.global;return"function"===typeof e?e.call(null,{graphic:c}):"string"===typeof e&&e?(c=this._processFieldsInLinks(e,a),this._substituteAttributes(f,c,b)):
""};f.prototype._getExpressionInfo=function(a,b){if(this._isExpressionField(b)){var c=b.replace(w,"").toLowerCase(),e;a.some(function(a){if(a.name.toLowerCase()===c)return e=a,!0});return e}};f.prototype._fixTokens=function(a,b){return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,c,e){return(a=x(b,e))?"{"+a.name+"}":c})};f.prototype._encodeAttributes=function(a){var b=a?e.clone(a):{};Object.keys(b).forEach(function(a){var c=b[a];"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),
b[a]=c)});return b};f.prototype._formatAttributesToFieldInfos=function(a,b,c){var f=this,g=e.clone(this._layerDateFields);a.forEach(function(e){var k=f._getFixedFieldName(e.fieldName,b);e.fieldName=k;c[k]=f._formatValue(c[k],{fieldInfos:a,fieldName:k,layer:b});g&&e.format&&e.format.dateFormat&&(e=g.indexOf(k),-1<e&&g.splice(e,1))})};f.prototype._getArcadeViewingMode=function(a){return a&&"local"===a.viewingMode?"localScene":"globalScene"};f.prototype._getViewInfo=function(){var a=this.view;if(a){var b=
"3d"===a.type?this._getArcadeViewingMode(a):"map";return r.getViewInfo({viewingMode:b,scale:a.scale,spatialReference:a.spatialReference})}};f.prototype._formatAttributes=function(a){var b=this,c=this._expressionAttributes,f=this.graphic,g=f.attributes,f=u.getSourceLayer(f),k=g?e.clone(g):{},d=l({},k,c);this.addRelatedFeatureAttributes(d);a&&this._formatAttributesToFieldInfos(a,f,d);if(f){var t=f.typeIdField;g&&Object.keys(g).forEach(function(a){if(!b.isRelatedField(a)){var c=g[a];null!=c&&(c=b._getDomainName(a,
c),null!=c?d[a]=c:a===t&&(c=b._getTypeName(),null!=c&&(d[a]=c)))}})}return d};f.prototype._formatValue=function(a,b){var c={dateFormat:{properties:this._layerDateFields,formatter:F}},f=b.fieldName,k=this._getFieldInfo(b.fieldInfos,f),l=e.clone(k),k=b.preventPlacesFormatting;(b=x(b.layer,f))&&"date"===b.type&&(b=l.format||{},b.dateFormat=b.dateFormat||"short-date-short-time",l.format=b);f=l&&l.format;if(null==a||!l||null==f)return a;var t=[],l=f.hasOwnProperty("places")||f.hasOwnProperty("digitSeparator");
b=f.hasOwnProperty("digitSeparator")?f.digitSeparator:!0;k=null!=f.places&&(!k||0<f.places);l&&k&&t.push("places: "+Number(f.places));k=l?k?"NumberFormat("+t.join(",")+")":"NumberFormat":f.dateFormat?"DateFormat"+(g.getFormat(f.dateFormat)||I):void 0;if(!k)return a;a=e.substitute({myKey:a},"{myKey:"+k+"}",c)||"";return l&&!b&&d.group?a.replace(H,""):a};f.prototype._getDomainName=function(a,b){var c=this.graphic,e=u.getSourceLayer(c);return e&&"feature"===e.type?(a=e.getFieldDomain(a,{feature:c}))&&
"coded-value"===a.type?a.getName(b):null:null};f.prototype._getFieldInfo=function(a,b){if(a&&a.length&&b){var c=b.toLowerCase(),e=void 0;a.some(function(a){if(a.fieldName&&a.fieldName.toLowerCase()===c)return e=a,!0});return e}};f.prototype._getTypeName=function(){var a=this.graphic,b=u.getSourceLayer(a);if(b&&"feature"===b.type&&(a=b.getFeatureType(a)))return a.name};f.prototype._removeEmptyHref=function(a){return a.replace(/href=(""|'')/gi,"")};f.prototype._processFieldsInLinks=function(a,b){var c=
this.get("graphic.layer");a=this._fixTokens(a,c);var f=this._encodeAttributes(b),c=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi;return a?a.replace(c,function(a,c,g){c=(""+(c||g)).trim();return e.substitute(c&&"{"===c[0]?b:f,a)}):a};f.prototype._compileAttachments=function(a,b){a=e.clone(a);if(!b)return a;a.attachmentInfos=b;return a};f.prototype._queryAttachments=function(){var a=this.graphic,b=u.getSourceLayer(a);if(!b)return t.resolve([]);if((b="scene"===b.type&&b.associatedLayer?b.associatedLayer:
b)&&"feature"===b.type){var c=b.objectIdField,e=(a=a.attributes)&&a[c],a=new q({objectIds:[e]});return b.queryAttachments(a).then(function(a){return a[e]||[]})}return t.resolve([])};f.prototype._queryContentElements=function(a){var b=this;if(!Array.isArray(a))return t.resolve();var c={};a.forEach(function(a,e){"attachments"===a.type&&(a=b._queryAttachments())&&(c[e]=a)});return Object.keys(c).length?t.eachAlways(c):t.resolve()};f.prototype._getContent=function(){var a=this.graphic;if(!this.contentEnabled)return t.resolve();
var b=a.getEffectivePopupTemplate(),b=b&&b.content,a="function"===typeof b?b.call(null,{graphic:a}):b;return t.isThenable(a)?a:t.resolve(a)};f.prototype._queryFeature=function(){var a=this;return this._getContent().then(function(b){return a._checkForRelatedFeatures(b).then(function(){a._expressionAttributes=a._createFormattedExpressions();a._set("formattedAttributes",a._createFormattedAttributes(b));a._set("title",a._compileTitle());return a._queryContentElements(b).then(function(c){c=a._compileContent(b,
c);a._set("content",c||null);return c})})})};f.prototype._isExpressionField=function(a){return w.test(a)};f.prototype._createCompiledExpressionDictionary=function(a){var b=new Map;if(!a)return b;a.forEach(function(a){return b.set(a.name,r.createFunction(a.expression))});return b};f.prototype._getDateFields=function(a){return(a=a.fields)?a.filter(function(a){return"date"===a.type}).map(function(a){return a.name}):[]};f.prototype._createFormattedExpressions=function(){var a=this,b=this.graphic,c=b.getEffectivePopupTemplate(),
c=c&&c.expressionInfos,e=this._createCompiledExpressionDictionary(c),f={};c&&c.forEach(function(c){var g="expression/"+c.name;c=e.get(c.name);var k=a._getViewInfo();c=r.executeFunction(c,r.createExecContext(b,k));f[g]="string"===typeof c?y(c):c});return f};f.prototype._createFormattedAttributes=function(a){var b=this,c=this.graphic.getEffectivePopupTemplate(),e={global:this._formatAttributes(c&&c.fieldInfos),content:[]};Array.isArray(a)&&a.forEach(function(a,c){"fields"===a.type&&a.fieldInfos&&(e.content[c]=
b._formatAttributes(a.fieldInfos))});return e};f.prototype._getAllFieldInfos=function(a){var b=[],c=this.graphic.getEffectivePopupTemplate();(c=c&&c.fieldInfos)&&b.push.apply(b,c);if(!a||!Array.isArray(a))return b;a.forEach(function(a){b.push.apply(b,a&&a.fieldInfos)});return b};f.prototype._checkForRelatedFeatures=function(a){var b=this.graphic;a=this._getAllFieldInfos(a);return this.queryRelatedInfos(b,a)};f.prototype._getChartOption=function(a){var b=a.value,c=a.attributes,e=a.formattedAttributes,
f=a.fieldName,g=a.relatedFieldName,k=a.fieldInfos;a=u.getSourceLayer(this.graphic);var l=b.normalizeField,t=b.tooltipField,l=l?this.isRelatedField(l)?c[this.getRelatedFieldInfo(l).fieldName]:c[l]:null,b=g&&void 0!==c[g]?c[g]:void 0!==c[f]?c[f]:e[f],b="string"===typeof b&&d.group?parseFloat(b.replace(H,"")):b,p=void 0===b?null:b&&l?b/l:b,b={y:p};if(this.isRelatedField(f))return e=this.getRelatedFieldInfo(f),f=(f=this.getRelatedFieldInfo(t))?f.fieldName:null,a=this._formatValue(p,{fieldInfos:k,fieldName:g,
layer:a,preventPlacesFormatting:!!l}),g=e?e.label||e.fieldName:g,b.tooltip=(f&&void 0!==c[f]?c[f]:g)+": "+a,b;c=this._getFieldInfo(k,f);g=this._getFixedFieldName(f,a);c=c?c.label||c.fieldName:f;b.tooltip=(t&&void 0!==e[t]?e[t]:c)+": "+e[g];return b};f.prototype._getFixedFieldName=function(a,b){return(b=x(b,a))?b.name:a};f.prototype._getFixedFieldNames=function(a,b){var c=this;return a&&a.map(function(a){return c._getFixedFieldName(a,b)})};f.prototype._setChartValue=function(a){var b=this,c=a.value,
e=a.attributes,f=a.formattedAttributes,g=a.layer,k=this.graphic,l=this.relatedInfoCount;a=c.fields;var d=c.normalizeField;c.fields=this._getFixedFieldNames(a,g);d&&(c.normalizeField=this._getFixedFieldName(d,g));if(a.some(function(a){return!!(null!=f[a]||b.isRelatedField(a)&&l)})){var t=(g=k.getEffectivePopupTemplate())&&g.fieldInfos;c.chartOptions=c.chartOptions||[];a.forEach(function(a){b.isRelatedField(a)?c.chartOptions=c.chartOptions.concat(b._getRelatedChartInfos({fieldInfos:t,fieldName:a,formattedAttributes:f,
value:c})):(a=b._getChartOption({value:c,attributes:e,formattedAttributes:f,fieldName:a,fieldInfos:t}),c.chartOptions.push(a))})}};f.prototype._getRelatedChartInfos=function(a){var b=this,c=a.fieldInfos,e=a.fieldName,f=a.formattedAttributes,g=a.value,k=[];a=this.getRelatedFieldInfo(e);var l=a.fieldName,d=this.getRelatedInfo(a.layerId);if(!d)return k;a=d.relatedFeatures;d=d.relation;if(!d||!a)return k;d=d.cardinality;a.forEach(function(a){var d=a.attributes;d&&Object.keys(d).forEach(function(a){a===
l&&k.push(b._getChartOption({value:g,attributes:d,formattedAttributes:f,fieldName:e,relatedFieldName:a,fieldInfos:c}))})});return"one-to-many"===d||"many-to-many"===d?k:[k[0]]};a([v.property({readOnly:!0})],f.prototype,"content",void 0);a([v.property()],f.prototype,"contentEnabled",void 0);a([v.property({readOnly:!0})],f.prototype,"formattedAttributes",void 0);a([v.property({type:k})],f.prototype,"graphic",null);a([v.property({readOnly:!0})],f.prototype,"title",void 0);a([v.property()],f.prototype,
"view",void 0);a([v.property({readOnly:!0})],f.prototype,"waitingForContent",null);return f=a([v.subclass("esri.widgets.FeatureViewModel")],f)}(v.declared(A))})},"esri/widgets/Feature/support/featureUtils":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.getSourceLayer=function(h){if(h)return h.get("sourceLayer")||h.get("layer")}})},"esri/widgets/Feature/support/RelatedFeatures":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../request ../../../core/Accessor ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../../../tasks/QueryTask ../../../tasks/support/Query ../../../tasks/support/StatisticDefinition ./featureUtils".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p){var v=new Map,r=g.getLogger("esri.widgets.Popup.support.RelatedFeatures");return function(g){function d(a){a=g.call(this)||this;a.relatedInfoCount=null;a.relatedInfos=new Map;return a}h(d,g);d.prototype.destroy=function(){this.relatedInfos.clear()};d.prototype.addRelatedFeatureAttributes=function(a){var b=this;this.relatedInfos.forEach(function(c){return b._addRelatedFeatureAttribute(a,c)})};d.prototype.getRelatedFieldInfo=function(a){if(-1===a.indexOf("relationships/"))return null;
a=a.split("/").slice(1);return{layerId:a[0],fieldName:a[1]}};d.prototype.getRelatedInfo=function(a){return this.relatedInfos.get(a.toString())};d.prototype.isRelatedField=function(a){void 0===a&&(a="");return a?-1!==a.indexOf("relationships/"):!1};d.prototype.queryRelatedInfos=function(a,b){var c=this;this.relatedInfos.clear();var e=p.getSourceLayer(a);if(!e)return f.resolve();var g=b.filter(function(a){return a&&c.isRelatedField(a.fieldName)});if(!g||!g.length)return f.resolve();this._createRelatedInfos(b,
e);return this._queryLayerInfos(e,b).then(function(b){c._updateRelatedInfoLayerInfos(b);return c._queryRelatedFeatureMap(a).then(function(a){Object.keys(a).forEach(function(b){c._setRelatedFeatures(a[b],b.toString())});return a})})};d.prototype._addRelatedFeatureAttribute=function(a,b){var c=this;a&&b&&("one-to-one"===b.relation.cardinality&&b.relatedFeatures&&b.relatedFeatures.forEach(function(e){return c._addAttributesFromFeature(a,e,b)}),b.relatedStatsFeatures&&b.relatedStatsFeatures.forEach(function(e){return c._addAttributesFromFeature(a,
e,b)}))};d.prototype._updateRelatedInfoLayerInfo=function(a,b){if(a=a.value)this.getRelatedInfo(b).layerInfo=a.data};d.prototype._updateRelatedInfoLayerInfos=function(a){var b=this;Object.keys(a).forEach(function(c){return b._updateRelatedInfoLayerInfo(a[c],c.toString())})};d.prototype._addAttributesFromFeature=function(a,b,c){var e=this;a&&b&&c&&Object.keys(b.attributes).forEach(function(f){var g=e._relatedFieldInfoToString({layerId:c.relation.id.toString(),fieldName:f});a[g]=b.attributes[f]})};
d.prototype._relatedFieldInfoToString=function(a){return a?"relationships/"+a.layerId+"/"+a.fieldName:""};d.prototype._createRelatedInfoForFieldInfo=function(a,b){var c=this.getRelatedFieldInfo(a.fieldName);if(c){var e=c.layerId,c=c.fieldName;e&&(b=this.getRelatedInfo(e)||this._createRelatedInfo(e,b))&&(b.relatedFields.push(c),a.statisticType&&(a=new t({statisticType:a.statisticType,onStatisticField:c,outStatisticFieldName:c}),b.outStatistics.push(a)))}};d.prototype._createRelatedInfos=function(a,
b){var c=this;a.forEach(function(a){return c._createRelatedInfoForFieldInfo(a,b)})};d.prototype._queryRelatedFeatureMap=function(a){var b=this,c={};this.relatedInfos.forEach(function(e,f){c[f]=b._queryRelatedLayerFeatures(a,e)});return f.eachAlways(c)};d.prototype._queryLayerInfos=function(a,b){var c=this,e={};this.relatedInfos.forEach(function(b,g){b=b.relation;if(!b)return g=new k("relation-required","A relation is required on a layer to retrieve related records."),r.error(g),f.reject(g);b=b.relatedTableId;
if(!b)return g=new k("A related table ID is required on a layer to retrieve related records."),r.error(g),f.reject(g);b=a.url+"/"+b;var d=v.get(b),l=d?d:c._queryLayerInfo(b);d||v.set(b,l);e[g]=l});return f.eachAlways(e)};d.prototype._queryLayerInfo=function(a){return l(a,{query:{f:"json"}})};d.prototype._queryRelatedLayerFeatures=function(a,b){var e=p.getSourceLayer(a).layerId.toString(),g=b.layerInfo,k=b.queryTask,d=b.relation;if(e=this._getDestinationRelation(g,e)){var d=d.keyField,l=e.keyField,
e="string"===this._getDestinationFieldType(g,e)?l+"\x3d'"+a.attributes[d]+"'":l+"\x3d"+a.attributes[d];a=k.execute(new c({where:e,outFields:b.relatedFields}));b=b.outStatistics&&0<b.outStatistics.length&&g.supportsStatistics?k.execute(new c({where:e,outFields:b.relatedFields,outStatistics:b.outStatistics})):null;return f.eachAlways({features:a,statsFeatures:b?b:f.resolve()})}return f.resolve()};d.prototype._setRelatedFeatures=function(a,b){if(b=this.getRelatedInfo(b)){var c=a.value;c&&(a=c.features,
c=c.statsFeatures,a=a&&a.value,b.relatedFeatures=a?a.features:[],a=c&&c.value,b.relatedStatsFeatures=a?a.features:[])}};d.prototype._getRelation=function(a,b){if("feature"!==b.type)return null;var c=null;b.relationships.some(function(b){if(b.id===parseInt(a,10))return c=b,!0});return c};d.prototype._createRelatedInfo=function(a,b){var c=this._getRelation(a,b);if(c){b=b.url+"/"+c.relatedTableId;var f=new e({url:b}),c={url:b,queryTask:f,relation:c,relatedFields:[],outStatistics:[]};this.relatedInfos.set(a,
c);return c}};d.prototype._getDestinationRelation=function(a,b){var c;a&&a.relationships&&a.relationships.some(function(a){if(""+a.relatedTableId===b)return c=a,!0});return c};d.prototype._getDestinationFieldType=function(a,b){var c=void 0;a.fields.some(function(a){if(a.name===b.keyField)return c=-1!==["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a.type)?"number":"string",!0});return c};a([b.aliasOf("relatedInfos.size")],d.prototype,"relatedInfoCount",
void 0);a([b.property()],d.prototype,"relatedInfos",void 0);return d=a([b.subclass("esri.widgets.Popup.support.RelatedFeatures")],d)}(b.declared(d))})},"esri/widgets/Feature/support/attachmentUtils":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});var h=n.toUrl("../../../themes/base/images/files/");m.isSupportedImage=function(a){a=a.toLowerCase();return"image/bmp"===a||"image/emf"===a||"image/exif"===a||"image/gif"===a||"image/x-icon"===a||"image/jpeg"===
a||"image/png"===a||"image/tiff"===a||"image/x-wmf"===a};m.getIconPath=function(a){return"text/plain"===a?h+"text-32.svg":"application/pdf"===a?h+"pdf-32.svg":"text/csv"===a?h+"csv-32.svg":"application/gpx+xml"===a?h+"gpx-32.svg":"application/x-dwf"===a?h+"cad-32.svg":"application/postscript"===a||"application/json"===a||"text/xml"===a||"model/vrml"===a?h+"code-32.svg":"application/x-zip-compressed"===a||"application/x-7z-compressed"===a||"application/x-gzip"===a||"application/x-tar"===a||"application/x-gtar"===
a||"application/x-bzip2"===a||"application/gzip"===a||"application/x-compress"===a||"application/x-apple-diskimage"===a||"application/x-rar-compressed"===a||"application/zip"===a?h+"zip-32.svg":-1!==a.indexOf("image/")?h+"image-32.svg":-1!==a.indexOf("audio/")?h+"sound-32.svg":-1!==a.indexOf("video/")?h+"video-32.svg":-1!==a.indexOf("msexcel")||-1!==a.indexOf("ms-excel")||-1!==a.indexOf("spreadsheetml")?h+"excel-32.svg":-1!==a.indexOf("msword")||-1!==a.indexOf("ms-word")||-1!==a.indexOf("wordprocessingml")?
h+"word-32.svg":-1!==a.indexOf("powerpoint")||-1!==a.indexOf("presentationml")?h+"report-32.svg":h+"generic-32.svg"}})},"esri/widgets/support/uriUtils":function(){define(["require","exports","dojo/i18n!./nls/uriUtils","../../core/lang"],function(n,m,h,a){function l(a){var g=null;d.some(function(f){f.pattern.test(a)&&(g=f);return!!g});return g}Object.defineProperty(m,"__esModule",{value:!0});var d=[{id:"http",pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:h.view},{id:"tel",pattern:/^\s*(tel:([^\s]+))\s*$/i,
label:"{hierPart}"},{id:"mailto",pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"arcgis-appstudio-player",pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"App Studio Player"},{id:"arcgis-collector",pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Collector"},{id:"arcgis-explorer",pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Explorer"},{id:"arcgis-navigator",pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,
label:h.openInApp,appName:"Navigator"},{id:"arcgis-survey123",pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Survey123"},{id:"arcgis-trek2there",pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Trek2There"},{id:"arcgis-workforce",pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:h.workforce},{id:"iform",pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"iForm"},{id:"flow",pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,
label:h.openInApp,appName:"FlowFinity"},{id:"lfmobile",pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Laserfische"},{id:"mspbi",pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:h.openInApp,appName:"Microsoft Power Bi"}];m.autoLink=function(k){if("string"!==typeof k||!k)return k;var g=l(k);if(!g)return k;var f=k.match(g.pattern),f=a.substitute({appName:g.appName,hierPart:f&&f[2]},g.label);return k.replace(g.pattern,"\x3ca "+(g.target?'target\x3d"'+g.target+'"':"")+'" href\x3d"$1"\x3e'+
f+"\x3c/a\x3e")}})},"esri/widgets/Spinner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./support/AnchorElementViewModel ./support/widget".split(" "),function(n,m,h,a,l,d,k,g,f,b){return function(e){function c(a){a=e.call(this)||this;a._animationDelay=500;a._animationPromise=null;a.location=null;a.view=null;a.visible=!1;a.viewModel=new f;return a}h(c,e);
c.prototype.postInitialize=function(){var a=this;this.own([d.watch(this,"visible",function(b){return a._visibleChange(b)})])};c.prototype.destroy=function(){this._cancelAnimationPromise()};c.prototype.show=function(a){var b=this,c=a.location;a=a.promise;c&&(this.viewModel.location=c);this.visible=!0;c=function(){return b.hide()};a&&a.catch(function(){}).then(c)};c.prototype.hide=function(){this.visible=!1};c.prototype.render=function(){var a,c=this.visible,e=!!this.viewModel.screenLocation,c=(a={},
a["esri-spinner--start"]=c&&e,a["esri-spinner--finish"]=!c&&e,a);a=this._getPositionStyles();return b.tsx("div",{class:this.classes("esri-spinner",c),styles:a})};c.prototype._cancelAnimationPromise=function(){var a=this._animationPromise;a&&a.cancel();this._animationPromise=null};c.prototype._visibleChange=function(a){var b=this;a?this.viewModel.screenLocationEnabled=!0:(this._cancelAnimationPromise(),this._animationPromise=l.after(this._animationDelay).then(function(){b.viewModel.screenLocationEnabled=
!1;b._animationPromise=null}))};c.prototype._getPositionStyles=function(){var a=this.viewModel,b=a.screenLocation,a=a.view;if(!a||!b)return{};a=a.padding;return{left:b.x-a.left+"px",top:b.y-a.top+"px"}};a([k.aliasOf("viewModel.location")],c.prototype,"location",void 0);a([k.aliasOf("viewModel.view")],c.prototype,"view",void 0);a([k.property(),b.renderable()],c.prototype,"visible",void 0);a([k.property({type:f}),b.renderable(["viewModel.screenLocation","viewModel.screenLocationEnabled"])],c.prototype,
"viewModel",void 0);return c=a([k.subclass("esri.widgets.Spinner")],c)}(k.declared(g))})},"esri/widgets/support/AnchorElementViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d,k,g,f,b){return function(e){function c(){var a=e.call(this)||this;a._anchorHandles=
new k;a.location=null;a.screenLocation=null;a.screenLocationEnabled=!1;a.view=null;a._anchorHandles.add([f.watch(a,"screenLocationEnabled,location,view.size",function(){return a._updateScreenPointAndHandle()}),f.watch(a,"view, view.ready",function(){return a._wireUpView()})]);return a}h(c,e);c.prototype.destroy=function(){this.view=null;this._anchorHandles&&this._anchorHandles.destroy();this._viewpointHandle=this._anchorHandles=null};c.prototype._wireUpView=function(){var a=this;this._anchorHandles.remove("view");
this._viewpointHandle=null;if(this.get("view.ready")){this._setScreenLocation();var b=this.view,b=g.pausable(b,"3d"===b.type?"camera":"viewpoint",function(){return a._viewpointChange()});this._anchorHandles.add(b,"view");this._viewpointHandle=b;this._toggleWatchingViewpoint()}};c.prototype._viewpointChange=function(){this._setScreenLocation();this.emit("view-change")};c.prototype._updateScreenPointAndHandle=function(){this._setScreenLocation();this._toggleWatchingViewpoint()};c.prototype._toggleWatchingViewpoint=
function(){var a=this._viewpointHandle,b=this.screenLocationEnabled;a&&(this.location&&b?a.resume():a.pause())};c.prototype._setScreenLocation=function(){var a=this.location,b=this.view,c=this.screenLocationEnabled,e=this.get("view.ready"),a=c&&a&&e?b.toScreen(a):null;this._set("screenLocation",a)};a([b.property()],c.prototype,"location",void 0);a([b.property({readOnly:!0})],c.prototype,"screenLocation",void 0);a([b.property()],c.prototype,"screenLocationEnabled",void 0);a([b.property()],c.prototype,
"view",void 0);return c=a([b.subclass("esri.widgets.support.AnchorElementViewModel")],c)}(b.declared(l,d))})},"esri/widgets/Popup/PopupViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Collection ../../core/Error ../../core/Handles ../../core/Logger ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/Point ../../geometry/support/webMercatorUtils ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../../views/support/layerViewUtils ../support/AnchorElementViewModel ../support/GoTo".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q,u,A,z){var x=new r({id:"zoom-to"}),y=d.ofType({key:"type",defaultKeyValue:"button",base:v,typeMap:{button:r,toggle:q}}),B=new y([x]),w=f.getLogger("esri.widgets.Popup.PopupViewModel");return function(f){function d(a){a=f.call(this)||this;a._handles=new g;a._pendingPromises=new Set;a._zoomToLocation=null;a.actions=B;a.autoCloseEnabled=!1;a.content=null;a.highlightEnabled=!0;a.title=null;a.updateLocationEnabled=!1;a.view=null;a.visible=!1;a.zoomFactor=4;return a}
h(d,f);d.prototype.initialize=function(){var a=this;this._handles.add([this.on("view-change",this._autoClose),e.watch(this,["highlightEnabled","selectedFeature","visible","view"],this._highlightFeature),e.watch(this,"view.animation.state",function(b){a._zoomToLocation||(x.disabled="waiting-for-target"===b)})])};d.prototype.destroy=function(){this._handles.destroy();this._handles=null;this._pendingPromises.clear();this.view=null};Object.defineProperty(d.prototype,"allActions",{get:function(){var a=
this._get("allActions")||new y;a.removeAll();var b=this.selectedFeature&&("function"===typeof this.selectedFeature.getEffectivePopupTemplate&&this.selectedFeature.getEffectivePopupTemplate()||this.selectedFeature.popupTemplate),c=b&&b.actions;(b=b&&b.overwriteActions?c:this.actions.concat(c))&&b.filter(Boolean).forEach(function(b){return a.add(b)});return a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"featureCount",{get:function(){return this.features.length},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"features",{get:function(){return this._get("features")||[]},set:function(a){a=a||[];this._set("features",a);var b=this.pendingPromisesCount,c=this.selectedFeatureIndex,e=this.promiseCount&&a.length;e&&b&&-1===c?this.selectedFeatureIndex=0:e&&-1!==c||(this.selectedFeatureIndex=a.length?0:-1)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"location",{get:function(){return this._get("location")||null},set:function(a){var b=this.get("location"),
c=this.get("view.spatialReference.isWebMercator");a&&a.get("spatialReference.isWGS84")&&c&&(a=p.geographicToWebMercator(a));this._set("location",a);a!==b&&this._centerAtLocation()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pendingPromisesCount",{get:function(){return this._pendingPromises.size},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"waitingForResult",{get:function(){return 0<this.pendingPromisesCount&&0===this.featureCount},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"promiseCount",{get:function(){return this.promises.length},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"promises",{get:function(){return this._get("promises")||[]},set:function(a){var b=this,c=this._get("promises");c&&c.forEach(function(a){a&&"function"===typeof a.cancel&&a.cancel()});this._pendingPromises.clear();this.features=[];Array.isArray(a)&&a.length?(this._set("promises",a),a=a.slice(0),a.forEach(function(a){b._pendingPromises.add(a);
a.then(function(c){b._updatePendingPromises(a);b._updateFeatures(c)},function(){return b._updatePendingPromises(a)})})):this._set("promises",[]);this.notifyChange("pendingPromisesCount")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"selectedFeature",{get:function(){var a=this.selectedFeatureIndex;if(-1===a)return null;a=this.features[a];if(!a)return null;this.updateLocationEnabled&&(this.location=this._getPointFromGeometry(a.geometry));return a},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"selectedFeatureIndex",{get:function(){var a=this._get("selectedFeatureIndex");return"number"===typeof a?a:-1},set:function(a){var b=this.featureCount;a=isNaN(a)||-1>a||!b?-1:(a+b)%b;this._set("selectedFeatureIndex",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});d.prototype.centerAtLocation=function(){var a=this.location,c=this.view;return a&&
c?this.callGoTo({target:{target:a,scale:c.scale}}):(a=new k("center-at-location:invalid-location-or-view","Cannot center at a location without a location and view.",{location:a,view:c}),w.error(a),b.reject(a))};d.prototype.clear=function(){this.set({promises:[],features:[],content:null,title:null,location:null})};d.prototype.open=function(a){this.set(l({visible:!1},{updateLocationEnabled:!1,promises:[]},a));this._setVisibleWhenContentExists()};d.prototype.triggerAction=function(a){(a=this.allActions.getItemAt(a))&&
this.emit("trigger-action",{action:a})};d.prototype.next=function(){this.selectedFeatureIndex+=1;return this};d.prototype.previous=function(){--this.selectedFeatureIndex;return this};d.prototype.zoomToLocation=function(){var a=this,c=this.location,e=this.selectedFeature,f=this.view,g=this.zoomFactor;if(!c||!f)return e=new k("zoom-to:invalid-location-or-view","Cannot zoom to location without a location and view.",{location:c,view:f}),w.error(e),b.reject(e);var g=f.scale/g,d=this.get("selectedFeature.geometry"),
f=e&&"3d"===f.type,c=(f=d||f)?e:c,l=d&&"point"===d.type,p=f&&l&&this._isScreenSize(e),e={target:c,scale:p?g:void 0};x.active=!0;x.disabled=!0;return this._zoomToLocation=e=this.callGoTo({target:e}).then(function(){p&&l&&(a.location=d);x.active=!1;x.disabled=!1;a._zoomToLocation=null}).catch(function(){x.active=!1;x.disabled=!1;a._zoomToLocation=null})};d.prototype._updatePendingPromises=function(a){a&&this._pendingPromises.has(a)&&(this._pendingPromises.delete(a),this.notifyChange("pendingPromisesCount"))};
d.prototype._setVisibleWhenContentExists=function(){var a=this,b=this._handles,c=this.promiseCount;b.remove("pendingVisible");c?(c=e.init(this,"pendingPromisesCount",function(c){a.featureCount&&(a.set("visible",!0),b.remove("pendingVisible"));c||b.remove("pendingVisible")}),b.add(c,"pendingVisible")):this.set("visible",!0)};d.prototype._autoClose=function(){this.autoCloseEnabled&&(this.visible=!1)};d.prototype._isScreenSize=function(a){var b=this.view;if("3d"!==b.type||"esri.Graphic"!==a.declaredClass)return!0;
if((b=b.getViewForGraphic(a))&&b.whenGraphicBounds){var c=!1;b.whenGraphicBounds(a,{useViewElevation:!0}).then(function(a){c=!a||!a.boundingBox||a.boundingBox[0]===a.boundingBox[3]&&a.boundingBox[1]===a.boundingBox[4]&&a.boundingBox[2]===a.boundingBox[5]});return c}return!0};d.prototype._getPointFromGeometry=function(a){return a?"point"===a.type?a:"extent"===a.type?a.center:"polygon"===a.type?a.centroid:"multipoint"===a.type||"polyline"===a.type?a.extent.center:null:null};d.prototype._centerAtLocation=
function(){var a=this.location,b=this.updateLocationEnabled,c=this.get("view.extent");b&&c&&a&&!c.contains(a)&&this.centerAtLocation()};d.prototype._highlightFeature=function(){var a=this;this._handles.remove("highlight");var b=this.selectedFeature,c=this.highlightEnabled,e=this.view,f=this.visible;if(b&&e&&c&&f){var g=b.layer;g&&e.when(function(){e.whenLayerView(g).then(function(c){if(c&&u.hasHighlight(c)){var e=g.objectIdField,f=b.attributes;c=c.highlight(f&&f[e]||b,{});a._handles.add(c,"highlight")}})})}};
d.prototype._updateFeatures=function(a){var b=this.features;a&&a.length&&(b.length?(a=a.filter(function(a){return-1===b.indexOf(a)}),this.features=b.concat(a)):this.features=a)};a([c.property({type:y})],d.prototype,"actions",void 0);a([c.property({dependsOn:["actions.length","selectedFeature.sourceLayer.popupTemplate.actions.length","selectedFeature.sourceLayer.popupTemplate.overwriteActions","selectedFeature.popupTemplate.actions.length","selectedFeature.popupTemplate.overwriteActions"],readOnly:!0})],
d.prototype,"allActions",null);a([c.property()],d.prototype,"autoCloseEnabled",void 0);a([c.property()],d.prototype,"content",void 0);a([c.property({readOnly:!0,dependsOn:["features"]})],d.prototype,"featureCount",null);a([c.property()],d.prototype,"features",null);a([c.property()],d.prototype,"highlightEnabled",void 0);a([c.property({type:t})],d.prototype,"location",null);a([c.property({readOnly:!0,dependsOn:["promises"]})],d.prototype,"pendingPromisesCount",null);a([c.property({readOnly:!0,dependsOn:["featureCount",
"pendingPromisesCount"]})],d.prototype,"waitingForResult",null);a([c.property({readOnly:!0,dependsOn:["promises"]})],d.prototype,"promiseCount",null);a([c.property()],d.prototype,"promises",null);a([c.property({value:null,readOnly:!0,dependsOn:["features","selectedFeatureIndex","updateLocationEnabled"]})],d.prototype,"selectedFeature",null);a([c.property({value:-1})],d.prototype,"selectedFeatureIndex",null);a([c.property({readOnly:!0,dependsOn:["view.ready"]})],d.prototype,"state",null);a([c.property()],
d.prototype,"title",void 0);a([c.property()],d.prototype,"updateLocationEnabled",void 0);a([c.property()],d.prototype,"view",void 0);a([c.property()],d.prototype,"visible",void 0);a([c.property()],d.prototype,"zoomFactor",void 0);a([c.property()],d.prototype,"centerAtLocation",null);a([c.property()],d.prototype,"clear",null);a([c.property()],d.prototype,"triggerAction",null);a([c.property()],d.prototype,"next",null);a([c.property()],d.prototype,"previous",null);a([c.property()],d.prototype,"zoomToLocation",
null);return d=a([c.subclass("esri.widgets.Popup.PopupViewModel")],d)}(c.declared(A,z))})},"esri/views/support/layerViewUtils":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.hasHighlight=function(h){return h&&"function"===typeof h.highlight}})},"esri/widgets/support/GoTo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(n,m,h,a,l,d){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a.goToOverride=null;a.view=null;return a}h(g,k);g.prototype.callGoTo=function(a){var b=this.view;return this.goToOverride?this.goToOverride(b,a):b.goTo(a.target,a.options)};a([d.property()],g.prototype,"goToOverride",void 0);a([d.property()],g.prototype,"view",void 0);return g=a([d.subclass("esri.widgets.support.GoTo")],g)}(d.declared(l))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../geometry ../Viewpoint ../core/Error ../core/Handles ../core/Logger ../core/promiseUtils ../core/accessorSupport/decorators ../geometry/support/webMercatorUtils ./View ./ViewAnimation ./2d/AnimationManager ./2d/FrameTask ./2d/MapViewConstraints ./2d/PaddedViewState ./2d/viewpointUtils".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q,u,A,z){var x=b.getLogger("esri.views.MapView");return function(b){function p(a){var c=b.call(this,a)||this;c._frameTask=new q.default(c);c._mapViewBaseHandles=new f;c._setup=!1;c.fullOpacity=1;c.interacting=!1;c.initialExtent=null;c.labelManager=null;c.resizeAlign="center";c.type="2d";c.constraints=new u;c.padding={top:0,right:0,bottom:0,left:0};var e=function(){this._set("updating",!this.layerViewManager||this.layerViewManager.factory.working||this.allLayerViews.some(function(a){return!0===
a.updating})||this.labelManager&&!0===this.labelManager.updating)}.bind(c),g=c._mapViewBaseHandles;g.add([c.watch("viewpoint",function(a){return c._flipStationary()},!0),c.on("resize",function(a){return c._resizeHandler(a)}),c.watch("animationManager.animation",function(a){c.animation=a}),c.watch("labelManager.updating",e),c.allLayerViews.on("change",function(){e();g.remove("layerViewsUpdating");g.add(c.allLayerViews.map(function(a){return a.watch("updating",e)}).toArray(),"layerViewsUpdating")})]);
e();c.watch("ready",function(a){a?(c._startup(),c._frameTask.start()):(c._frameTask.stop(),c._tearDown())});return c}a(p,b);p.prototype.destroy=function(){this.destroyed||(this._set("ready",!1),this._mapViewBaseHandles.removeAll(),this.layerViewManager.clear(),this._frameTask.destroy(),this._tearDown(),this._gotoTask=this._mapViewBaseHandles=this._frameTask=null)};Object.defineProperty(p.prototype,"animation",{set:function(a){var b=this,c=this._get("animation");a!==c&&(c&&c.stop(),!a||a.isFulfilled()?
this._set("animation",null):(this._set("animation",a),c=function(){a===b._get("animation")&&(b._set("animation",null),b._frameTask.requestFrame())},a.when(c,c,function(a){b.state&&(b.state.viewpoint=a.clone())})))},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"center",{get:function(){if(!this._setup)return this._get("center");var a=this.content.center;return new d.Point({x:a[0],y:a[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=a)if(this._normalizeInput(a))if(this._setup){var b=
this.viewpoint;z.centerAt(b,b,a);this.viewpoint=b}else this._set("center",a),this.notifyChange("initialExtentRequired");else x.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"constraints",{set:function(a){var b=this,c=this._get("constraints");c&&(this._mapViewBaseHandles.remove("constraints"),c.destroy());this._set("constraints",
a);a&&(this._setup&&(a.view=this,this.state.viewpoint=a.fit(this.content.viewpoint)),this._mapViewBaseHandles.add(a.on("update",function(){b._setup&&b.state&&(b.state.viewpoint=a.fit(b.content.viewpoint))}),"constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"extent",{get:function(){return this._setup?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?b.width&&b.height?this._setup?(a=this.viewpoint,z.setExtent(a,
a,b,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",b),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),this.notifyChange("initialExtentRequired")):x.error("#extent","invalid extent size"):x.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"initialExtentRequired",
{get:function(){var a=this.extent,b=this.center,c=this.scale,e=this.viewpoint,f=this.zoom;return this.get("map.initialViewProperties.viewpoint")||a||b&&(0!==c||-1!==f)||e?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"padding",{get:function(){return this._setup?this.state.padding:this._get("padding")},set:function(a){this._setup?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,
"rotation",{get:function(){return this._setup?this.content.rotation:this._get("rotation")},set:function(a){if(!isNaN(a))if(this._setup){var b=this.viewpoint;z.rotateTo(b,b,a);this.viewpoint=b}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"scale",{get:function(){return this._setup?this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this._setup){var b=this.viewpoint;z.scaleTo(b,b,a);this.viewpoint=b}else{this._set("scale",a);this._set("zoom",
-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"stationary",{get:function(){return!this.animation&&!this.interacting&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"viewpoint",{get:function(){if(!this._setup)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},
set:function(a){if(null!=a){var b=this._normalizeInput(a);b?this._setup?(a=z.create(),z.copy(a,b),this.constraints.constrain(a,this.content.viewpoint),this.state.viewpoint=a,this._frameTask.requestFrame(),this._set("viewpoint",a)):(this._set("viewpoint",b),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),this.notifyChange("initialExtentRequired")):!a.scale||isNaN(a.scale)?x.error("#viewpoint","invalid scale value of "+a.scale):a.targetGeometry?x.error("#viewpoint",
"incompatible spatialReference "+JSON.stringify(a.targetGeometry.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference)):x.error("#viewpoint","geometry not defined")}},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"zoom",{get:function(){return this._setup?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this._setup){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var b=
this._get("extent");b&&(this._set("extent",null),this._set("center",b.center))}this.constraints.effectiveLODs&&(b=this.viewpoint,z.scaleTo(b,b,this.constraints.zoomToScale(a)),this.viewpoint=b,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0});p.prototype.goTo=function(a,b){this.animation&&(this.animation=null);if(this._setup)return b=h({animate:!0},b),a=z.createAsync(a,this),this._gotoTask={},b.animate?this._gotoAnimated(a,b):this._gotoImmediate(a,b);x.error("#goTo()",
"MapView cannot be used before it is ready")};p.prototype.hitTest=function(a,b){return e.reject("Should be implemented by subclasses")};p.prototype.toMap=function(a,b,c){if(!this._setup)return null;a&&null!=a.x&&(c=b,b=a.y,a=a.x);var e=[0,0];this.state.toMap(e,[a,b]);c=c||new d.Point;c.x=e[0];c.y=e[1];c.spatialReference=this.spatialReference;return c};p.prototype.isTileInfoRequired=function(){return!0};p.prototype.toScreen=function(a,b,c,e){if(!this._setup)return null;a&&"object"===typeof a?(e=b||
new d.ScreenPoint,a=this._normalizeInput(a),b=a.y,a=a.x):e="number"===typeof c||null==c?e||new d.ScreenPoint:c||new d.ScreenPoint;a=[a,b];this.state.toScreen(a,a);e.x=a[0];e.y=a[1];return e};p.prototype.pixelSizeAt=function(a,b){if(!this._setup)return NaN;a&&null!=a.x&&(b=a.y,a=a.x);return this.content.pixelSizeAt([a,b])};p.prototype.requestLayerViewUpdate=function(a){this._setup&&this._frameTask.requestLayerViewUpdate(a)};p.prototype.requestUpdate=function(a){this._setup&&this._frameTask.requestUpdate(a)};
p.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null};p.prototype.isSpatialReferenceSupported=function(a,b){if(b||this._get("ready"))return!0;b=this._normalizeInput(this._get("center"),a);var c=this._normalizeInput(this._get("extent"),a),e=this._normalizeInput(this._get("viewpoint"),a),f=this._userSpatialReference,g=null,d=null;(e=e&&e.targetGeometry)&&("extent"===e.type?g=e:"point"===e.type&&
(d=e));e=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"),a);a=this._normalizeInput(this.initialExtent,a);a=c||g||e||a;return b||d||a&&a.center?!0:(f&&x.error("The view could not be initialized with the spatialReference "+f.wkid+".","Try specifying an extent or a center and scale"),!1)};p.prototype._createOrReplaceAnimation=function(a){if(!this.animation||this.animation.done)this.animation=new v;this.animation.update(a);return this.animation};p.prototype._cancellableGoTo=
function(a,b,c){var f=this,g=c.then(function(){a===f._gotoTask&&(f.animation=null)}).catch(function(c){a===f._gotoTask&&(f.animation=null,b.done||b.stop());throw c;}),d=e.create(function(a){return a(g)},function(){a!==f._gotoTask||b.done||b.stop()});b.catch(function(){a===f._gotoTask&&d.cancel()});return d};p.prototype._gotoImmediate=function(a,b){var c=this,e=this._gotoTask,f=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==c._gotoTask)throw new g("view:goto-interrupted","Goto was interrupted");
c.viewpoint=f.target=a;f.finish()});return this._cancellableGoTo(e,f,a)};p.prototype._gotoAnimated=function(a,b){var c=this,e=this._gotoTask,f=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==c._gotoTask)throw new g("view:goto-interrupted","Goto was interrupted");f.update(a);c.animationManager.animate(f,c.viewpoint,b);return f.when().then(function(){})});return this._cancellableGoTo(e,f,a)};p.prototype._resizeHandler=function(a){var b=this.state;if(b){var c=this.content.viewpoint,e=this.content.size.concat();
b.size=[a.width,a.height];z.resize(c,c,e,this.content.size,this.resizeAlign);c=this.constraints.constrain(c,null);this.state.viewpoint=c}};p.prototype._startup=function(){if(!this._setup){var a=this.constraints,b=this._get("zoom"),c=this._get("scale"),e=this._normalizeInput(this._get("center")),f=this._normalizeInput(this._get("extent")),g=this._get("rotation"),d=this._normalizeInput(this._get("viewpoint"));a.view=this;a.effectiveLODs?-1!==b&&(c=a.zoomToScale(b)):b=-1;var l=null,p=null,t=0,b=d&&d.rotation,
q=d&&d.targetGeometry;q&&("extent"===q.type?l=q:"point"===q.type&&(p=q,t=d.scale));d=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));q=this._normalizeInput(this.initialExtent);f=f||l||d||q;e=e||p||f&&f.center;c=c||t||f&&z.extentToScale(f,this.size);g=new k({targetGeometry:e,scale:c,rotation:g||b||0});a.fit(g);this._set("animationManager",new r);this._set("state",new A({padding:this._get("padding"),size:this.size,viewpoint:g}));this._set("content",this.state.content);
this._setup=!0}};p.prototype._tearDown=function(){if(this._setup){this._setup=!1;this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null,this.notifyChange("stationary"));var a=this._get("content"),b=a.center,c=a.spatialReference,b=new d.Point({x:b[0],y:b[1],spatialReference:c});this._set("viewpoint",null);this._set("extent",null);this._set("center",b);this._set("zoom",-1);this._set("rotation",a.rotation);this._set("scale",a.scale);this._set("spatialReference",c);this.constraints.view=
null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null}};p.prototype._flipStationary=function(){var a=this;this._stationaryTimer&&clearTimeout(this._stationaryTimer);this._stationaryTimer=setTimeout(function(){a._stationaryTimer=null;a.notifyChange("stationary")},160);this.notifyChange("stationary")};p.prototype._normalizeInput=function(a,b){void 0===b&&(b=this.spatialReference);var c=a&&a.targetGeometry||a;return b?
c?b.equals(c.spatialReference)?a:t.canProject(c,b)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=t.project(c,b),a):t.project(c,b):null:null:a};l([c.property()],p.prototype,"animation",null);l([c.property({readOnly:!0})],p.prototype,"animationManager",void 0);l([c.property({value:null,type:d.Point,dependsOn:["content.center"]})],p.prototype,"center",null);l([c.property({type:u})],p.prototype,"constraints",null);l([c.property({readOnly:!0})],p.prototype,"content",void 0);l([c.property({value:null,
type:d.Extent,dependsOn:["content.extent"]})],p.prototype,"extent",null);l([c.property()],p.prototype,"fullOpacity",void 0);l([c.property({readOnly:!0})],p.prototype,"interacting",void 0);l([c.property({type:d.Extent})],p.prototype,"initialExtent",void 0);l([c.property({dependsOn:["map.initialViewProperties?.viewpoint"]})],p.prototype,"initialExtentRequired",null);l([c.property()],p.prototype,"labelManager",void 0);l([c.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return h({top:0,
right:0,bottom:0,left:0},a)}})],p.prototype,"padding",null);l([c.property()],p.prototype,"resizeAlign",void 0);l([c.property({value:0,type:Number,dependsOn:["content.rotation"]})],p.prototype,"rotation",null);l([c.property({value:0,type:Number,dependsOn:["content.scale"]})],p.prototype,"scale",null);l([c.property({type:d.SpatialReference,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],p.prototype,"spatialReference",void 0);l([c.property({readOnly:!0})],
p.prototype,"state",void 0);l([c.property()],p.prototype,"stationary",null);l([c.property({readOnly:!0})],p.prototype,"type",void 0);l([c.property({value:null,type:k,dependsOn:["content.viewpoint"]})],p.prototype,"viewpoint",null);l([c.property({value:-1,dependsOn:["content.scale"]})],p.prototype,"zoom",null);return p=l([c.subclass("esri.views.MapViewBase")],p)}(c.declared(p))})},"esri/views/2d/AnimationManager":function(){define("../../core/Accessor ../../core/scheduling ../../core/now ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),
function(n,m,h,a,l,d){var k=function(a,f,b,e){var c=a.targetGeometry,g=f.targetGeometry;e?"string"===typeof e&&(e=l.parse(e)||l.ease):e=l.ease;this.easing=e;this.duration=b;this.sCenterX=c.x;this.sCenterY=c.y;this.sScale=a.scale;this.sRotation=a.rotation;this.tCenterX=g.x;this.tCenterY=g.y;this.tScale=f.scale;this.tRotation=f.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;
180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)};k.prototype.applyRatio=function(a,f){var b=this.easing(f),e,c;1<=f?(f=this.tCenterX,e=this.tCenterY,c=this.tRotation,b=this.tScale):(f=this.sCenterX+b*this.dCenterX,e=this.sCenterY+b*this.dCenterY,c=this.sRotation+b*this.dRotation,b=this.sScale+b*this.dScale);a.targetGeometry.x=f;a.targetGeometry.y=e;a.scale=b;a.rotation=c};return n.createSubclass({constructor:function(){this._updateTask=m.addFrameTask({postRender:this._postRender.bind(this)});
this._updateTask.pause()},getDefaults:function(){return{viewpoint:d.create()}},properties:{animation:null,duration:{value:200},transition:{value:null},easing:{value:l.ease},viewpoint:null},animate:function(a,f,b){this.stop();d.copy(this.viewpoint,f);this.transition=new k(this.viewpoint,a.target,b&&b.duration||this.duration,b&&b.easing||this.easing);f=function(){this.animation===a&&this._updateTask&&("finished"===a.state&&(this.transition.applyRatio(this.viewpoint,1),this.animation._dfd.progress(this.viewpoint)),
this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);a.when(f,f);this._startTime=h();this._updateTask.resume();return this.animation=a},animateContinous:function(g,f){this.stop();this.updateFunction=f;this.viewpoint=g;var b=new a({target:g.clone()});g=function(){this.animation===b&&this._updateTask&&(this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);b.when(g,g);this._startTime=h();this._updateTask.resume();return this.animation=b},stop:function(){this.animation&&
(this.animation.stop(),this.updateFunction=this.animation=null)},_postRender:function(g){var f=this.animation;f&&f.state!==a.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,g.deltaTime):(g=(h()-this._startTime)/this.transition.duration,f=1<=g,this.transition.applyRatio(this.viewpoint,g),f&&this.animation.finish()),this.animation._dfd.progress(this.viewpoint)):this._updateTask.pause()}})})},"esri/views/2d/unitBezier":function(){define([],function(){var n=function(h,a,l,d){function k(a,
c){var e,d,k,l;c=null==c?1E-6:c;k=a;for(d=0;8>d;d++){l=((b*k+f)*k+g)*k-a;if(Math.abs(l)<c)return k;e=(3*b*k+2*f)*k+g;if(1E-6>Math.abs(e))break;k-=l/e}e=0;d=1;k=a;if(k<e)return e;if(k>d)return d;for(;e<d;){l=((b*k+f)*k+g)*k;if(Math.abs(l-a)<c)break;a>l?e=k:d=k;k=.5*(d-e)+e}return k}var g=3*h,f=3*(l-h)-g,b=1-g-f,e=3*a,c=3*(d-a)-e,t=1-e-c;return function(a,b){a=k(a,b);return((t*a+c)*a+e)*a}},m=/^cubic-bezier\((.*)\)/;n.parse=function(h){var a=n[h]||null;!a&&(h=m.exec(h))&&(h=h[1].split(",").map(function(a){return parseFloat(a.trim())}),
4!==h.length||h.some(function(a){return isNaN(a)})||(a=n.apply(n,h)));return a};n.ease=n(.25,.1,.25,1);n.linear=n(0,0,1,1);n.easeIn=n["ease-in"]=n(.42,0,1,1);n.easeOut=n["ease-out"]=n(0,0,.58,1);n.easeInOut=n["ease-in-out"]=n(.42,0,.58,1);return n})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../Viewpoint ../../core/Error ../../core/promiseUtils ../../core/wgs84Constants ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils ./libs/gl-matrix/common ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q){function u(a,b,c,e){return e&&c&&!e.equals(c)&&t.canProject(e,c)&&e.isWebMercator?(e.isWebMercator?(c=b[1],89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999),c=Math.sin(v.toRadian(c)),a=q.set(a,v.toRadian(b[0])*M,.5*M*Math.log((1+c)/(1-c)))):(c=v.toDegree(b[0]/M),a=q.set(a,c-360*Math.floor((c+180)/360),v.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*b[1]/M))))),a):q.copy(a,b)}function A(a){return a.wkid?a:a.spatialReference||b.WGS84}function z(a,b){return b.type?
q.set(a,b.x,b.y):q.copy(a,b)}function x(a,b){return Math.max(a.width/b[0],a.height/b[1])*D(a.spatialReference)}function y(a,b,c){var e;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"===typeof a[0]&&"number"===typeof a[1])return new f(a);if(a.reduce)return a.reduce(function(a,c){return y(c,b,a)},c);a instanceof g?e=a:a.geometry&&(e=a.geometry);if(!e)return null;a="point"===e.type?new k({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference}):e.extent;if(!a)return null;
e=t.canProject(a,b);if(!a.spatialReference.equals(b)&&e)a=t.project(a,b);else if(!e)return null;return c=c?c.union(a):a.clone()}function B(a,b){if(!a)return new h({targetGeometry:new f,scale:0,rotation:0});var c=b.spatialReference,e=b.size,g=b.viewpoint,d=b.constraints,l=null;"esri.Viewpoint"===a.declaredClass?l=a:a.viewpoint?l=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(l=a.target);var r=null;if(l&&l.targetGeometry)r=l.targetGeometry;else if(a instanceof k)r=a;else if(a||a&&
(a.hasOwnProperty("center")||a.hasOwnProperty("extent")||a.hasOwnProperty("target")))r=y(a.center,c)||y(a.extent,c)||y(a.target,c)||y(a,c);!r&&g&&g.targetGeometry?r=g.targetGeometry:!r&&b.extent&&(r=b.extent);var v=A(r);c||(c=A(b.spatialReference||b.extent||r));if(!p.canProject(r,c)&&v&&!v.equals(c))return null;var m=z(q.create(),r.center?r.center:r),v=new f(u(m,m,v,c),c),m=null,m=l&&l.targetGeometry&&"point"===l.targetGeometry.type?l.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&
-1!==a.zoom&&d&&d.effectiveLODs?d.zoomToScale(a.zoom):Array.isArray(r)||"point"===r.type||"extent"===r.type&&0===r.width&&0===r.height?b.extent&&t.canProject(b.extent,c)?x(t.project(b.extent,c),e):b.extent?x(b.extent,e):g.scale:t.canProject(r.extent,c)?x(t.project(r.extent,c),e):x(r.extent,e);b=0;l?b=l.rotation:a.hasOwnProperty("rotation")?b=a.rotation:g&&(b=g.rotation);a=new h({targetGeometry:v,scale:m,rotation:b});d&&(a=d.fit(a),d.rotationEnabled||(a.rotation=b));return a}function w(a,b){var c=
a.targetGeometry,e=b.targetGeometry;c.x=e.x;c.y=e.y;c.spatialReference=e.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function H(a,b,c){return c?q.set(a,.5*(b[0]-c.right+c.left),.5*(b[1]-c.bottom+c.top)):q.scale(a,b,.5)}function E(a,b,c,e){m.getTransform(a,b,c,e);return r.invert(a,a)}function I(a,b,c){var e=v.toRadian(b.rotation)||0;b=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return q.set(a,Math.round(c[1]*e+c[0]*b),Math.round(c[1]*b+c[0]*e))}function F(a){return a.scale*(1/
(39.37*e.getMetersPerUnitForSR(a.targetGeometry.spatialReference)*96))}function D(a){return 39.37*e.getMetersPerUnitForSR(a)*96}function Q(a){return a.isWrappable?(a=c.getInfo(a),a.valid[1]-a.valid[0]):0}function N(a,b){return Math.round(Q(a)/b)}Object.defineProperty(m,"__esModule",{value:!0});var M=d.wgs84Radius,C=180/Math.PI;m.extentToScale=x;m.create=B;m.copy=w;m.getAnchor=H;m.getExtent=function(){var a=q.create();return function(b,c,e){var f=c.targetGeometry;z(a,f);c=.5*F(c);b.xmin=a[0]-c*e[0];
b.ymin=a[1]-c*e[1];b.xmax=a[0]+c*e[0];b.ymax=a[1]+c*e[1];b.spatialReference=f.spatialReference;return b}}();m.setExtent=function(a,b,c,e,f){m.centerAt(a,b,c.center);a.scale=x(c,e);f&&f.constraints&&f.constraints.constrain(a);return a};m.getOuterExtent=function(){var a=q.create(),b=q.create();return function(c,e,f){z(a,e.targetGeometry);I(b,e,f);f=.5*F(e);c.set({xmin:a[0]-f*b[0],ymin:a[1]-f*b[1],xmax:a[0]+f*b[0],ymax:a[1]+f*b[1],spatialReference:e.targetGeometry.spatialReference});return c}}();m.getClippedExtent=
function(){var a=q.create(),b=q.create();return function(c,e,f){var g=F(e),d=e.targetGeometry.spatialReference,k=N(d,g);z(a,e.targetGeometry);I(b,e,f);d.isWrappable&&b[0]>k&&(b[0]=k);e=.5*g;c.set({xmin:a[0]-e*b[0],ymin:a[1]-e*b[1],xmax:a[0]+e*b[0],ymax:a[1]+e*b[1],spatialReference:d});return c}}();m.getOuterSize=I;m.getPaddingScreenTranslation=function(){var a=q.create();return function(b,c,e){return q.sub(b,q.scale(b,c,.5),H(a,c,e))}}();var J=function(){var a=r.create(),b=q.create();return function(c,
e,f,g){var d=F(e);e=v.toRadian(e.rotation)||0;q.set(b,d,d);r.fromScaling(a,b);r.rotate(a,a,e);r.translate(a,a,m.getPaddingScreenTranslation(b,f,g));r.translate(a,a,[0,g.top-g.bottom]);return q.set(c,a[4],a[5])}}();m.getResolution=F;m.getResolutionToScaleFactor=D;m.getMatrix=function(){var a=q.create(),b=q.create(),c=q.create();return function(e,f,g,d,k,l){q.negate(a,f);q.scale(b,g,.5*l);q.set(c,1/d*l,-1/d*l);r.identity(e);r.translate(e,e,b);k&&r.rotate(e,e,k);r.scale(e,e,c);r.translate(e,e,a);return e}}();
m.getTransform=function(){var a=q.create();return function(b,c,e,f){var g=F(c),d=v.toRadian(c.rotation)||0;z(a,c.targetGeometry);return m.getMatrix(b,a,e,g,d,f)}}();m.getTransformNoRotation=function(){var a=q.create();return function(b,c,e,f){var g=F(c);z(a,c.targetGeometry);return m.getMatrix(b,a,e,g,0,f)}}();m.getWorldWidth=Q;m.getWorldScreenWidth=N;m.createAsync=function(b,c){if(b=B(b,c))return l.resolve(b);b=new a("viewpointUtils-createAsync:different-spatialReference","Target spatialReference cannot be projected and is different from out spatialReference");
return l.reject(b)};m.angleBetween=function(){var a=q.create(),b=q.create(),c=q.create();return function(e,f,g){q.subtract(a,e,f);q.normalize(a,a);q.subtract(b,e,g);q.normalize(b,b);q.cross(c,a,b);e=Math.acos(q.dot(a,b)/(q.length(a)*q.length(b)))*C;0>c[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();m.addPadding=function(){var a=q.create();return function(b,c,e,f){var g=b.targetGeometry;w(b,c);J(a,c,e,f);g.x+=a[0];g.y+=a[1];return b}}();m.removePadding=function(){var a=q.create();return function(b,c,e,f){var g=
b.targetGeometry;w(b,c);J(a,c,e,f);g.x-=a[0];g.y-=a[1];return b}}();m.centerAt=function(){var a=q.create();return function(b,c,e){w(b,c);c=b.targetGeometry;var f=A(e),g=A(c);z(a,e);u(a,a,f,g);c.x=a[0];c.y=a[1];return b}}();m.pixelSizeAt=function(a,b,c){return F(b)};m.resize=function(){var a=q.create();return function(b,c,e,f,g){g||(g="center");q.sub(a,e,f);q.scale(a,a,.5);e=a[0];f=a[1];switch(g){case "center":q.set(a,0,0);break;case "left":q.set(a,-e,0);break;case "top":q.set(a,0,f);break;case "right":q.set(a,
e,0);break;case "bottom":q.set(a,0,-f);break;case "top-left":q.set(a,-e,f);break;case "bottom-left":q.set(a,-e,-f);break;case "top-right":q.set(a,e,f);break;case "bottom-right":q.set(a,e,-f)}m.translateBy(b,c,a);return b}}();m.rotateBy=function(a,b,c){w(a,b);a.rotation+=c;return a};m.rotateTo=function(a,b,c){w(a,b);a.rotation=c;return a};m.scaleBy=function(){var a=q.create();return function(b,c,e,f,g){w(b,c);isNaN(e)||0===e||(m.toMap(a,f,c,g),b.scale=c.scale*e,m.toScreen(a,a,b,g),m.translateBy(b,
b,q.set(a,a[0]-f[0],f[1]-a[1])));return b}}();m.scaleTo=function(a,b,c){w(a,b);a.scale=c;return a};m.scaleAndRotateBy=function(){var a=q.create();return function(b,c,e,f,g,d){w(b,c);isNaN(e)||0===e||(m.toMap(a,g,c,d),b.scale=c.scale*e,b.rotation+=f,m.toScreen(a,a,b,d),m.translateBy(b,b,q.set(a,a[0]-g[0],g[1]-a[1])));return b}}();m.padAndScaleAndRotateBy=function(){var a=q.create(),b=q.create();return function(c,e,f,g,d,k,l){m.getPaddingScreenTranslation(b,k,l);q.add(a,d,b);return g?m.scaleAndRotateBy(c,
e,f,g,a,k):m.scaleBy(c,e,f,a,k)}}();m.toMap=function(){var a=r.create();return function(b,c,e,f){return q.transformMat2d(b,c,E(a,e,f,1))}}();m.toScreen=function(){var a=r.create();return function(b,c,e,f){return q.transformMat2d(b,c,m.getTransform(a,e,f,1))}}();m.translateBy=function(){var a=q.create(),b=r.create();return function(c,e,f){w(c,e);var g=F(e),d=c.targetGeometry;r.fromRotation(b,v.toRadian(e.rotation)||0);r.scale(b,b,q.fromValues(g,g));q.transformMat2d(a,f,b);d.x+=a[0];d.y+=a[1];return c}}()})},
"esri/views/2d/libs/gl-matrix/common":function(){define([],function(){if(!n)var n=1E-6;if(!m)var m="undefined"!==typeof Float32Array?Float32Array:Array;if(!h)var h=Math.random;var a={GLMAT_EPSILON:n,GLMAT_ARRAY_TYPE:m,GLMAT_RANDOM:h,setMatrixArrayType:function(d){a.GLMAT_ARRAY_TYPE=d}},l=Math.PI/180,d=180/Math.PI;a.toRadian=function(a){return a*l};a.toDegree=function(a){return a*d};a.setMatrixArrayType(Array);return a})},"esri/views/2d/libs/gl-matrix/mat2d":function(){define(["./common"],function(n){var m=
n.GLMAT_ARRAY_TYPE;n={create:function(){var h=new m(6);h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},clone:function(h){var a=new m(6);a[0]=h[0];a[1]=h[1];a[2]=h[2];a[3]=h[3];a[4]=h[4];a[5]=h[5];return a},copy:function(h,a){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];h[4]=a[4];h[5]=a[5];return h},identity:function(h){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},invert:function(h,a){var l=a[0],d=a[1],k=a[2],g=a[3],f=a[4];a=a[5];var b=l*g-d*k;if(!b)return null;b=1/b;h[0]=g*b;h[1]=-d*b;h[2]=
-k*b;h[3]=l*b;h[4]=(k*a-g*f)*b;h[5]=(d*f-l*a)*b;return h},determinant:function(h){return h[0]*h[3]-h[1]*h[2]},multiply:function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=l[0],c=l[1],t=l[2],p=l[3],v=l[4];l=l[5];h[0]=d*e+g*c;h[1]=k*e+f*c;h[2]=d*t+g*p;h[3]=k*t+f*p;h[4]=d*v+g*l+b;h[5]=k*v+f*l+a;return h}};n.mul=n.multiply;n.rotate=function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=Math.sin(l);l=Math.cos(l);h[0]=d*l+g*e;h[1]=k*l+f*e;h[2]=d*-e+g*l;h[3]=k*-e+f*l;h[4]=b;
h[5]=a;return h};n.scale=function(h,a,l){var d=a[1],k=a[2],g=a[3],f=a[4],b=a[5],e=l[0];l=l[1];h[0]=a[0]*e;h[1]=d*e;h[2]=k*l;h[3]=g*l;h[4]=f;h[5]=b;return h};n.translate=function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=l[0];l=l[1];h[0]=d;h[1]=k;h[2]=g;h[3]=f;h[4]=d*e+g*l+b;h[5]=k*e+f*l+a;return h};n.fromRotation=function(h,a){var l=Math.sin(a);a=Math.cos(a);h[0]=a;h[1]=l;h[2]=-l;h[3]=a;h[4]=0;h[5]=0;return h};n.fromScaling=function(h,a){h[0]=a[0];h[1]=0;h[2]=0;h[3]=a[1];h[4]=0;h[5]=
0;return h};n.fromTranslation=function(h,a){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=a[0];h[5]=a[1];return h};n.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"};n.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],2)+Math.pow(h[4],2)+Math.pow(h[5],2)+1)};return n})},"esri/views/2d/libs/gl-matrix/vec2":function(){define(["./common"],function(n){var m=n.GLMAT_ARRAY_TYPE,h=n.GLMAT_RANDOM,a={create:function(){var a=new m(2);
a[0]=0;a[1]=0;return a},clone:function(a){var d=new m(2);d[0]=a[0];d[1]=a[1];return d},fromValues:function(a,d){var k=new m(2);k[0]=a;k[1]=d;return k},copy:function(a,d){a[0]=d[0];a[1]=d[1];return a},set:function(a,d,k){a[0]=d;a[1]=k;return a},add:function(a,d,k){a[0]=d[0]+k[0];a[1]=d[1]+k[1];return a},subtract:function(a,d,k){a[0]=d[0]-k[0];a[1]=d[1]-k[1];return a}};a.sub=a.subtract;a.multiply=function(a,d,k){a[0]=d[0]*k[0];a[1]=d[1]*k[1];return a};a.mul=a.multiply;a.divide=function(a,d,k){a[0]=
d[0]/k[0];a[1]=d[1]/k[1];return a};a.div=a.divide;a.min=function(a,d,k){a[0]=Math.min(d[0],k[0]);a[1]=Math.min(d[1],k[1]);return a};a.max=function(a,d,k){a[0]=Math.max(d[0],k[0]);a[1]=Math.max(d[1],k[1]);return a};a.scale=function(a,d,k){a[0]=d[0]*k;a[1]=d[1]*k;return a};a.scaleAndAdd=function(a,d,k,g){a[0]=d[0]+k[0]*g;a[1]=d[1]+k[1]*g;return a};a.distance=function(a,d){var k=d[0]-a[0];a=d[1]-a[1];return Math.sqrt(k*k+a*a)};a.dist=a.distance;a.squaredDistance=function(a,d){var k=d[0]-a[0];a=d[1]-
a[1];return k*k+a*a};a.sqrDist=a.squaredDistance;a.length=function(a){var d=a[0];a=a[1];return Math.sqrt(d*d+a*a)};a.len=a.length;a.squaredLength=function(a){var d=a[0];a=a[1];return d*d+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];return a};a.inverse=function(a,d){a[0]=1/d[0];a[1]=1/d[1];return a};a.normalize=function(a,d){var k=d[0],g=d[1],k=k*k+g*g;0<k&&(k=1/Math.sqrt(k),a[0]=d[0]*k,a[1]=d[1]*k);return a};a.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]};a.cross=function(a,
d,k){d=d[0]*k[1]-d[1]*k[0];a[0]=a[1]=0;a[2]=d;return a};a.lerp=function(a,d,k,g){var f=d[0];d=d[1];a[0]=f+g*(k[0]-f);a[1]=d+g*(k[1]-d);return a};a.random=function(a,d){d=d||1;var k=2*h()*Math.PI;a[0]=Math.cos(k)*d;a[1]=Math.sin(k)*d;return a};a.transformMat2=function(a,d,k){var g=d[0];d=d[1];a[0]=k[0]*g+k[2]*d;a[1]=k[1]*g+k[3]*d;return a};a.transformMat2d=function(a,d,k){var g=d[0];d=d[1];a[0]=k[0]*g+k[2]*d+k[4];a[1]=k[1]*g+k[3]*d+k[5];return a};a.transformMat3=function(a,d,k){var g=d[0];d=d[1];a[0]=
k[0]*g+k[3]*d+k[6];a[1]=k[1]*g+k[4]*d+k[7];return a};a.transformMat4=function(a,d,k){var g=d[0];d=d[1];a[0]=k[0]*g+k[4]*d+k[12];a[1]=k[1]*g+k[5]*d+k[13];return a};a.forEach=function(){var l=a.create();return function(a,k,g,f,b,e){k||(k=2);g||(g=0);for(f=f?Math.min(f*k+g,a.length):a.length;g<f;g+=k)l[0]=a[g],l[1]=a[g+1],b(l,l,e),a[g]=l[0],a[g+1]=l[1];return a}}();a.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};return a})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/scheduling"],
function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function a(a){var d=this;this.view=a;this._frameTaskHandle=null;this.updateEnabled=this.stationary=!0;this.prepare=function(){d._updateParameters.state=d.view.state;d._updateParameters.stationary=d.view.stationary;d._updateParameters.pixelRatio=window.devicePixelRatio};this.update=function(){if(d.updateEnabled){for(var a=d.view,g=a.labelManager,f=a.allLayerViews.toArray().filter(function(a){return a.isFulfilled()&&null==
a.layerViews}),b=f.length,e=a.state,c=0;c<f.length;c++)if(a=f[c],a.attached){var l=a.lastUpdateId;if(null==l||!d.stationary&&!a.moving)a.moving=!0,a.moveStart();l!==e.id&&a.viewChange();d.stationary&&a.moving&&(a.moving=!1,a.moveEnd());a.lastUpdateId=e.id}g&&g.lastUpdateId!==e.id&&(g.viewChange(),g.lastUpdateId=e.id);g=d._layerViewsTrash;for(e=0;e<g.length;e++)a=g[e],d._detachLayerView(a);for(e=g.length=0;e<b;e++)a=f[e],a.isFulfilled()&&!a.attached&&d._attachLayerView(a);f=d._updateParameters;b=d._layerViewsToUpdate;
a=b.slice();b=b.length=0;for(e=a;b<e.length;b++)a=e[b],a.processUpdate(f);b=d._updatablesToUpdate;a=b.slice();for(b=b.length=0;b<a.length;b++)a[b].processUpdate(f);0===d._layerViewsToUpdate.length&&0===d._updatablesToUpdate.length&&0===g.length&&d._frameTaskHandle.pause()}}}a.prototype.destroy=function(){this.stop()};a.prototype.start=function(){var a=this;this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:!0};this._layerViewsTrash=[];this._layerViewsToUpdate=
[];this._updatablesToUpdate=[];this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(d){Array.prototype.push.apply(a._layerViewsTrash,d.removed);a.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(d){a.stationary=d;a.requestFrame()});this._frameTaskHandle=h.addFrameTask(this)};a.prototype.stop=function(){var a=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(d){return a._detachLayerView(d)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),
this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=null,this.stationary=!0)};a.prototype.requestLayerViewUpdate=function(a){this._layerViewsToUpdate.push(a);this.requestFrame()};a.prototype.requestUpdate=function(a){this._updatablesToUpdate.push(a);this.requestFrame()};a.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.resume()};a.prototype._attachLayerView=
function(a){a.attached||(a.attached=!0,a.moving=!1,a.attach())};a.prototype._detachLayerView=function(a){a.attached&&(a.detach(),a.attached=!1,a.moving=!1)};return a}();m.default=n})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Evented ../../core/accessorSupport/decorators ../../layers/support/LOD ./constraints/RotationConstraint ./constraints/ZoomConstraint".split(" "),
function(n,m,h,a,l,d,k,g,f,b){return function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.enabled=!0;a.lods=null;a.minScale=0;a.maxScale=0;a.minZoom=-1;a.maxZoom=-1;a.rotationEnabled=!0;a.snapToZoom=!0;return a}h(c,e);c.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};c.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(c.prototype,"_rotation",{get:function(){return new f({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_zoom",{get:function(){return new b({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});c.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b};c.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||a<=b};c.prototype.constrain=function(a,b){if(!this.enabled)return a;this._zoom.constrain(a,b);this._rotation.constrain(a,b);return a};c.prototype.fit=function(a){if(!this.enabled||!this.snapToZoom)return a;this._zoom.fit(a);return a};c.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)};c.prototype.scaleToZoom=
function(a){return this._zoom.scaleToZoom(a)};c.prototype.snapScale=function(a){return this._zoom.snapToClosestScale(a)};c.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)};c.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)};a([k.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c.prototype,"effectiveLODs",void 0);a([k.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c.prototype,"effectiveMinScale",void 0);a([k.property({readOnly:!0,
aliasOf:"_zoom.effectiveMaxScale"})],c.prototype,"effectiveMaxScale",void 0);a([k.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c.prototype,"effectiveMinZoom",void 0);a([k.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c.prototype,"effectiveMaxZoom",void 0);a([k.property()],c.prototype,"enabled",void 0);a([k.property({type:[g]})],c.prototype,"lods",void 0);a([k.property()],c.prototype,"minScale",void 0);a([k.property()],c.prototype,"maxScale",void 0);a([k.property()],c.prototype,
"minZoom",void 0);a([k.property()],c.prototype,"maxZoom",void 0);a([k.property()],c.prototype,"rotationEnabled",void 0);a([k.property()],c.prototype,"snapToZoom",void 0);a([k.property()],c.prototype,"view",void 0);a([k.property({type:f,dependsOn:["rotationEnabled"]})],c.prototype,"_rotation",null);a([k.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],c.prototype,"_defaultLODs",null);a([k.property({readOnly:!0,type:b,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],
c.prototype,"_zoom",null);return c=a([k.subclass("esri.views.2d.MapViewConstraints")],c)}(k.declared(l,d))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a.enabled=!0;a.rotationEnabled=!0;return a}h(g,k);
f=g;g.prototype.constrain=function(a,e){if(!this.enabled||!e)return a;this.rotationEnabled||(a.rotation=e.rotation);return a};g.prototype.clone=function(){return new f({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};var f;a([d.property()],g.prototype,"enabled",void 0);a([d.property()],g.prototype,"rotationEnabled",void 0);return g=f=a([d.subclass("esri.views.2d.constraints.RotationConstraint")],g)}(d.declared(l))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../layers/support/LOD".split(" "),
function(n,m,h,a,l,d,k){return function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;a._lodByScale={};a._scales=[];a.effectiveLODs=null;a.effectiveMinZoom=-1;a.effectiveMaxZoom=-1;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.enabled=!0;a.lods=null;a.minZoom=-1;a.maxZoom=-1;a.minScale=0;a.maxScale=0;a.snapToZoom=!0;return a}h(f,g);b=f;f.prototype.initialize=function(){var a=this,b,f,g=this.lods;f=this.minScale;b=this.maxScale;var d=this.minZoom,k=this.maxZoom,l=-1,h=-1,m=!1,n=!1;
0!==f&&0!==b&&f<b&&(b=[b,f],f=b[0],b=b[1]);if(g&&g.length){g=g.map(function(a){return a.clone()});g.sort(function(a,b){return b.scale-a.scale});g.forEach(function(a,b){return a.level=b});for(var x,y=0,B=g;y<B.length;y++){var w=B[y];!m&&0<f&&f>=w.scale&&(l=w.level,m=!0);!n&&0<b&&b>=w.scale&&(h=x?x.level:-1,n=!0);x=w}-1===d&&(d=0===f?0:l);-1===k&&(k=0===b?g.length-1:h);d=Math.max(d,0);d=Math.min(d,g.length-1);k=Math.max(k,0);k=Math.min(k,g.length-1);d>k&&(f=[k,d],d=f[0],k=f[1]);f=g[d].scale;b=g[k].scale;
g.splice(0,d);g.splice(k-d+1,g.length);g.forEach(function(b,c){a._lodByScale[b.scale]=b;a._scales[c]=b.scale});this._set("effectiveLODs",g);this._set("effectiveMinZoom",d);this._set("effectiveMaxZoom",k)}this._set("effectiveMinScale",f);this._set("effectiveMaxScale",b)};f.prototype.constrain=function(a,b){if(!this.enabled||b&&a.scale===b.scale)return a;var c=this.effectiveMinScale,e=this.effectiveMaxScale,f=a.targetGeometry,g=b&&b.targetGeometry,d=0!==c&&a.scale>c;if(0!==e&&a.scale<e||d)c=d?c:e,g&&
(b=(c-b.scale)/(a.scale-b.scale),f.x=g.x+(f.x-g.x)*b,f.y=g.y+(f.y-g.y)*b),a.scale=c;this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale));return a};f.prototype.fit=function(a){if(!this.effectiveLODs)return this.constrain(a,null);var b=a.scale,e=this.scaleToZoom(b);a.scale=.99<Math.abs(e-Math.round(e))?this.snapToPreviousScale(b):this.zoomToScale(Math.round(e));return a};f.prototype.zoomToScale=function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,
a);var b=this._scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var e=Math.round(a);return b[e]+(e-a)*(b[Math.round(a-.5)]-b[e])};f.prototype.scaleToZoom=function(a){if(!this.effectiveLODs)return-1;var b=this._scales,e=0,f=b.length-1,g,d;for(e;e<f;e++){g=b[e];d=b[e+1];if(g<=a)return e+this.effectiveMinZoom;if(d===a)return e+1+this.effectiveMinZoom;if(g>a&&d<a)return e+1-(a-d)/(g-d)+this.effectiveMinZoom}return e};f.prototype.snapToClosestScale=function(a){if(!this.effectiveLODs)return a;
a=this.scaleToZoom(a);return this.zoomToScale(Math.round(a))};f.prototype.snapToNextScale=function(a,b){void 0===b&&(b=.5);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a+1)};f.prototype.snapToPreviousScale=function(a,b){void 0===b&&(b=2);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a-1)};f.prototype.clone=function(){return new b({enabled:this.enabled,lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,
minScale:this.minScale,maxScale:this.maxScale})};f.prototype._getClosestScale=function(a){if(this._lodByScale[a])return this._lodByScale[a].scale;a=this._scales.reduce(function(b,e,f,g){return Math.abs(e-a)<=Math.abs(b-a)?e:b},this._scales[0]);return this._lodByScale[a].scale};var b;a([d.property({readOnly:!0})],f.prototype,"effectiveLODs",void 0);a([d.property({readOnly:!0})],f.prototype,"effectiveMinZoom",void 0);a([d.property({readOnly:!0})],f.prototype,"effectiveMaxZoom",void 0);a([d.property({readOnly:!0})],
f.prototype,"effectiveMinScale",void 0);a([d.property({readOnly:!0})],f.prototype,"effectiveMaxScale",void 0);a([d.property()],f.prototype,"enabled",void 0);a([d.property({type:[k]})],f.prototype,"lods",void 0);a([d.property()],f.prototype,"minZoom",void 0);a([d.property()],f.prototype,"maxZoom",void 0);a([d.property()],f.prototype,"minScale",void 0);a([d.property()],f.prototype,"maxScale",void 0);a([d.property()],f.prototype,"snapToZoom",void 0);return f=b=a([d.subclass("esri.views.2d.constraints.ZoomConstraint")],
f)}(d.declared(l))})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./viewpointUtils ./ViewState ./libs/gl-matrix/common ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2".split(" "),function(n,m,h,a,l,d,k,g,f,b,e){var c=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}h(c,b);a([d.property()],
c.prototype,"left",void 0);a([d.property()],c.prototype,"top",void 0);a([d.property()],c.prototype,"right",void 0);a([d.property()],c.prototype,"bottom",void 0);return c=a([d.subclass("esri.views.2d.PaddedViewState.Padding")],c)}(d.declared(l));return function(l){function p(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=l.apply(this,a)||this;a.content=new g;a.padding=new c;a.size=e.fromValues(0,0);return a}h(p,l);Object.defineProperty(p.prototype,"clipRect",{get:function(){var a=this.worldScreenWidth;
if(!a)return null;var c=f.toRadian(this.rotation),g=this.width*Math.abs(Math.cos(c))+this.height*Math.abs(Math.sin(c));if(a>g)return null;var d=e.clone(this.screenCenter),k=b.fromTranslation(b.create(),d);b.rotate(k,k,c);e.negate(d,d);b.translate(k,k,d);e.transformMat2d(d,this.paddedScreenCenter,k);return{top:-Math.round(g),left:Math.round(d[0]-.5*a),right:Math.round(d[0]+.5*a),bottom:+Math.round(g)}},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"padding",{set:function(a){this._set("padding",
a||new c);this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"size",{set:function(a){this._set("size",a);this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"paddedScreenCenter",{get:function(){var a=this.content.size,b=this.padding,a=e.scale(e.create(),a,.5);a[0]+=b.left;a[1]+=b.top;return a},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"viewpoint",{set:function(a){var b=a.clone();this.content.viewpoint=
a;k.addPadding(b,a,this._get("size"),this._get("padding"));this._set("viewpoint",k.addPadding(b.clone(),a,this._get("size"),this._get("padding")))},enumerable:!0,configurable:!0});p.prototype._updateContent=function(){var a=e.create(),b=this._get("size"),c=this._get("padding");if(b&&c){var f=this.content;e.set(a,c.left+c.right,c.top+c.bottom);e.subtract(a,b,a);f.size=a;if(a=f.viewpoint)this.viewpoint=a}};a([d.shared({transform:{dependsOn:["padding"]}})],p.prototype,"properties",void 0);a([d.property({dependsOn:["worldScreenWidth",
"rotation","paddedScreenCenter","screenCenter"],readOnly:!0})],p.prototype,"clipRect",null);a([d.property()],p.prototype,"content",void 0);a([d.property({type:c})],p.prototype,"padding",null);a([d.property()],p.prototype,"size",null);a([d.property({dependsOn:["size","padding"],readOnly:!0})],p.prototype,"paddedScreenCenter",null);a([d.property()],p.prototype,"viewpoint",null);return p=a([d.subclass("esri.views.2d.PaddedViewState")],p)}(d.declared(g))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../geometry/Extent ./viewpointUtils ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e){var c=[0,0];return function(d){function p(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=d.apply(this,a)||this;a.pixelRatio=1;a.size=[0,0];return a}h(p,d);t=p;Object.defineProperty(p.prototype,"center",{get:function(){var a=this.viewpoint.targetGeometry;return e.set(e.create(),a.x,a.y)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"extent",{get:function(){return f.getExtent(new g,this.viewpoint,this.size)},enumerable:!0,configurable:!0});
Object.defineProperty(p.prototype,"height",{get:function(){return this.size?this.size[1]:0},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"id",{get:function(){return this._get("id")+1},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"inverseTransform",{get:function(){return b.invert(b.create(),this.transform)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"latitude",{get:function(){return this.viewpoint.targetGeometry.latitude},enumerable:!0,
configurable:!0});Object.defineProperty(p.prototype,"longitude",{get:function(){return this.viewpoint.targetGeometry.longitude},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"resolution",{get:function(){return f.getResolution(this.viewpoint)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"rotation",{get:function(){return this.viewpoint.rotation},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"scale",{get:function(){return this.viewpoint.scale},
enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"screenCenter",{get:function(){return e.scale(e.create(),this.size,.5)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"spatialReference",{get:function(){return this.viewpoint.targetGeometry.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"transform",{get:function(){return f.getTransform(b.create(),this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,
"transformNoRotation",{get:function(){return f.getTransformNoRotation(b.create(),this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"clippedExtent",{get:function(){return f.getClippedExtent(new g,this.viewpoint,this.size)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"width",{get:function(){return this.size?this.size[0]:0},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"worldScreenWidth",{get:function(){return f.getWorldScreenWidth(this.spatialReference,
this.resolution)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"worldWidth",{get:function(){return f.getWorldWidth(this.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"wrappable",{get:function(){return!!this.spatialReference&&this.spatialReference.isWrappable},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"x",{get:function(){return this.center[0]},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"y",{get:function(){return this.center[1]},
enumerable:!0,configurable:!0});p.prototype.copy=function(a){var b=this.size,c=this.viewpoint;this.viewpoint=null;this._set("size",null);c&&b?(this.viewpoint=f.copy(c,a.viewpoint),this._set("size",e.copy(b,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};p.prototype.clone=function(){return new t({viewpoint:this.viewpoint.clone(),size:e.clone(this.size)})};p.prototype.toMap=function(a,b,f){if(Array.isArray(b))return e.transformMat2d(a,
b,this.inverseTransform);c[0]=b;c[1]=f;return e.transformMat2d(a,c,this.inverseTransform)};p.prototype.toScreen=function(a,b,f){if(Array.isArray(b))return e.transformMat2d(a,b,this.transform);c[0]=b;c[1]=f;return e.transformMat2d(a,c,this.transform)};p.prototype.toScreenNoRotation=function(a,b,f){if(Array.isArray(b))return e.transformMat2d(a,b,this.transformNoRotation);c[0]=b;c[1]=f;return e.transformMat2d(a,c,this.transformNoRotation)};p.prototype.pixelSizeAt=function(a){return f.pixelSizeAt(a,this.viewpoint,
this.size)};var t;a([k.property({dependsOn:["viewpoint.targetGeometry.x","viewpoint.targetGeometry.y"]})],p.prototype,"center",null);a([k.property({readOnly:!0,dependsOn:["viewpoint.scale","viewpoint.targetGeometry.x","viewpoint.targetGeometry.y","viewpoint.targetGeometry.spatialReference","size"]})],p.prototype,"extent",null);a([k.property({readOnly:!0,dependsOn:["size"]})],p.prototype,"height",null);a([k.property({value:0,readOnly:!0,dependsOn:["transform"]})],p.prototype,"id",null);a([k.property({readOnly:!0,
dependsOn:["transform"]})],p.prototype,"inverseTransform",null);a([k.property({readOnly:!0,dependsOn:["viewpoint.targetGeometry.latitude"]})],p.prototype,"latitude",null);a([k.property({readOnly:!0,dependsOn:["viewpoint.targetGeometry.longitude"]})],p.prototype,"longitude",null);a([k.property({type:Number,json:{write:!0}})],p.prototype,"pixelRatio",void 0);a([k.property({readOnly:!0,dependsOn:["viewpoint.scale","viewpoint.targetGeometry.spatialReference"]})],p.prototype,"resolution",null);a([k.property({readOnly:!0,
dependsOn:["viewpoint.rotation"]})],p.prototype,"rotation",null);a([k.property({readOnly:!0,dependsOn:["viewpoint.scale"]})],p.prototype,"scale",null);a([k.property({readOnly:!0,dependsOn:["size"]})],p.prototype,"screenCenter",null);a([k.property({json:{write:!0}})],p.prototype,"size",void 0);a([k.property({readOnly:!0,dependsOn:["viewpoint.targetGeometry.spatialReference"]})],p.prototype,"spatialReference",null);a([k.property({readOnly:!0,dependsOn:"viewpoint.rotation viewpoint.scale viewpoint.targetGeometry.x viewpoint.targetGeometry.y viewpoint.targetGeometry.spatialReference size pixelRatio".split(" ")})],
p.prototype,"transform",null);a([k.property({readOnly:!0,dependsOn:"viewpoint.scale viewpoint.targetGeometry.x viewpoint.targetGeometry.y viewpoint.targetGeometry.spatialReference size pixelRatio".split(" ")})],p.prototype,"transformNoRotation",null);a([k.property({type:l,json:{write:!0}})],p.prototype,"viewpoint",void 0);a([k.property({readOnly:!0,dependsOn:"viewpoint.rotation viewpoint.scale viewpoint.targetGeometry.x viewpoint.targetGeometry.y viewpoint.targetGeometry.spatialReference size".split(" ")})],
p.prototype,"clippedExtent",null);a([k.property({readOnly:!0,dependsOn:["size"]})],p.prototype,"width",null);a([k.property({readOnly:!0,dependsOn:["worldWidth","resolution"]})],p.prototype,"worldScreenWidth",null);a([k.property({readOnly:!0,dependsOn:["spatialReference"]})],p.prototype,"worldWidth",null);a([k.property({readOnly:!0,dependsOn:["spatialReference"]})],p.prototype,"wrappable",null);a([k.property({readOnly:!0,dependsOn:["center"]})],p.prototype,"x",null);a([k.property({readOnly:!0,dependsOn:["center"]})],
p.prototype,"y",null);return p=t=a([k.subclass("esri.views.2d.ViewState")],p)}(k.declared(d))})},"esri/views/2d/LabelManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/HandleOwner ../../core/throttle ../../core/accessorSupport/decorators ../../layers/support/TileInfo ./engine/webgl/definitions ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./tiling/TileInfoView".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t){Object.defineProperty(m,"__esModule",{value:!0});n=function(d){function l(a){a=d.call(this)||this;a._applyVisivilityPassThrottled=k.throttle(a._applyVisivilityPass,64,a);a._previousResolution=Number.POSITIVE_INFINITY;a.lastUpdateId=-1;a.updateRequested=!1;a.view=null;return a}h(l,d);l.prototype.initialize=function(){var a=this,g=f.create({spatialReference:this.view.spatialReference,size:b.TILE_SIZE});this._tileInfoView=new t(g);this._collisionEngine=new e.default(g);
this._layerViewSorter=new c.default(function(b,c){a._collisionEngine.registerLayer(b.layer,c);(c=b.tileRenderer)&&c.forEachTile(function(c){c.isDirty=!0;a.addTile(b.layer.uid,c)});a.requestUpdate()},function(b){a._collisionEngine.unregisterLayer(b.layer);a.requestUpdate()},function(a){(a=a.get("tileRenderer.featuresView"))&&a.fadeInLabels()});this.handles.add(this.view.allLayerViews.on("change",function(b){a._layerViewSorter.update(b)}))};l.prototype.destroy=function(){this._layerViewSorter.destroy();
this._collisionEngine=this._layerViewSorter=null;this._applyVisivilityPassThrottled.remove()};Object.defineProperty(l.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!0,configurable:!0});l.prototype.update=function(a){var b=this._previousResolution,c=a.state.resolution;this._previousResolution=c;c===b&&this._applyVisivilityPassThrottled(a)};l.prototype.viewChange=function(){this.requestUpdate()};l.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=
!0,this.view.requestUpdate(this))};l.prototype.processUpdate=function(a){this._set("updateParameters",a);this.updateRequested&&(this.update(a),this.updateRequested=!1)};l.prototype.addTile=function(a,b){this._collisionEngine.addTile(a,b)};l.prototype.removeTile=function(a,b){this._collisionEngine.removeTile(a,b)};l.prototype._applyVisivilityPass=function(a){var b=this._tileInfoView.getClosestInfoForScale(a.state.scale).level;this._collisionEngine.run(a,b)};a([g.property()],l.prototype,"updateRequested",
void 0);a([g.property({readOnly:!0})],l.prototype,"updateParameters",void 0);a([g.property({dependsOn:["updateRequested"]})],l.prototype,"updating",null);a([g.property()],l.prototype,"view",void 0);return l=a([g.subclass("esri.views.2d.layers.labels.LabelManager")],l)}(g.declared(l,d));m.default=n})},"esri/core/HandleOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Handles ./accessorSupport/decorators".split(" "),function(n,
m,h,a,l,d,k){return function(g){function f(){var a=g.call(this)||this;a.handles=new d;return a}h(f,g);f.prototype.destroy=function(){this.handles.destroy()};a([k.property({readOnly:!0})],f.prototype,"handles",void 0);return f=a([k.subclass("esri.core.HandleOwner")],f)}(k.declared(l))})},"esri/core/throttle":function(){define(["require","exports"],function(n,m){function h(a,l,d,k){var g=null,f=1E3;"number"===typeof l?(f=l,k=d):(g=l,f=d);var b=0,e,c=function(){b=0;a.apply(k,e)};l=function(){for(var a=
[],d=0;d<arguments.length;d++)a[d]=arguments[d];g&&g.apply(k,a);e=a;f?b||(b=setTimeout(c,f)):c()};l.remove=function(){b&&(clearTimeout(b),b=0)};l.forceUpdate=function(){b&&(clearTimeout(b),c())};l.hasPendingUpdates=function(){return!!b};return l}Object.defineProperty(m,"__esModule",{value:!0});m.throttle=h;m.default=h})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.EXTRUDE_SCALE=64;m.PICTURE_FILL_COLOR=
4294967295;m.TILE_SIZE=512;m.ANGLE_FACTOR_256=256/360;m.COLLISION_BUCKET_SIZE=128;m.COLLISION_MAX_ZOOM_DELTA=4;m.COLLISION_EARLY_REJECT_BUCKET_SIZE=32})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/tsSupport/assignHelper @dojo/framework/shim/Map ../../../../../core/Logger ../../../../../core/libs/gl-matrix/mat2d ../../../../../core/libs/gl-matrix/vec2 ../definitions ./CollisionBucket ../util/iterator ../../../tiling/TileKey ../../../../3d/support/mathUtils ../../../../vectorTiles/GeometryUtils".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t){Object.defineProperty(m,"__esModule",{value:!0});var p=l.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine"),v=g.TILE_SIZE/g.COLLISION_BUCKET_SIZE;n=function(){function l(b){this._layers=new a.default;this._collisionBuckets=new a.default;this._v3Buf1=k.create();this._v3Buf2=k.create();this._mat2dBuf=d.create();this._tileInfo=b}l.prototype.registerLayer=function(a,b){if(a&&!this._layers.has(a.uid)){var c=this._createInfo(b,a.labelingInfo);this._layers.set(a.uid,
c);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(c.index)})}};l.prototype.unregisterLayer=function(a){var b=this;if(a&&this._layers.has(a.uid)){var c=this._layers.get(a.uid);this._deleteInfo(c);this._layers.delete(a.uid);this._collisionBuckets.forEach(function(a,e){var f=a.getTile(c.index);f&&(f.dirty=!1,a.onUnregisterLayer(c.index),a.canDelete()&&b._collisionBuckets.delete(e))})}};l.prototype.addTile=function(a,b){var c=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(c)||
this._collisionBuckets.set(c,new f.default(this._layers.size)),this._collisionBuckets.get(c).getTile(this._getIndex(a)).reference=b)};l.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(this._collisionBuckets.get(b).getTile(this._getIndex(a)).reference=null)};l.prototype.run=function(a,c){var f=[],g=e.pool.acquire(0,0,0,0);b.forEachIter(this._collisionBuckets.keys(),function(a){g.set(a);g.level===c&&f.push(a)});e.pool.release(g);for(var f=e.sort(f),d=a.state.rotation,
k=this._checkRotation(d),l=0,p=f;l<p.length;l++){var h=p[l];this._computeNeighbors(h)}for(var p=0,t=f;p<t.length;p++)for(h=t[p],k=k||this._collisionBuckets.get(h).isDirty,l=0;l<this._layers.size;l++){var q=this._getCollisionInfo(l);this._resetCollisionBucket(q,h,a,k)}a=0;for(k=f;a<k.length;a++)for(h=k[a],l=0;l<this._layers.size;l++)p=this._getCollisionInfo(l).zoomRanges,this._runCollisionBucket(l,h,c,!!d,p);d=0;for(l=f;d<l.length;d++)h=l[d],this._cleanCollisionBucket(h)};l.prototype._computeNeighbors=
function(a){var b=this._collisionBuckets.get(a);a=e.from(a);b.neighbors=[this._getNeighboringBucket(a,-1,-1),this._getNeighboringBucket(a,0,-1),this._getNeighboringBucket(a,1,-1),this._getNeighboringBucket(a,-1,0),b,this._getNeighboringBucket(a,1,0),this._getNeighboringBucket(a,-1,1),this._getNeighboringBucket(a,0,1),this._getNeighboringBucket(a,1,1)]};l.prototype._getNeighboringBucket=function(a,b,c){a=e.getId(a.level,a.row+c,a.col+b,a.world);return this._collisionBuckets.has(a)?this._collisionBuckets.get(a):
null};l.prototype._checkRotation=function(a){if(!this._lastRotation)return this._lastRotation=a,!1;var b=a!==this._lastRotation;this._lastRotation=a;return b};l.prototype._collectCollisionInfos=function(){var a=[];b.forEachIter(this._layers.values(),function(b){return a.push(b)});return a};l.prototype._createInfo=function(a,b){for(var c=this,e=this._collectCollisionInfos().sort(function(a,b){return a.order-b.order}),f=!1,g=-1,d=0;d<e.length;d++){var k=e[d];!f&&k.order>a&&(g=k.index,f=!0);f&&k.index++}f||
(g=e.length);b=b.map(function(a){return c._convertLabelClass(a)});return{index:g,order:a,zoomRanges:b}};l.prototype._convertLabelClass=function(a){var b=!!a.maxScale,c=!!a.minScale&&this._tileInfo.scaleToZoom(a.minScale)||0;a=b&&this._tileInfo.scaleToZoom(a.maxScale)||255;return{minZoom:Math.floor(10*c),maxZoom:Math.floor(10*a)}};l.prototype._deleteInfo=function(a){var b=a.index;a=this._collectCollisionInfos().sort(function(a,b){return a.index-b.index});for(b+=1;b<a.length;b++)a[b].index--};l.prototype._resetCollisionBucket=
function(a,b,c,e){a=this._collisionBuckets.get(b).getTile(a.index);if(!a)return!1;a=a.reference;if(!a||!a.hasData)return!1;b=this._v3Buf1;var f=this._mat2dBuf;c=c.state;c.toScreen(b,a.coords);a.tileTransform.screenCoord[0]=b[0];a.tileTransform.screenCoord[1]=b[1];d.identity(f);d.rotate(f,f,c.rotation*t.C_DEG_TO_RAD);a.tileTransform.screenTransform.set(f);e&&(a.isDirty=!0);if(!a.isDirty)return!1;e=0;for(c=a.displayObjects;e<c.length;e++)for(a=0,b=c[e].metrics;a<b.length;a++)b[a].maxZoom=0;return!0};
l.prototype._runCollisionBucket=function(a,b,c,e,f){b=this._collisionBuckets.get(b);var g=b.getTile(a);if(g){var d=g.reference;if(d&&d.isDirty)for(var k=0;k<d.displayObjects.length;k++)for(var l=d.displayObjects[k],p=l.id,h=0;h<l.metrics.length;h++){var t=l.metrics[h],q=f[t.index],r=this._computeLabelVisibility(a,k,h,p,b,g,l,l.anchor,t,c,d,e,q);t.minZoom=r;t.maxZoom=q.maxZoom;d.setVisibilityRange(p,h,t.minZoom,t.maxZoom)}}};l.prototype._cleanCollisionBucket=function(a){this._collisionBuckets.get(a).clean()};
l.prototype._computeLabelVisibility=function(a,b,c,e,f,g,d,l,p,h,t,r,m){b=m.minZoom;c=t.tileTransform.screenTransform;c=r?k.transformMat2d(this._v3Buf1,l,c):l;g=p.bounds.center;var q=t.tileTransform.screenCoord;l=c[0]+g[0]+q[0];c=c[1]+g[1]+q[1];g=d.xBucket;var u=d.yBucket,q=d.xOverflow,n=d.yOverflow;d=g-q;g=g+q+1;q=u+n+1;for(u-=n;u<q;u++)for(n=d;n<g;n++)if(!(n<-v||u<-v||n>v||u>v))for(var A=0;A<=a;A++){var z=a===A,x=this._getRelativeSubBucket(A,f,t,n,u);if(x)for(var y=x.neighborTile,B=0,x=x.bucket;B<
x.length;B++){var w=x[B];z&&w.id===e||(b=Math.max(this._compareLabelToDisplayObject(e,p,l,c,w,h,y,r,m),b))}}return b};l.prototype._getRelativeSubBucket=function(a,b,e,f,g){var d=c.sign(Math.floor(f/4)),k=c.sign(Math.floor(g/4));return(a=this._getNeighboringTile(a,b,e,d,k))&&a.index?{bucket:a.index[g-4*k][f-4*d],neighborTile:a.reference}:null};l.prototype._getNeighboringTile=function(a,b,c,e,f){return(a=(b=b.neighbors[3*(1+f)+(1+e)])&&b.getTile(a))&&a.reference&&a.reference.hasData?a:null};l.prototype._compareLabelToDisplayObject=
function(a,b,c,e,f,d,l,p,h){a=h.minZoom;h=10*(d+g.COLLISION_MAX_ZOOM_DELTA);var t=l.tileTransform.screenTransform;p=p?k.transformMat2d(this._v3Buf2,f.anchor,t):f.anchor;t=0;for(f=f.metrics;t<f.length;t++){var q=f[t];if(q.maxZoom&&!(q.minZoom>h||a>=q.maxZoom)){var r=q.bounds.center,v=l.tileTransform.screenCoord,r=this._updateMinZoom(c,e,b.bounds,p[0]+r[0]+v[0],p[1]+r[1]+v[1],q.bounds),r=Math.min(Math.max(Math.ceil(10*(r+d)),0),255);if(!(q.minZoom>=r)){if(255<=r){a=255;break}a=Math.max(a,r)}}}return a};
l.prototype._updateMinZoom=function(a,b,e,f,g,d){return c.log2(Math.min((d.width+e.width)/2/Math.abs(f-a),(d.height+e.height)/2/Math.abs(g-b)))};l.prototype.onLabelsRendered=function(){this._collisionBuckets.forEach(function(a){a.onLabelsRendered()})};l.prototype._getIndex=function(a){return this._layers.get(a).index};l.prototype._getCollisionInfo=function(a){for(var b=0,c=this._collectCollisionInfos();b<c.length;b++){var e=c[b];if(e.index===a)return e}p.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");
return null};return l}();m.default=n})},"@dojo/framework/shim/Map":function(){(function(n){"object"===typeof module&&"object"===typeof module.exports?(n=n(require,exports),void 0!==n&&(module.exports=n)):"function"===typeof define&&define.amd&&define("require exports tslib ./iterator ./global ./object ./support/has ./Symbol".split(" "),n)})(function(n,m){Object.defineProperty(m,"__esModule",{value:!0});var h=n("tslib"),a=n("./iterator"),l=n("./global"),d=n("./object"),k=n("./support/has");n("./Symbol");
m.Map=l.default.Map;k.default("es6-map")||(m.Map=(g=function(){function f(b){this._keys=[];this._values=[];this[Symbol.toStringTag]="Map";if(b)if(a.isArrayLike(b))for(var e=0;e<b.length;e++){var c=b[e];this.set(c[0],c[1])}else try{for(var e=h.__values(b),f=e.next();!f.done;f=e.next())c=f.value,this.set(c[0],c[1])}catch(r){g={error:r}}finally{try{f&&!f.done&&(d=e.return)&&d.call(e)}finally{if(g)throw g.error;}}var g,d}f.prototype._indexOfKey=function(a,e){for(var b=0,f=a.length;b<f;b++)if(d.is(a[b],
e))return b;return-1};Object.defineProperty(f.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0});f.prototype.clear=function(){this._keys.length=this._values.length=0};f.prototype.delete=function(a){a=this._indexOfKey(this._keys,a);if(0>a)return!1;this._keys.splice(a,1);this._values.splice(a,1);return!0};f.prototype.entries=function(){var b=this,e=this._keys.map(function(a,e){return[a,b._values[e]]});return new a.ShimIterator(e)};f.prototype.forEach=function(a,
e){for(var b=this._keys,f=this._values,g=0,d=b.length;g<d;g++)a.call(e,f[g],b[g],this)};f.prototype.get=function(a){a=this._indexOfKey(this._keys,a);return 0>a?void 0:this._values[a]};f.prototype.has=function(a){return-1<this._indexOfKey(this._keys,a)};f.prototype.keys=function(){return new a.ShimIterator(this._keys)};f.prototype.set=function(a,e){var b=this._indexOfKey(this._keys,a),b=0>b?this._keys.length:b;this._keys[b]=a;this._values[b]=e;return this};f.prototype.values=function(){return new a.ShimIterator(this._values)};
f.prototype[Symbol.iterator]=function(){return this.entries()};return f}(),g[Symbol.species]=g,g));m.default=m.Map;var g})},"@dojo/framework/shim/object":function(){(function(n){"object"===typeof module&&"object"===typeof module.exports?(n=n(require,exports),void 0!==n&&(module.exports=n)):"function"===typeof define&&define.amd&&define(["require","exports","./global","./support/has","./Symbol"],n)})(function(n,m){Object.defineProperty(m,"__esModule",{value:!0});var h=n("./global"),a=n("./support/has"),
l=n("./Symbol");a.default("es6-object")?(n=h.default.Object,m.assign=n.assign,m.getOwnPropertyDescriptor=n.getOwnPropertyDescriptor,m.getOwnPropertyNames=n.getOwnPropertyNames,m.getOwnPropertySymbols=n.getOwnPropertySymbols,m.is=n.is,m.keys=n.keys):(m.keys=function(a){return Object.keys(a).filter(function(a){return!a.match(/^@@.+/)})},m.assign=function(a){for(var d=[],g=1;g<arguments.length;g++)d[g-1]=arguments[g];if(null==a)throw new TypeError("Cannot convert undefined or null to object");var f=
Object(a);d.forEach(function(a){a&&m.keys(a).forEach(function(b){f[b]=a[b]})});return f},m.getOwnPropertyDescriptor=function(a,k){l.isSymbol(k);return Object.getOwnPropertyDescriptor(a,k)},m.getOwnPropertyNames=function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!a.match(/^@@.+/)})},m.getOwnPropertySymbols=function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!!a.match(/^@@.+/)}).map(function(a){return Symbol.for(a.substring(2))})},m.is=function(a,k){return a===
k?0!==a||1/a===1/k:a!==a&&k!==k});a.default("es2017-object")?(n=h.default.Object,m.getOwnPropertyDescriptors=n.getOwnPropertyDescriptors,m.entries=n.entries,m.values=n.values):(m.getOwnPropertyDescriptors=function(a){return m.getOwnPropertyNames(a).reduce(function(d,g){d[g]=m.getOwnPropertyDescriptor(a,g);return d},{})},m.entries=function(a){return m.keys(a).map(function(d){return[d,a[d]]})},m.values=function(a){return m.keys(a).map(function(d){return a[d]})})})},"esri/core/libs/gl-matrix/mat2d":function(){define(["./common"],
function(n){var m={create:function(){var h=new n.ARRAY_TYPE(6);h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},clone:function(h){var a=new n.ARRAY_TYPE(6);a[0]=h[0];a[1]=h[1];a[2]=h[2];a[3]=h[3];a[4]=h[4];a[5]=h[5];return a},copy:function(h,a){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];h[4]=a[4];h[5]=a[5];return h},identity:function(h){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},fromValues:function(h,a,l,d,k,g){var f=new n.ARRAY_TYPE(6);f[0]=h;f[1]=a;f[2]=l;f[3]=d;f[4]=k;f[5]=g;return f},
set:function(h,a,l,d,k,g,f){h[0]=a;h[1]=l;h[2]=d;h[3]=k;h[4]=g;h[5]=f;return h},invert:function(h,a){var l=a[0],d=a[1],k=a[2],g=a[3],f=a[4];a=a[5];var b=l*g-d*k;if(!b)return null;b=1/b;h[0]=g*b;h[1]=-d*b;h[2]=-k*b;h[3]=l*b;h[4]=(k*a-g*f)*b;h[5]=(d*f-l*a)*b;return h},determinant:function(h){return h[0]*h[3]-h[1]*h[2]},multiply:function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=l[0],c=l[1],t=l[2],p=l[3],v=l[4];l=l[5];h[0]=d*e+g*c;h[1]=k*e+f*c;h[2]=d*t+g*p;h[3]=k*t+f*p;h[4]=d*v+g*l+
b;h[5]=k*v+f*l+a;return h}};m.mul=m.multiply;m.rotate=function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=Math.sin(l);l=Math.cos(l);h[0]=d*l+g*e;h[1]=k*l+f*e;h[2]=d*-e+g*l;h[3]=k*-e+f*l;h[4]=b;h[5]=a;return h};m.scale=function(h,a,l){var d=a[1],k=a[2],g=a[3],f=a[4],b=a[5],e=l[0];l=l[1];h[0]=a[0]*e;h[1]=d*e;h[2]=k*l;h[3]=g*l;h[4]=f;h[5]=b;return h};m.translate=function(h,a,l){var d=a[0],k=a[1],g=a[2],f=a[3],b=a[4];a=a[5];var e=l[0];l=l[1];h[0]=d;h[1]=k;h[2]=g;h[3]=f;h[4]=d*e+g*l+b;
h[5]=k*e+f*l+a;return h};m.fromRotation=function(h,a){var l=Math.sin(a);a=Math.cos(a);h[0]=a;h[1]=l;h[2]=-l;h[3]=a;h[4]=0;h[5]=0;return h};m.fromScaling=function(h,a){h[0]=a[0];h[1]=0;h[2]=0;h[3]=a[1];h[4]=0;h[5]=0;return h};m.fromTranslation=function(h,a){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=a[0];h[5]=a[1];return h};m.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"};m.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],
2)+Math.pow(h[4],2)+Math.pow(h[5],2)+1)};m.add=function(h,a,l){h[0]=a[0]+l[0];h[1]=a[1]+l[1];h[2]=a[2]+l[2];h[3]=a[3]+l[3];h[4]=a[4]+l[4];h[5]=a[5]+l[5];return h};m.subtract=function(h,a,l){h[0]=a[0]-l[0];h[1]=a[1]-l[1];h[2]=a[2]-l[2];h[3]=a[3]-l[3];h[4]=a[4]-l[4];h[5]=a[5]-l[5];return h};m.sub=m.subtract;m.multiplyScalar=function(h,a,l){h[0]=a[0]*l;h[1]=a[1]*l;h[2]=a[2]*l;h[3]=a[3]*l;h[4]=a[4]*l;h[5]=a[5]*l;return h};m.multiplyScalarAndAdd=function(h,a,l,d){h[0]=a[0]+l[0]*d;h[1]=a[1]+l[1]*d;h[2]=
a[2]+l[2]*d;h[3]=a[3]+l[3]*d;h[4]=a[4]+l[4]*d;h[5]=a[5]+l[5]*d;return h};m.exactEquals=function(h,a){return h[0]===a[0]&&h[1]===a[1]&&h[2]===a[2]&&h[3]===a[3]&&h[4]===a[4]&&h[5]===a[5]};m.equals=function(h,a){var l=h[0],d=h[1],k=h[2],g=h[3],f=h[4];h=h[5];var b=a[0],e=a[1],c=a[2],t=a[3],p=a[4];a=a[5];return Math.abs(l-b)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(d-e)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(e))&&Math.abs(k-c)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(c))&&Math.abs(g-
t)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(t))&&Math.abs(f-p)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(p))&&Math.abs(h-a)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(a))};return m})},"esri/core/libs/gl-matrix/common":function(){define([],function(){var n={EPSILON:1E-6};n.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;n.RANDOM=Math.random;n.ENABLE_SIMD=!1;n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this;n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE;n.setMatrixArrayType=
function(h){n.ARRAY_TYPE=h};var m=Math.PI/180;n.toRadian=function(h){return h*m};n.equals=function(h,a){return Math.abs(h-a)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(a))};return n})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(n){var m={create:function(){var h=new n.ARRAY_TYPE(2);h[0]=0;h[1]=0;return h},clone:function(h){var a=new n.ARRAY_TYPE(2);a[0]=h[0];a[1]=h[1];return a},fromValues:function(h,a){var l=new n.ARRAY_TYPE(2);l[0]=h;l[1]=a;return l},copy:function(h,a){h[0]=
a[0];h[1]=a[1];return h},set:function(h,a,l){h[0]=a;h[1]=l;return h},add:function(h,a,l){h[0]=a[0]+l[0];h[1]=a[1]+l[1];return h},subtract:function(h,a,l){h[0]=a[0]-l[0];h[1]=a[1]-l[1];return h}};m.sub=m.subtract;m.multiply=function(h,a,l){h[0]=a[0]*l[0];h[1]=a[1]*l[1];return h};m.mul=m.multiply;m.divide=function(h,a,l){h[0]=a[0]/l[0];h[1]=a[1]/l[1];return h};m.div=m.divide;m.ceil=function(h,a){h[0]=Math.ceil(a[0]);h[1]=Math.ceil(a[1]);return h};m.floor=function(h,a){h[0]=Math.floor(a[0]);h[1]=Math.floor(a[1]);
return h};m.min=function(h,a,l){h[0]=Math.min(a[0],l[0]);h[1]=Math.min(a[1],l[1]);return h};m.max=function(h,a,l){h[0]=Math.max(a[0],l[0]);h[1]=Math.max(a[1],l[1]);return h};m.round=function(h,a){h[0]=Math.round(a[0]);h[1]=Math.round(a[1]);return h};m.scale=function(h,a,l){h[0]=a[0]*l;h[1]=a[1]*l;return h};m.scaleAndAdd=function(h,a,l,d){h[0]=a[0]+l[0]*d;h[1]=a[1]+l[1]*d;return h};m.distance=function(h,a){var l=a[0]-h[0];h=a[1]-h[1];return Math.sqrt(l*l+h*h)};m.dist=m.distance;m.squaredDistance=function(h,
a){var l=a[0]-h[0];h=a[1]-h[1];return l*l+h*h};m.sqrDist=m.squaredDistance;m.length=function(h){var a=h[0];h=h[1];return Math.sqrt(a*a+h*h)};m.len=m.length;m.squaredLength=function(h){var a=h[0];h=h[1];return a*a+h*h};m.sqrLen=m.squaredLength;m.negate=function(h,a){h[0]=-a[0];h[1]=-a[1];return h};m.inverse=function(h,a){h[0]=1/a[0];h[1]=1/a[1];return h};m.normalize=function(h,a){var l=a[0],d=a[1],l=l*l+d*d;0<l&&(l=1/Math.sqrt(l),h[0]=a[0]*l,h[1]=a[1]*l);return h};m.dot=function(h,a){return h[0]*a[0]+
h[1]*a[1]};m.cross=function(h,a,l){a=a[0]*l[1]-a[1]*l[0];h[0]=h[1]=0;h[2]=a;return h};m.lerp=function(h,a,l,d){var k=a[0];a=a[1];h[0]=k+d*(l[0]-k);h[1]=a+d*(l[1]-a);return h};m.random=function(h,a){a=a||1;var l=2*n.RANDOM()*Math.PI;h[0]=Math.cos(l)*a;h[1]=Math.sin(l)*a;return h};m.transformMat2=function(h,a,l){var d=a[0];a=a[1];h[0]=l[0]*d+l[2]*a;h[1]=l[1]*d+l[3]*a;return h};m.transformMat2d=function(h,a,l){var d=a[0];a=a[1];h[0]=l[0]*d+l[2]*a+l[4];h[1]=l[1]*d+l[3]*a+l[5];return h};m.transformMat3=
function(h,a,l){var d=a[0];a=a[1];h[0]=l[0]*d+l[3]*a+l[6];h[1]=l[1]*d+l[4]*a+l[7];return h};m.transformMat4=function(h,a,l){var d=a[0];a=a[1];h[0]=l[0]*d+l[4]*a+l[12];h[1]=l[1]*d+l[5]*a+l[13];return h};m.forEach=function(){var h=m.create();return function(a,l,d,k,g,f){l||(l=2);d||(d=0);for(k=k?Math.min(k*l+d,a.length):a.length;d<k;d+=l)h[0]=a[d],h[1]=a[d+1],g(h,h,f),a[d]=h[0],a[d+1]=h[1];return a}}();m.str=function(h){return"vec2("+h[0]+", "+h[1]+")"};m.exactEquals=function(h,a){return h[0]===a[0]&&
h[1]===a[1]};m.equals=function(h,a){var l=h[0];h=h[1];var d=a[0];a=a[1];return Math.abs(l-d)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))&&Math.abs(h-a)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(a))};return m})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","./CollisionBucketEntry"],function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function a(a){this.neighbors=null;this._tiles=Array(a);for(var d=0;d<a;d++)this._tiles[d]=
new h.default}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,d=this._tiles;a<d.length;a++)if(d[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};
a.prototype.onLabelsRendered=function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.clean=function(){for(var a=0,d=this._tiles;a<d.length;a++)d[a].dirty=!1};a.prototype._add=function(a){var d=[];if(a>=this._tiles.length)this._tiles.push(new h.default);else{for(var k=0;k<this._tiles.length;k++)k===
a&&d.push(new h.default),d.push(this._tiles[k]);this._tiles=d}};a.prototype._remove=function(a){for(var d=[],k=0;k<this._tiles.length;k++)k!==a&&d.push(this._tiles[k]);this._tiles=d};return a}();m.default=n})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function h(){this._reference=null}Object.defineProperty(h.prototype,"dirty",{get:function(){return this.reference&&
this.reference.isDirty},set:function(a){this.reference&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"index",{get:function(){return this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!0,configurable:!0});return h}();m.default=n})},"esri/views/2d/engine/webgl/util/iterator":function(){define(["require","exports"],
function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.forEachIter=function(h,a){for(;;){var l=h.next();if(l.done)break;a(l.value)}}})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(n,m,h){return function(){function a(a,d,k,g){this.set(a,d,k,g)}a.from=function(l,d,k,g){return a.pool.acquire(l,d,k,g)};a.getId=function(a,d,k,g){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+d+"/"+k+"/"+g};Object.defineProperty(a.prototype,
"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});a.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};a.prototype.release=function(){this.world=this.col=this.row=this.level=0};a.prototype.set=function(a,d,k,g){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?(this.level=a.level||0,this.row=
a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),d=a[1],k=a[2],g=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(d),this.col=parseFloat(k),this.world=parseFloat(g)):(this.level=+a,this.row=+d,this.col=+k,this.world=+g||0);return this};a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};a.prototype.getChildKeys=function(){var l=this.level+1,d=this.row<<1,k=this.col<<1,g=this.world;return[a.pool.acquire(l,d,k,g),a.pool.acquire(l,
d,k+1,g),a.pool.acquire(l,d+1,k,g),a.pool.acquire(l,d+1,k+1,g)]};a.prototype._compare=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};a.sort=function(l){return l.map(function(d){return a.from(d)}).sort(function(a,k){return a._compare(k)}).map(function(a){return a.id})};a.pool=new h(a,!0,null,25,50);return a}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(n,m){function h(a,d){a%=d;return 0<=a?a:a+d}Object.defineProperty(m,
"__esModule",{value:!0});m.C_INFINITY=Number.POSITIVE_INFINITY;m.C_PI=Math.PI;m.C_2PI=2*m.C_PI;m.C_PI_BY_2=m.C_PI/2;m.C_RAD_TO_256=128/m.C_PI;m.C_256_TO_RAD=m.C_PI/128;m.C_DEG_TO_256=256/360;m.C_DEG_TO_RAD=m.C_PI/180;m.C_SQRT2=1.414213562;m.C_SQRT2_INV=1/m.C_SQRT2;var a=1/Math.LN2;m.positiveMod=h;m.radToByte=function(a){return h(a*m.C_RAD_TO_256,256)};m.degToByte=function(a){return h(a*m.C_DEG_TO_256,256)};m.log2=function(l){return Math.log(l)*a};m.sqr=function(a){return a*a};m.clamp=function(a,d,
k){return Math.min(Math.max(a,d),k)};m.interpolate=function(a,d,k){return a*(1-k)+d*k};m.between=function(a,d,k){return a>=d&&a<=k||a>=k&&a<=d}})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","@dojo/framework/shim/Map"],function(n,m,h){function a(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}Object.defineProperty(m,"__esModule",{value:!0});n=function(){function l(a,
k,g){void 0===g&&(g=null);this.registerLayer=a;this.unregisterLayer=k;this.onLabelsVisible=g;this._layerViewState=new h.default;this._priorityCounter=4294967295}l.prototype.update=function(d){for(var k=d.removed,g=0,f=d.added;g<f.length;g++){d=f[g];var b;if(b=a(d))a:switch(d.get("layer.renderer.type")){case "class-breaks":case "simple":case "unique-value":b=!0;break a;default:b=!1}b&&!this._layerViewState.has(d)&&this._createState(d)}for(g=0;g<k.length;g++)d=k[g],a(d)&&this._layerViewState.has(d)&&
this._deleteState(d);this._recomputeOrder()};l.prototype.destroy=function(){var a=this;this._layerViewState.forEach(function(d,g){return a._deleteState(g)})};l.prototype._createState=function(a){var d=this,g={enabled:a.labelsVisible,priority:this._priorityCounter--,order:null,handle:null};g.handle=a.watch("labelsVisible",function(a){g.enabled=a;d._recomputeOrder();d.onLabelsVisible&&d._layerViewState.forEach(function(a,e){return d.onLabelsVisible(e)})});this._layerViewState.set(a,g);return g};l.prototype._deleteState=
function(a){var d=this._layerViewState.get(a);d.handle.remove();d.enabled&&this.unregisterLayer(a);this._layerViewState.delete(a)};l.prototype._recomputeOrder=function(){var a=[];this._layerViewState.forEach(function(b,e){a.push({layerView:e,state:b})});a.sort(function(a,e){return a.state.priority-e.state.priority});for(var k=0,g=0;g<a.length;g++){var f=a[g];f.state.order!==k&&(f.state.order=k,this.unregisterLayer(f.layerView));f.state.enabled?this.registerLayer(f.layerView,k):this.unregisterLayer(f.layerView);
++k}};return l}();m.default=n})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(n,m,h,a,l,d,k){var g=new d("0/0/0/0"),f=function(){function a(a,b,e,f,g,d,k,l){this.x=a;this.ymin=b;this.ymax=e;this.invM=f;this.leftAdjust=g;this.rightAdjust=d;this.leftBound=k;this.rightBound=l}a.create=function(b,e){var c;b[1]>e[1]&&(c=[e,b],b=c[0],e=c[1]);c=b[0];b=b[1];var f=e[0];
e=e[1];var g=f-c,d=e-b,d=0!==d?g/d:0,k=(Math.ceil(b)-b)*d,l=(Math.floor(b)-b)*d;return new a(c,Math.floor(b),Math.ceil(e),d,0>g?k:l,0>g?l:k,0>g?f:c,0>g?c:f)};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),b=[[0,0],[0,0],[0,0],[0,0]];return function(){function e(b,e){var c=this;this.tileInfo=b;this.fullExtent=
e;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var f=b.lods.slice();f.sort(function(a,b){return b.scale-a.scale});var g=this._lodInfos=f.map(function(c){return a.create(b,c,e)});f.forEach(function(a,b){c._infoByLevel[a.level]=g[b];c._infoByScale[a.scale]=g[b];c.scales[b]=a.scale},this);this._wrap=b.isWrappable}e.prototype.getLODInfoAt=function(a){return this._infoByLevel[a.level]};e.prototype.getTileBounds=function(a,b,e){void 0===e&&(e=!1);g.set(b);return(b=this._infoByLevel[g.level])?
b.getTileBounds(a,g,e):a};e.prototype.getTileCoords=function(a,b,e){void 0===e&&(e=!1);g.set(b);return(b=this._infoByLevel[g.level])?b.getTileCoords(a,g,e):a};e.prototype.getTileCoverage=function(a,e){void 0===e&&(e=192);var c=this.getClosestInfoForScale(a.scale),g=l.pool.acquire(c),d=this._wrap,h;h=Infinity;var t=-Infinity,m,n,x=g.spans;b[0][0]=b[0][1]=b[1][1]=b[3][0]=-e;b[1][0]=b[2][0]=a.size[0]+e;b[2][1]=b[3][1]=a.size[1]+e;for(e=0;e<b.length;e++){var y=b[e];a.toMap(y,y);y[0]=c.getColumnForX(y[0]);
y[1]=c.getRowForY(y[1])}a=[];y=3;for(e=0;4>e;e++){if(b[e][1]!==b[y][1]){var B=f.create(b[e],b[y]);h=Math.min(B.ymin,h);t=Math.max(B.ymax,t);void 0===a[B.ymin]&&(a[B.ymin]=[]);a[B.ymin].push(B)}y=e}if(null==h||null==t||100<t-h)return null;for(y=[];h<t;){null!=a[h]&&(y=y.concat(a[h]));m=Infinity;n=-Infinity;for(e=y.length-1;0<=e;e--)B=y[e],m=Math.min(m,B.getLeftCol()),n=Math.max(n,B.getRightCol());m=Math.floor(m);n=Math.floor(n);if(h>=c.first[1]&&h<=c.last[1])if(d)if(c.size[0]<c.worldSize[0])for(B=
Math.floor(n/c.worldSize[0]),e=Math.floor(m/c.worldSize[0]);e<=B;e++)x.push(new k(h,Math.max(c.getFirstColumnForWorld(e),m),Math.min(c.getLastColumnForWorld(e),n)));else x.push(new k(h,m,n));else m>c.last[0]||n<c.first[0]||(m=Math.max(m,c.first[0]),n=Math.min(n,c.last[0]),x.push(new k(h,m,n)));h+=1;for(e=y.length-1;0<=e;e--)B=y[e],B.ymax>=h?B.incrRow():y.splice(e,1)}return g};e.prototype.getTileIdAtParent=function(a,b){b=d.pool.acquire(b);var c=this._infoByLevel[b.level];if(a.resolution<c.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+
a.resolution+" is not a parent resolution of "+c.resolution);return a.resolution===c.resolution?b.id:d.getId(a.level,Math.floor(b.row*c.resolution/a.resolution+.01),Math.floor(b.col*c.resolution/a.resolution+.01),b.world)};e.prototype.getTileParentId=function(a){a=d.pool.acquire(a);var b=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;if(0>b)return d.pool.release(a),null;b=this.getTileIdAtParent(this._lodInfos[b],a);d.pool.release(a);return b};e.prototype.getTileResolution=function(a){return(a=
this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};e.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};e.prototype.intersects=function(a,b){var c=d.pool.acquire(b);b=this._infoByLevel[c.level];var e=a.lodInfo;if(e.resolution>b.resolution){var f=d.pool.acquire(this.getTileIdAtParent(e,c)),g=e.denormalizeCol(f.col,f.world);b=a.spans.some(function(a){return a.row===f.row&&a.colFrom<=g&&a.colTo>=g});d.pool.release(c);d.pool.release(f);return b}if(e.resolution<
b.resolution){var k=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=k[0];var l=k[1],h=k[2],k=k[3],t=b.denormalizeCol(c.col,c.world),m=e.getColumnForX(b.getXForColumn(t)),n=e.getRowForY(b.getYForRow(c.row)),t=e.getColumnForX(b.getXForColumn(t+1))-1;b=e.getRowForY(b.getYForRow(c.row+1))-1;d.pool.release(c);return!(m>k||t<h||n>l||b<a)}var w=e.denormalizeCol(c.col,
c.world);b=a.spans.some(function(a){return a.row===c.row&&a.colFrom<=w&&a.colTo>=w});d.pool.release(c);return b};e.prototype.normalizeBounds=function(a,b,e){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];this._wrap&&(b=h.getInfo(this.tileInfo.spatialReference),e=-e*(b.valid[1]-b.valid[0]),a[0]+=e,a[2]+=e);return a};e.prototype.getClosestInfoForScale=function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,e,f){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]));return this._infoByScale[a]};
e.prototype.scaleToLevel=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var c=b.length-1;0<=c;c--)if(a<b[c])return c===b.length-1?this._infoByScale[b[b.length-1]].level:this._infoByScale[b[c]].level+(b[c]-a)/(b[c]-b[c+1]);return this._infoByScale[b[0]].level};return e}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(n,m,h,a){function l(a,g,f){a[0]=g;a[1]=
f;return a}var d=new a("0/0/0/0");return function(){function a(a,f,b,e,c,d,k,l,h,q,m,n){this.level=a;this.resolution=f;this.scale=b;this.origin=e;this.first=c;this.last=d;this.size=k;this.norm=l;this.worldStart=h;this.worldEnd=q;this.worldSize=m;this.wrap=n}a.create=function(g,f,b){var e=h.getInfo(g.spatialReference),c=[g.origin.x,g.origin.y],d=[g.size[0]*f.resolution,g.size[1]*f.resolution],k=[-Infinity,-Infinity],m=[Infinity,Infinity],r=[Infinity,Infinity];b&&(l(k,Math.max(0,Math.floor((b.xmin-
c[0])/d[0])),Math.max(0,Math.floor((c[1]-b.ymax)/d[1]))),l(m,Math.max(0,Math.floor((b.xmax-c[0])/d[0])),Math.max(0,Math.floor((c[1]-b.ymin)/d[1]))),l(r,m[0]-k[0]+1,m[1]-k[1]+1));var q;g.isWrappable?(g=[Math.ceil(Math.round(2*e.origin[1]/f.resolution)/g.size[0]),r[1]],e=[Math.floor((e.origin[0]-c[0])/d[0]),k[1]],b=[g[0]+e[0]-1,m[1]],q=!0):(e=k,b=m,g=r,q=!1);return new a(f.level,f.resolution,f.scale,c,k,m,r,d,e,b,g,q)};a.prototype.normalizeCol=function(a){if(!this.wrap)return a;var f=this.worldSize[0];
return 0>a?f-1-Math.abs((a+1)%f):a%f};a.prototype.denormalizeCol=function(a,f){return this.wrap?this.worldSize[0]*f+a:a};a.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};a.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};a.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};a.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};a.prototype.getXForColumn=
function(a){return this.origin[0]+a*this.norm[0]};a.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};a.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};a.prototype.getTileBounds=function(a,f,b){void 0===b&&(b=!1);d.set(f);var e=b?d.col:this.denormalizeCol(d.col,d.world),c=d.row;f=this.getXForColumn(e);b=this.getYForRow(c+1);e=this.getXForColumn(e+1);c=this.getYForRow(c);a[0]=f;a[1]=b;a[2]=e;a[3]=c;return a};a.prototype.getTileCoords=function(a,f,b){void 0===
b&&(b=!1);d.set(f);f=b?d.col:this.denormalizeCol(d.col,d.world);Array.isArray(a)?l(a,this.getXForColumn(f),this.getYForRow(d.row)):(a.x=this.getXForColumn(f),a.y=this.getYForRow(d.row));return a};return a}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ArrayPool","../../../core/ObjectPool","./TileSpan"],function(n,m,h,a,l){return function(){function d(a){this.lodInfo=a;this.spans=h.acquire()}d.prototype.release=function(){for(var a=0,g=this.spans;a<
g.length;a++)l.pool.release(g[a]);h.release(this.spans)};d.prototype.forEach=function(a,g){var f=this.spans,b=this.lodInfo,e=b.level;if(0!==f.length)for(var c=0;c<f.length;c++)for(var d=f[c],k=d.row,l=d.colTo,d=d.colFrom;d<=l;d++)a.call(g,e,k,b.normalizeCol(d),b.getWorldForColumn(d))};d.pool=new a(d,!0);return d}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(n,m,h){return function(){function a(a,d,k){this.row=a;this.colFrom=d;this.colTo=
k}a.pool=new h(a,!0);return a}()})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/Error ../../../core/promiseUtils ../../../core/scheduling ./DOMContainer ../../support/screenshotUtils".split(" "),function(n,m,h,a,l,d,k,g){function f(a,e){for(var b=0;b<e.length;b++){var g=e[b];"takeScreenshot"in g?a.push(g):"children"in g&&f(a,g.children)}return a}return function(b){function e(a){var c=b.call(this)||this;c.element=a;c._renderParameters=
{state:c.state,pixelRatio:window.devicePixelRatio,stationary:!1};c._renderRequested=!1;c._taskHandle=d.addFrameTask({render:function(){return c.renderFrame()}});c._stationary=!0;c.attached=!0;c._taskHandle.pause();return c}h(e,b);e.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._taskHandle=null};Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=a,this.requestRender())},enumerable:!0,configurable:!0});e.prototype.start=function(){this._taskHandle.resume()};e.prototype.stop=function(){this._taskHandle.pause()};e.prototype.requestRender=function(){this._renderRequested=!0;this._taskHandle&&this._taskHandle.resume()};e.prototype.takeScreenshot=function(b){var c=f([],this.children);if(!c)return l.reject(new a("mapview:take-screenshot-unavailable"));
var e=b.region,d=e.width,k=e.height;return l.eachAlways(c.map(function(a){return a.takeScreenshot(b)})).then(function(a){var c=document.createElement("canvas"),e=c.getContext("2d"),f=document.createElement("canvas"),l=f.getContext("2d");c.width=d;c.height=k;f.width=d;f.height=k;a.forEach(function(a){if(a=a.value)l.putImageData(a.data,0,0),e.drawImage(f,0,0)});return{dataUrl:g.toDataUrl(c,b),data:e.getImageData(0,0,d,k)}})};e.prototype.renderFrame=function(){this._renderRequested&&(this._renderRequested=
!1,this._renderParameters.state=this._state,this._renderParameters.stationary=this.stationary,this._renderParameters.pixelRatio=window.devicePixelRatio,this.processRender(this._renderParameters));this._renderRequested||this._taskHandle.pause()};return e}(k)})},"esri/views/2d/engine/DOMContainer":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Container"],function(n,m,h,a){return function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);d.prototype.createElement=
function(){var a=document.createElement("div");a.setAttribute("class","esri-display-object");return a};d.prototype.setElement=function(a){this.element=a};d.prototype.doRender=function(d){var g=this.element.style;this.visible?(g.display="block",a.prototype.doRender.call(this,d)):g.display="none"};d.prototype.prepareChildrenRenderParameters=function(a){return a};d.prototype.attachChild=function(a,g){var f=a.element;f||(f=a.createElement(),a.setElement(f));return a.attach(g)};d.prototype.detachChild=
function(a,g){a.detach(g);this.element.contains(a.element)&&this.element.removeChild(a.element);a.setElement(null)};d.prototype.renderChildren=function(d){for(var g=this.children,f=this.element.childNodes,b=0,e=g.length,c=0;c<e;c++)if(g[c].attached){var k=g[c].element;f[b]!==k&&(null!=f[b+1]?this.element.insertBefore(k,f[b]):this.element.appendChild(k));b+=1}a.prototype.renderChildren.call(this,d)};return d}(a)})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"./DisplayObject"],function(n,m,h,a){var l;(function(a){a[a.BEFORE=0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"})(l||(l={}));return function(a){function d(){var g=null!==a&&a.apply(this,arguments)||this;g._childrenSet=new Set;g._childrenToAttach=[];g._childrenToDetach=[];g._renderPhase=l.DONE;g.children=[];return g}h(d,a);Object.defineProperty(d.prototype,"numChildren",{get:function(){return this.children.length},
enumerable:!0,configurable:!0});d.prototype.detach=function(a){var f=this.children.concat(this._childrenToDetach);a=this.prepareChildrenRenderParameters(a);for(var b=0;b<f.length;b++){var e=f[b];e.attached&&(this.detachChild(e,a),e.attached=!1,e.parent=null)}};d.prototype.doRender=function(a){var f=this.prepareChildrenRenderParameters(a);this._renderPhase=l.BEFORE;this.beforeRenderChildren(a,f);this._renderPhase=l.ATTACHING;this.attachChildren(f);this._renderPhase=l.DETACHING;for(var b=this._childrenToDetach;0<
b.length;){var e=b.shift();this.detachChild(e,f);e.attached=!1;e.parent=null}this._renderPhase=l.RENDERING;this.renderChildren(f);this._renderPhase=l.AFTER;this.afterRenderChildren(a,f);this._renderPhase=l.DONE};d.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};d.prototype.addChildAt=function(a,f){void 0===f&&(f=this.numChildren);if(!a||this.contains(a))return a;var b=a.parent;b&&b!==this&&b.removeChild(a);f>=this.numChildren?this.children.push(a):this.children.splice(f,
0,a);this._childrenSet.add(a);f=this._childrenToDetach.indexOf(a);-1<f&&this._childrenToDetach.splice(f,1);this._childrenToAttach.push(a);this._renderPhase>=l.RENDERING&&this.requestRender();return a};d.prototype.contains=function(a){return this._childrenSet.has(a)};d.prototype.getChildIndex=function(a){return this.children.indexOf(a)};d.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};d.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};
d.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};d.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=l.RENDERING&&this.requestRender();else{var f=this._childrenToAttach.indexOf(a);-1<f&&this._childrenToAttach.splice(f,1)}return a};d.prototype.requestChildRender=function(a){a&&a.parent===this&&
this._renderPhase>=l.RENDERING&&this.requestRender()};d.prototype.setChildIndex=function(a,f){var b=this.getChildIndex(a);-1<b&&(this.children.splice(b,1),this.children.splice(f,0,a),this._renderPhase>=l.RENDERING&&this.requestRender())};d.prototype.sortChildren=function(a){this._renderPhase>l.RENDERING&&this.requestRender();return this.children.sort(a)};d.prototype.attachChildren=function(a){var f=this._childrenToAttach;if(0!==f.length)for(var b=0,e=!1;!e;)e=f[b],this.attachChild(e,a)?(e.attached=
!0,e.parent=this,f.splice(b,1)):++b,e=f.length===b};d.prototype.renderChildren=function(a){for(var f=this.children,b=f.length,e=0;e<b;e++){var c=f[e];c.attached&&this.renderChild(c,a)}};d.prototype.beforeRenderChildren=function(a,f){};d.prototype.attachChild=function(a,f){return a.attach(f)};d.prototype.detachChild=function(a,f){a.detach(f)};d.prototype.renderChild=function(a,f){a.processRender(f)};d.prototype.afterRenderChildren=function(a,f){};return d}(a)})},"esri/views/2d/engine/DisplayObject":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./Evented"],function(n,m,h,a){return function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._renderRequestedCalled=!1;d._attached=!1;d._opacity=1;d.renderRequested=!1;d._visible=!0;return d}h(d,a);Object.defineProperty(d.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});d.prototype.attach=function(a){return!0};d.prototype.detach=function(a){};d.prototype.processRender=
function(a){this._renderRequestedCalled=!1;this.doRender(a);this._renderRequestedCalled||(this.renderRequested=!1);this.hasEventListener("post-render")&&this.emit("post-render")};d.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestChildRender(this);a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};d.prototype.dispose=function(){};return d}(a.Evented)})},"esri/views/2d/engine/Evented":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","dojo/aspect","dojo/on"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function d(){}d.prototype.on=function(d,g){return a.after(this,"on"+d,g,!0)};d.prototype.once=function(a,d){return l.once(this,a,d)};d.prototype.emit=function(a){l.emit(this,a,this)};d.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return d}();m.Evented=n;m.EventedMixin=function(d){return function(d){function g(){return null!==
d&&d.apply(this,arguments)||this}h(g,d);g.prototype.on=function(f,b){return a.after(this,"on"+f,b,!0)};g.prototype.once=function(a,b){return l.once(this,a,b)};g.prototype.emit=function(a,b){l.emit(this,a,b)};g.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return g}(d)}})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/Handles ../../../core/watchUtils ../../../core/accessorSupport/decorators ./handlers/DoubleClickZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/GamepadNavigation ./handlers/KeyPan ./handlers/KeyRotate ./handlers/KeyZoom ./handlers/MouseWheelZoom ./handlers/PinchAction ../../input/BrowserEventSource ../../input/InputManager ../../input/ViewEvents ../../input/handlers/PreventContextMenu".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q,u,A,z,x){var y={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},B={zoomIn:["\x3d","+"],zoomOut:["-","_"]},w={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(l){function m(){var a=null!==l&&l.apply(this,arguments)||this;a._handles=new d;return a}h(m,l);m.prototype.initialize=function(){var a=this;this.viewEvents=new z.ViewEvents(this.view);
this._handles.add([k.whenNot(this.view,"ready",function(){return a._disconnect()}),k.when(this.view,"ready",function(){return a._connect()})])};m.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect();this.viewEvents.destroy();this.viewEvents=null};m.prototype._disconnect=function(){this._inputManager&&(this.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)};m.prototype._connect=
function(){var a=new u.BrowserEventSource(this.view.surface,this.view.input),d=new A.InputManager(a);d.installHandlers("prevent-context-menu",[new x.PreventContextMenu]);d.installHandlers("navigation",[new q.PinchRotateAndZoom(this.view),new c.GamepadNavigation(this.view),new r.MouseWheelZoom(this.view),new f.DoubleClickZoom(this.view),new b.DragPan(this.view,"primary"),new t.KeyPan(this.view,y),new v.KeyZoom(this.view,B),new p.KeyRotate(this.view,w),new e.DragRotate(this.view,"secondary"),new f.DoubleClickZoom(this.view,
["Ctrl"])]);this.viewEvents.connect(d);this._source=a;this._inputManager=d};a([g.property()],m.prototype,"view",void 0);return m=a([g.subclass("esri.views.2d.input.MapViewInputManager")],m)}(g.declared(l))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d,f){var b=
a.call(this,!0)||this;b.view=d;b.registerIncoming("double-click",f,function(a){return b._handleDoubleClick(a,f)});return b}h(d,a);d.prototype._handleDoubleClick=function(a,f){l.eventMatchesPointerAction(a.data,"primary")&&(a.stopPropagation(),f?this.view.mapViewNavigation.zoomOut([a.data.x,a.data.y]):this.view.mapViewNavigation.zoomIn([a.data.x,a.data.y]))};return d}(a.InputHandler);m.DoubleClickZoom=n})},"esri/views/input/InputHandler":function(){define(["require","exports","../../core/Logger","./EventMatch"],
function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});var l=h.getLogger("esri.views.input.InputHandler");n=function(){function g(a){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._hasSideEffects=a}Object.defineProperty(g.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var a in this._incoming)for(var b=0,e=this._incoming[a];b<
e.length;b++)this._incomingEventMatches.push(e[b].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"incomingEventTypes",{get:function(){this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType}));return this._incomingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"outgoingEventTypes",{get:function(){this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing));
return this._outgoingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0});g.prototype.onInstall=function(a){var b=this;this._manager?l.error("This InputHandler has already been registered with an InputManager"):(a.setEventCallback(function(a){return b._handleEvent(a)}),a.setUninstallCallback(function(){return b._onUninstall()}),this._manager=a)};g.prototype.onUninstall=function(){};
g.prototype.registerIncoming=function(f,b,e){var c=this;"function"===typeof b?(e=b,b=[]):b=b||[];f="string"===typeof f?new a.EventMatch(f,b):f;var g=function(){c._incomingEventTypes=null;c._incomingEventMatches=null};b=function(a){var b=c._incoming[a.match.eventType];b&&(a=b.indexOf(a),b.splice(a,1),g(),c._manager&&c._manager.updateDependencies())};e=new d(f,e,{onPause:b,onRemove:b,onResume:function(a){var b=c._incoming[a.match.eventType];b&&-1===b.indexOf(a)&&(b.push(a),g(),c._manager&&c._manager.updateDependencies())}});
b=this._incoming[f.eventType];b||(b=[],this._incoming[f.eventType]=b);b.push(e);g();this._manager&&this._manager.updateDependencies();return e};g.prototype.registerOutgoing=function(a){var b=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var e=new k(a,{onEmit:function(a,e,f,d){b._manager.emit(a.eventType,e,f,d)},onRemove:function(a){delete b._outgoing[a.eventType];b._manager.updateDependencies()}});this._outgoing[a]=e;this._outgoingEventTypes=
null;this._manager&&this._manager.updateDependencies();return e};g.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)};g.prototype.stopCapturingPointer=function(a){this._manager.setPointerCapture(a,!1)};g.prototype._onUninstall=function(){this._manager?(this.onUninstall(),this._manager=null):l.error("This InputHandler is not registered with an InputManager")};g.prototype._handleEvent=function(a){var b=this._incoming[a.type];if(b)for(var e=0;e<b.length;e++){var c=b[e];
if(c.match.matches(a)&&(c.callback(a),a.shouldStopPropagation()))break}};return g}();m.InputHandler=n;var d=function(){function a(a,b,e){this.match=a;this._callback=b;this._handler=e}a.prototype.pause=function(){this._handler.onPause(this)};a.prototype.resume=function(){this._handler.onResume(this)};a.prototype.remove=function(){this._handler.onRemove(this)};Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0});return a}(),k=function(){function a(a,
b){this.eventType=a;this._removed=!1;this._handler=b}a.prototype.emit=function(a,b,e){if(!this._removed)this._handler.onEmit(this,a,b,e)};a.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)};return a}()})},"esri/views/input/EventMatch":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function h(a,l){void 0===l&&(l=[]);this.eventType=a;this.keyModifiers=l}h.prototype.matches=function(a){if(a.type!==this.eventType)return!1;
if(0===this.keyModifiers.length)return!0;a=a.modifiers;for(var l=0,d=this.keyModifiers;l<d.length;l++)if(!a.has(d[l]))return!1;return!0};return h}();m.EventMatch=n})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.eventMatchesPointerAction=function(h,a){switch(a){case "primary":return"touch"===h.pointerType||0===h.button;case "secondary":return"touch"!==h.pointerType&&2===h.button;case "tertiary":return"touch"!==
h.pointerType&&1===h.button}};m.eventMatchesMousePointerAction=function(h,a){if("touch"===h.pointerType)return!1;switch(a){case "primary":return 0===h.button;case "secondary":return 2===h.button;case "tertiary":return 1===h.button}}})},"esri/views/2d/input/handlers/DragPan":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,
"__esModule",{value:!0});n=function(k){function g(f,b,e){var c=k.call(this,!0)||this;c.view=f;c.pointerAction=b;c.registerIncoming("drag",e,function(a){return c._handleDrag(a)});c.registerIncoming("pointer-down",function(a){return c.stopMomentumNavigation()});var g=c.view.mapViewNavigation;c.dragEventSeparator=new a.DragEventSeparator({start:function(a,b){g.pan.begin(c.view,b.data);b.stopPropagation()},update:function(a,b){g.pan.update(c.view,b.data);b.stopPropagation()},end:function(a,b){g.pan.end(c.view,
b.data);b.stopPropagation()},condition:function(a,b){return 1===a&&d.eventMatchesPointerAction(b.data,c.pointerAction)}});return c}h(g,k);g.prototype._handleDrag=function(a){var b=this.view.mapViewNavigation;b.pinch.zoomMomentum||b.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(a)};g.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()};return g}(l.InputHandler);m.DragPan=n})},"esri/views/input/DragEventSeparator":function(){define(["require",
"exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function h(a){this.callbacks=a;this.currentCount=0;this.callbacks.condition||(this.callbacks.condition=function(){return!0})}h.prototype.handle=function(a){var l=a.data,d=l.pointers.size;switch(l.action){case "start":this.currentCount=d;this.emitStart(a);break;case "added":this.emitEnd(this.previousEvent);this.currentCount=d;this.emitStart(a);break;case "update":this.emitUpdate(a);break;case "removed":this.startEvent&&
this.emitEnd(this.previousEvent);this.currentCount=d;this.emitStart(a);break;case "end":this.emitEnd(a),this.currentCount=0}this.previousEvent=a};h.prototype.emitStart=function(a){this.startEvent=a;this.callbacks.condition(this.currentCount,a)&&this.callbacks.start(this.currentCount,a,this.startEvent)};h.prototype.emitUpdate=function(a){this.callbacks.condition(this.currentCount,a)&&this.callbacks.update(this.currentCount,a,this.startEvent)};h.prototype.emitEnd=function(a){this.callbacks.condition(this.currentCount,
a)&&this.callbacks.end(this.currentCount,a,this.startEvent);this.startEvent=null};return h}();m.DragEventSeparator=n})},"esri/views/2d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});n=function(k){function g(f,b,e){var c=k.call(this,!0)||this;c.view=f;c.pointerAction=b;
var g=c.view.mapViewNavigation;c.dragEventSeparator=new a.DragEventSeparator({start:function(a,b){g.rotate.begin(c.view,b.data);b.stopPropagation()},update:function(a,b){g.rotate.update(c.view,b.data);b.stopPropagation()},end:function(a,b){g.rotate.end(c.view,b.data);b.stopPropagation()},condition:function(a,b){return 1===a&&d.eventMatchesPointerAction(b.data,c.pointerAction)}});c.registerIncoming("drag",e,function(a){return c.dragEventSeparator.handle(a)});return c}h(g,k);return g}(l.InputHandler);
m.DragRotate=n})},"esri/views/2d/input/handlers/GamepadNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Handles ../../../../core/scheduling ../../../../core/watchUtils ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadUtils".split(" "),function(n,m,h,a,l,d,k,g,f){Object.defineProperty(m,"__esModule",{value:!0});n=function(g){function p(b){var c=g.call(this,!0)||this;c.view=b;c.frameTask=null;c.watchHandles=new a;c.currentDevice=
null;c.transformation={translation:[0,0,0],heading:0,tilt:0};c.handle=c.registerIncoming("gamepad",function(a){return c.handleEvent(a)});c.handle.pause();return c}h(p,g);p.prototype.onInstall=function(a){var b=this;g.prototype.onInstall.call(this,a);this.watchHandles.add([d.init(this.view.navigation.gamepad,"enabled",function(a){a?(b.handle.resume(),b.frameTask||(b.frameTask=l.addFrameTask({update:function(a){return b.frameUpdate(a.deltaTime)}}))):(b.handle.pause(),b.frameTask&&(b.frameTask.remove(),
b.frameTask=null))})])};p.prototype.onUninstall=function(){this.watchHandles.removeAll();this.frameTask&&(this.frameTask.remove(),this.frameTask=null);g.prototype.onUninstall.call(this)};p.prototype.handleEvent=function(a){var b=this.view.navigation.gamepad.device;b&&a.data.device!==b||this.currentDevice&&this.currentDevice!==a.data.device||("end"===a.data.action?(this.currentDevice=null,f.resetTransformation(this.transformation)):(this.currentDevice=a.data.device,f.extractTransformation(a.data,this.view.navigation.gamepad,
this.transformation)))};p.prototype.frameUpdate=function(a){var d=this.transformation;if(!f.isZeroTransformation(d)){var g=this.view.viewpoint.clone(),l=e*this.view.navigation.gamepad.velocityFactor*a;k.translateBy(g,g,[d.translation[0]*l,-d.translation[1]*l]);l=this.view.size;k.scaleAndRotateBy(g,g,1+d.translation[2]*c*a,this.view.constraints.rotationEnabled?-d.heading*b*a:0,[l[0]/2,l[1]],l);a=this.view.constraints.constrain(g,this.view.viewpoint);this.view.viewpoint=a}};return p}(g.InputHandler);
m.GamepadNavigation=n;var b=.06,e=.7,c=6E-4})},"esri/views/navigation/gamepadUtils":function(){define(["require","exports","../3d/lib/gl-matrix"],function(n,m,h){function a(a){var d=a*a;0>a&&(d*=-1);return d}Object.defineProperty(m,"__esModule",{value:!0});m.quadraticAccentuation=a;m.resetTransformation=function(a){a.translation[0]=0;a.translation[1]=0;a.translation[2]=0;a.heading=0;a.tilt=0;return a};m.extractTransformation=function(l,d,k){var g=l.state;l=l.device;d="forward-down"===d.tiltDirection?
1:-1;"standard"===l.deviceType?(k.translation[0]=a(g.axes[0]),k.translation[1]=a(g.axes[1]),k.translation[2]=a(g.buttons[7])-a(g.buttons[6]),k.heading=a(g.axes[2]),k.tilt=a(g.axes[3])):"spacemouse"===l.deviceType&&(k.translation[0]=1.2*a(g.axes[0]),k.translation[1]=1.2*a(g.axes[1]),k.translation[2]=2*-a(g.axes[2]),k.heading=1.2*a(g.axes[5]),k.tilt=1.2*a(g.axes[3]));k.tilt*=d;h.vec3d.scale(k.translation,1);return k};m.isZeroTransformation=function(a){return 0===a.translation[0]&&0===a.translation[1]&&
0===a.translation[2]&&0===a.heading&&0===a.tilt}})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d,g,f){var b,e=a.call(this,!0)||this;e.view=d;e.keys=g;e._keyMap=(b={},b[g.left]="left",b[g.right]="right",b[g.up]="up",b[g.down]="down",b);e.registerIncoming("key-down",f,function(a){return e._handleKeyDown(a)});
e.registerIncoming("key-up",f,function(a){return e._handleKeyUp(a)});return e}h(d,a);d.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};d.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};d.prototype._handleKey=function(a,d){var f=this._keyMap[a.data.key];if(null!=f){if(d)switch(f){case "left":this.view.mapViewNavigation.continousPanLeft();break;case "right":this.view.mapViewNavigation.continousPanRight();break;case "up":this.view.mapViewNavigation.continousPanUp();
break;case "down":this.view.mapViewNavigation.continousPanDown()}else this.view.mapViewNavigation.stop();a.stopPropagation()}};return d}(a.InputHandler);m.KeyPan=n})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d,g,f){var b,e=a.call(this,!0)||this;e.view=d;e.keys=g;e._keyToDirection=(b={},b[g.clockwiseOption1]=
"clockwise",b[g.clockwiseOption2]="clockwise",b[g.counterClockwiseOption1]="counterClockwise",b[g.counterClockwiseOption2]="counterClockwise",b[g.resetOption1]="reset",b[g.resetOption2]="reset",b);e.registerIncoming("key-down",f,function(a){return e._handleKeyDown(a)});e.registerIncoming("key-up",f,function(a){return e._handleKeyUp(a)});return e}h(d,a);d.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};d.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};d.prototype._handleKey=
function(a,d){var f=a.modifiers;0<f.size&&!f.has("Shift")||!this.view.constraints.rotationEnabled||!(f=this._keyToDirection[a.data.key])||(d?"clockwise"===f?this.view.mapViewNavigation.continousRotateClockwise():"counterClockwise"===f?this.view.mapViewNavigation.continousRotateCounterclockwise():this.view.mapViewNavigation.resetRotation():this.view.mapViewNavigation.stop(),a.stopPropagation())};return d}(a.InputHandler);m.KeyRotate=n})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});var l;(function(a){a[a.IN=0]="IN";a[a.OUT=1]="OUT"})(l||(l={}));n=function(a){function d(d,f,b){var e=a.call(this,!0)||this;e.view=d;e.keys=f;e._keysToZoomAction={};e.registerIncoming("key-down",b,function(a){return e._handleKeyDown(a)});f.zoomIn.forEach(function(a){return e._keysToZoomAction[a]=l.IN});f.zoomOut.forEach(function(a){return e._keysToZoomAction[a]=
l.OUT});return e}h(d,a);d.prototype._handleKeyDown=function(a){this._handleKey(a)};d.prototype._handleKey=function(a){var f=a.modifiers;0<f.size&&!f.has("Shift")||(f=this._keysToZoomAction[a.data.key],f===l.IN?(this.view.mapViewNavigation.zoomIn(),a.stopPropagation()):f===l.OUT&&(this.view.mapViewNavigation.zoomOut(),a.stopPropagation()))};return d}(a.InputHandler);m.KeyZoom=n})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../input/InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d,g){var f=a.call(this,!0)||this;f.view=d;f._canZoom=!0;f.registerIncoming("mouse-wheel",g,function(a){return f._handleMouseWheel(a)});return f}h(d,a);d.prototype._handleMouseWheel=function(a){var d=this;if(this._canZoom){var f=this.view.mapViewNavigation,b=a.data;if(b=f.zoom(1/Math.pow(.6,1/60*b.deltaY),[b.x,b.y]))this._canZoom=!1,b.always(function(){d._canZoom=!0;f.end()});
a.stopPropagation()}};return d}(a.InputHandler);m.MouseWheelZoom=n})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/DragEventSeparator","../../../input/InputHandler"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(d){function k(g){var f=d.call(this,!0)||this;f.view=g;f.registerIncoming("drag",function(a){return f._handleDrag(a)});f.registerIncoming("pointer-down",function(a){return f.stopMomentumNavigation()});
var b=f.view.mapViewNavigation;f.dragEventSeparator=new a.DragEventSeparator({start:function(a,c){b.pinch.begin(f.view,c.data);c.stopPropagation()},update:function(a,c){b.pinch.update(f.view,c.data);c.stopPropagation()},end:function(a,c){b.pinch.end(f.view,c.data);c.stopPropagation()},condition:function(a){return 2<=a}});return f}h(k,d);k.prototype._handleDrag=function(a){this.dragEventSeparator.handle(a)};k.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()};
return k}(l.InputHandler);m.PinchRotateAndZoom=n})},"esri/views/input/BrowserEventSource":function(){define("require exports ../../core/has ../../core/libs/pep/pep ./keys ./gamepad/GamepadSource".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});var k=h("trident"),g=h("edge"),f=h("chrome"),b=h("ff"),e=h("safari");n=function(){function h(b,c){var e=this;this.input=c;this._active={};this._activePointerCaptures=new Set;this._keyDownState=new Set;this._element=b;a.applyLocal(b);
b.getAttribute("tabindex")||b.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};this._initialCssTouchAction=b.style.touchAction;
b.style.touchAction="none";this._element.addEventListener("keydown",this._preventAltKeyDefault);this._gamepadSource=new d.GamepadSource(b,this.input);this._gamepadSource.onEvent=function(a){return e._callback("gamepad",a)}}h.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._element.releasePointerCapture(b)});this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null);this._activePointerCaptures=null;this._element.style.touchAction=
this._initialCssTouchAction;this._element.removeEventListener("keydown",this._preventAltKeyDefault)};Object.defineProperty(h.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"activeEvents",{set:function(a){var b=this,e;for(e in this._active)a&&a.has(e)||(this._element.removeEventListener(c[e],this._active[e]),delete this._active[e]);a&&a.forEach(function(a){if(!b._active[a]&&c[a]){var e=(b._eventHandlers[a]||b._handleDefault).bind(b,
a);b._element.addEventListener(c[a],e);b._active[a]=e}});this._gamepadSource.pollingEnabled=a&&a.has("gamepad")},enumerable:!0,configurable:!0});h.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):("pointerup"!==a.type&&this._element.releasePointerCapture(a.pointerId),this._activePointerCaptures.delete(a.pointerId))};h.prototype._updateNormalizedPointerLikeEvent=function(a,b){var c=this._element.getBoundingClientRect();
b.x=a.clientX-Math.round(c.left);b.y=a.clientY-Math.round(c.top);return b};h.prototype._handleKey=function(a,b){var c=l.eventKey(b);c&&"key-up"===a&&this._keyDownState.delete(c);b={native:b,key:c,repeat:c&&this._keyDownState.has(c)};c&&"key-down"===a&&this._keyDownState.add(b.key);this._callback(a,b)};h.prototype._handlePointer=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons});this._callback(a,b)};h.prototype._handlePointerPreventDefault=
function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons});b.preventDefault();this._callback(a,c)};h.prototype._handleMouseWheel=function(a,c){c.preventDefault();var d=c.deltaY;switch(c.deltaMode){case 0:if(k||g)d=d/document.documentElement.clientHeight*600;break;case 1:d*=30;break;case 2:d*=900}k||g?d*=.7:f||e?d*=.6:b&&(d*=1.375);var h=Math.abs(d);100<h&&(d=d/h*200/(1+Math.exp(-.02*(h-100))));c=this._updateNormalizedPointerLikeEvent(c,
{native:c,x:0,y:0,deltaY:d});this._callback(a,c)};h.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};h.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};h.prototype._preventAltKeyDefault=function(a){"Alt"===a.key&&a.preventDefault()};return h}();m.BrowserEventSource=n;var c={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove",
"mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel"}})},"esri/core/libs/pep/pep":function(){define(function(){function n(a,c){c=c||Object.create(null);var f=document.createEvent("Event");f.initEvent(a,c.bubbles||!1,c.cancelable||!1);a=2;for(var d;a<b.length;a++)d=b[a],f[d]=c[d]||e[a];f.buttons=c.buttons||0;a=0;a=c.pressure?
c.pressure:f.buttons?.5:0;f.x=f.clientX;f.y=f.clientY;f.pointerId=c.pointerId||0;f.width=c.width||0;f.height=c.height||0;f.pressure=a;f.tiltX=c.tiltX||0;f.tiltY=c.tiltY||0;f.pointerType=c.pointerType||"";f.hwTimestamp=c.hwTimestamp||0;f.isPrimary=c.isPrimary||!1;return f}function m(){this.array=[];this.size=0}function h(a,b,c,e){this.addCallback=a.bind(e);this.removeCallback=b.bind(e);this.changedCallback=c.bind(e);B&&(this.observer=new B(this.mutationWatcher.bind(this)))}function a(a){return"body /shadow-deep/ "+
l(a)}function l(a){return'[touch-action\x3d"'+a+'"]'}function d(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function k(){if(I){H.forEach(function(b){String(b)===b?(E+=l(b)+d(b)+"\n",F&&(E+=a(b)+d(b)+"\n")):(E+=b.selectors.map(l)+d(b.rule)+"\n",F&&(E+=b.selectors.map(a)+d(b.rule)+"\n"))});var b=document.createElement("style");b.textContent=E;document.head.appendChild(b)}}function g(a){if(!q.pointermap.has(a))throw a=Error("InvalidPointerId"),a.name="InvalidPointerId",
a;}function f(a){if(!a.ownerDocument.contains(a))throw a=Error("InvalidStateError"),a.name="InvalidStateError",a;}var b="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),e=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],c=window.Map&&window.Map.prototype.forEach?Map:m;m.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==
this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,e){a.call(b,c,e,this)},this)}};var t="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
p=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],v={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},r="undefined"!==typeof SVGElementInstance,q={pointermap:new c,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=
this.eventSourceList.length,c=0,e;c<b&&(e=this.eventSourceList[c]);c++)e.register.call(e,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,e;c<b&&(e=this.eventSourceList[c]);c++)e.unregister.call(e,a)},contains:function(a,b){try{return a.contains(b)}catch(L){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=
!1;this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&
this.eventMap[b])&&b(a);a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new n(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},
fireEvent:function(a,b){a=this.makeEvent(a,b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,e=0;e<t.length;e++)c=t[e],b[c]=a[c]||p[e],r&&("target"===c||"relatedTarget"===c)&&b[c]instanceof SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in v))return b},propagate:function(a,
b,c){for(var e=a.target,f=[];!e.contains(a.relatedTarget)&&e!==document;)f.push(e),e=e.parentNode;c&&f.reverse();f.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a);this.captureInfo[a]=b;var c=new n("gotpointercapture");c.pointerId=a;this.implicitRelease=this.releaseCapture.bind(this,a);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)},
releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=new n("lostpointercapture");c.pointerId=a;this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};q.boundHandler=q.eventHandler.bind(q);
var u={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var e=a.elementFromPoint(b,c),f;for(f=this.targetingShadow(e);f;){if(a=
f.elementFromPoint(b,c))return e=this.targetingShadow(a),this.searchRoot(e,b,c)||a;f=this.olderShadow(f)}return e}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},A=Array.prototype.forEach.call.bind(Array.prototype.forEach),z=Array.prototype.map.call.bind(Array.prototype.map),
x=Array.prototype.slice.call.bind(Array.prototype.slice),y=Array.prototype.filter.call.bind(Array.prototype.filter),B=window.MutationObserver||window.WebKitMutationObserver,w={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};h.prototype={watchSubtree:function(a){this.observer&&u.canTarget(a)&&this.observer.observe(a,w)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){A(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(x(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=z(a,this.findElements,this);b.push(y(a,this.isElement));return b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var H=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",I=window.PointerEvent||window.MSPointerEvent,F=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,D=q.pointermap,Q=[1,4,2,8,16],N=!1;try{N=1===(new MouseEvent("test",{buttons:1})).buttons}catch(S){}var M={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){q.listen(a,this.events)},unregister:function(a){q.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var e=0,f=b.length,d;e<f&&(d=b[e]);e++){var g=Math.abs(a-d.y);if(25>=Math.abs(c-d.x)&&25>=g)return!0}},prepareEvent:function(a){var b=q.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=D.get(this.POINTER_ID);a.buttons=0!==
b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=D.get(this.POINTER_ID),c=this.prepareEvent(a);N||(c.buttons=Q[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);D.set(this.POINTER_ID,a);b&&0!==b.buttons?q.move(c):q.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;D.set(this.POINTER_ID,a);q.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
D.get(this.POINTER_ID),c=this.prepareEvent(a);if(!N){var e=Q[c.button];c.buttons=b?b.buttons&~e:0;a.buttons=c.buttons}D.set(this.POINTER_ID,a);c.buttons&=~Q[c.button];0===c.buttons?q.up(c):q.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;D.set(this.POINTER_ID,a);q.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=
-1;q.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);q.cancel(a);this.deactivateMouse()},deactivateMouse:function(){D.delete(this.POINTER_ID)}},C=q.captureInfo,J=u.findTarget.bind(u),P=u.allShadows.bind(u),K=q.pointermap,aa,G={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){aa.enableOnSubtree(a)},unregister:function(a){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,q.listen(a,this.events),
P(a).forEach(function(a){a._scrollType=c;q.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;q.unlisten(a,this.events);P(a).forEach(function(a){a._scrollType=void 0;q.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),e=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);e&&b?(a._scrollType=e,P(a).forEach(function(a){a._scrollType=e},this)):b?this.elementRemoved(a):e&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",
XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===K.size||1===K.size&&K.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=
!1,this.cancelResetClickCount()},removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,
c=q.cloneEvent(a),e=c.pointerId=a.identifier+2;c.target=C[e]||J(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=a.radiusX||a.webkitRadiusX||0;c.height=a.radiusY||a.webkitRadiusY||0;c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var f=this;c.preventDefault=function(){f.scrolling=!1;f.firstXY=null;b.preventDefault()};
return c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var e;a<c.length;a++)e=c[a],b.call(this,this.touchToPointer(e))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,e=a.length,f;c<e&&(f=a[c]);c++)if(f.identifier===
b)return!0},vacuumTouches:function(a){var b=a.touches;if(K.size>=b.length){var c=[];K.forEach(function(a,e){1===e||this.findTouch(b,e-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){K.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});q.enterOver(a);q.down(a)},touchmove:function(a){this.scrolling||
(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=K.get(a.pointerId);if(b){var c=b.out,e=b.outTarget;q.move(a);c&&e!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=e,c.target=e,a.target?(q.leaveOut(c),q.enterOver(a)):(a.target=e,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||
(q.up(a),q.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){q.cancel(a);q.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){K.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=M.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};aa=new h(G.elementAdded,
G.elementRemoved,G.elementChanged,G);var ba=q.pointermap,da=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,ca={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){q.listen(a,this.events)},unregister:function(a){q.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;da&&(b=q.cloneEvent(a),b.pointerType=
this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){ba.delete(a)},MSPointerDown:function(a){ba.set(a.pointerId,a);a=this.prepareEvent(a);q.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);q.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);q.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);q.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);q.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);q.cancel(b);
this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){a=q.makeEvent("lostpointercapture",a);q.dispatchEvent(a)},MSGotPointerCapture:function(a){a=q.makeEvent("gotpointercapture",a);q.dispatchEvent(a)}},X,Y;window.navigator.msPointerEnabled?(X=function(a){g(a);f(this);0!==q.pointermap.get(a).buttons&&this.msSetPointerCapture(a)},Y=function(a){g(a);this.msReleasePointerCapture(a)}):(X=function(a){g(a);f(this);0!==q.pointermap.get(a).buttons&&q.setCapture(a,this)},Y=function(a){g(a);q.releaseCapture(a,
this)});var R=window.PointerEvent||window.MSPointerEvent;return{dispatcher:q,Installer:h,PointerEvent:n,PointerMap:c,targetFinding:u,applyGlobal:function(){k();window.PointerEvent||(window.PointerEvent=n,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),q.registerSource("ms",ca)):(q.registerSource("mouse",M),void 0!==window.ontouchstart&&q.registerSource("touch",G)),q.register(document));window.Element&&
!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:X},releasePointerCapture:{value:Y}})},applyLocal:function(a){R||(window.PointerEvent||(window.navigator.msPointerEnabled?q.registerSource("ms",ca):(q.registerSource("mouse",M),void 0!==window.ontouchstart&&q.registerSource("touch",G)),q.register(document)),window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=X.bind(a),a.releasePointerCapture=Y.bind(a)),a.getAttribute("touch-action")||
a.setAttribute("touch-action","none"))}}})},"esri/views/input/keys":function(){define(["require","exports","../../core/has"],function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});m.primaryKey=h("mac")?"Meta":"Ctrl";var a={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(n=48;58>n;n++)a[n]=String.fromCharCode(n);for(n=1;25>n;n++)a[111+n]="F"+n;for(n=65;91>n;n++)a[n]=
[String.fromCharCode(n+32),String.fromCharCode(n)];var l={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Esc:"Escape"};m.eventKey=function(d){if(void 0!==d.key)return l[d.key]||d.key;var k=a[d.keyCode];return Array.isArray(k)?d.shiftKey?k[1]:k[0]:k};m.isSystemModifier=function(a){switch(a){case "Ctrl":case "Alt":case "Shift":case "Meta":case "Primary":return!0}}})},"esri/views/input/gamepad/GamepadSource":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/scheduling ./GamepadInputDevice ./GamepadState".split(" "),
function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function k(a,f){var b=this;this.element=a;this.input=f;this.handleGamepadConnectedEvent=function(a){b.handleGamepadConnected(a.gamepad)};this.handleGamepadDisconnectedEvent=function(a){a=a.gamepad;var c=b.inputDevices[a.index];c&&(b.emitGamepadEvent(a,d.extractState(c),!1),b.inputDevices[a.index]=void 0,b.latestUpdate[a.index]=void 0,b.input.gamepad.devices.remove(c))};this.frameTask=null;this.latestUpdate=[];this.inputDevices=
[];this.callback=null;if(this.supported="getGamepads"in window.navigator)this.forEachGamepad(function(a){return b.handleGamepadConnected(a)}),window.addEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent)}k.prototype.destroy=function(){this.pollingEnabled=!1;this.supported&&(window.removeEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",
this.handleGamepadDisconnectedEvent))};Object.defineProperty(k.prototype,"onEvent",{set:function(a){this.callback=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"pollingEnabled",{set:function(a){this.supported&&(a?this.startPolling():this.stopPolling())},enumerable:!0,configurable:!0});k.prototype.handleGamepadConnected=function(a){var f=new l(a);"unknown"!==f.deviceType&&(this.inputDevices[a.index]=f,this.input.gamepad.devices.add(f))};k.prototype.startPolling=function(){var d=
this;null==this.frameTask&&(this.frameTask=a.addFrameTask({update:function(){return d.readGamepadState()}}))};k.prototype.stopPolling=function(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])};k.prototype.readGamepadState=function(){var a=this,f=!document.hasFocus||document.hasFocus(),b=this.element.contains(document.activeElement),e="document"===this.input.gamepad.enabledFocusMode&&!f||"view"===this.input.gamepad.enabledFocusMode&&!b;this.forEachGamepad(function(b){var c=
a.inputDevices[b.index];if(c){var f=a.latestUpdate[b.index],c=d.extractState(c),g=e||d.stateIdle(c);f&&(f.timestamp===b.timestamp||!f.active&&g||d.stateEqual(f.state,c))||a.emitGamepadEvent(b,c,!g)}})};k.prototype.forEachGamepad=function(a){for(var f=window.navigator.getGamepads(),b=0;b<f.length;b++){var e=f[b];this.validate(e)&&a(e)}};k.prototype.emitGamepadEvent=function(a,f,b){var e=this.latestUpdate[a.index];if((e=e&&e.active)||b)this.latestUpdate[a.index]={timestamp:a.timestamp,state:f,active:b},
this.callback&&this.callback({device:this.inputDevices[a.index],state:f,action:!e&&b?"start":e&&b?"update":"end"})};k.prototype.validate=function(a){if(!a||!a.connected)return!1;for(var f=0;f<a.axes.length;f++)if(isNaN(a.axes[f]))return!1;return!0};return k}();m.GamepadSource=n})},"esri/views/input/gamepad/GamepadState":function(){define(["require","exports","../../3d/support/mathUtils"],function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});m.extractState=function(a){var l=a.native;return{buttons:l.buttons.map(function(a){return a.pressed?
a.value?a.value:1:0}),axes:l.axes.map(function(d){var k=a.axisThreshold,g=Math.abs(d);d=g<k?0:h.sign(d)*(g-k)/(1-k);return d})}};m.stateEqual=function(a,h){if(a.axes.length!==h.axes.length||a.buttons.length!==h.buttons.length)return!1;for(var d=0;d<a.axes.length;d++)if(a.axes[d]!==h.axes[d])return!1;for(d=0;d<a.buttons.length;d++)if(a.buttons[d]!==h.buttons[d])return!1;return!0};m.stateIdle=function(a){for(var h=0;h<a.axes.length;h++)if(0!==a.axes[h])return!1;for(h=0;h<a.buttons.length;h++)if(0!==
a.buttons[h])return!1;return!0}})},"esri/views/input/InputManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Logger ../../core/now ../../core/accessorSupport/decorators ./keys ./recognizers ./handlers/LatestPointerType".split(" "),function(n,m,h,a,l,d,k,g,f,b,e){Object.defineProperty(m,"__esModule",{value:!0});var c=d.getLogger("esri.views.input.InputManager");n=function(d){function l(a,b){a=d.call(this)||
this;a._pointerCaptures=new Map;a._nameToGroup={};a._handlers=[];a._currentPropagation=null;a._sourceEvents=new Set;a._keyModifiers=new Set;a._activeKeyModifiers=new Set;a.primaryKey=f.primaryKey;a.latestPointerType="mouse";a._installRecognizers();return a}h(l,d);l.prototype.normalizeCtorArgs=function(a,c){this._browserEvents=a;this._browserEvents.onEventReceived=this._onEventReceived.bind(this);this._recognizers=c;this._recognizers||(this._recognizers=b.defaults.map(function(a){return new a}));return{}};
l.prototype.destroy=function(){for(var a=0,b=Object.keys(this._nameToGroup);a<b.length;a++)this.uninstallHandlers(b[a]);this._browserEvents=null};l.prototype.installHandlers=function(a,b){var e=this;if(this._nameToGroup[a])c.error("There is already an InputHandler group registered under the name `"+a+"`");else if(0===b.length)c.error("Can't register a group of zero handlers");else{var f={name:a,handlers:b.map(function(a,b){return{handler:a,active:!0,removed:!1,priorityIndex:0,eventCallback:null,uninstallCallback:null}})};
this._nameToGroup[a]=f;a=function(a){var b=f.handlers[a];d._handlers.push(b);b.handler.onInstall({updateDependencies:function(){e.updateDependencies()},emit:function(a,c,f,d){e._emitInputEvent(b.priorityIndex,a,c,f,d)},setPointerCapture:function(a,c){e._setPointerCapture(f,b,a,c)},setEventCallback:function(a){b.eventCallback=a},setUninstallCallback:function(a){b.uninstallCallback=a}})};var d=this;for(b=f.handlers.length-1;0<=b;b--)a(b);this.updateDependencies()}};l.prototype.uninstallHandlers=function(a){var b=
this._nameToGroup[a];b?(b.handlers.forEach(function(a){a.removed=!0;a.uninstallCallback()}),delete this._nameToGroup[a],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):c.error("There is no InputHandler group registered under the name `"+a+"`")};l.prototype.hasHandlers=function(a){return void 0!==this._nameToGroup[a]};l.prototype.updateDependencies=function(){var a=new Set,b=new Set;this._handlersPriority=[];for(var c=this._handlers.length-
1;0<=c;c--){var e=this._handlers[c];e.priorityIndex=c;this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(c=this._handlersPriority.length-1;0<=c;c--){e=this._handlersPriority[c];e.priorityIndex=c;var d=e.handler.hasSideEffects;if(!d)for(var g=0,k=e.handler.outgoingEventTypes;g<k.length;g++)if(a.has(k[g])){d=!0;break}if(d)for(g=0,k=e.handler.incomingEventMatches;g<k.length;g++){var h=k[g];a.add(h.eventType);for(var l=0,h=h.keyModifiers;l<h.length;l++){var p=
h[l];f.isSystemModifier(p)||b.add(p)}}e.active=d}this._sourceEvents=a;this._keyModifiers=b;0<this._pointerCaptures.size&&this._sourceEvents.add("pointer-capture-lost");0<this._keyModifiers.size&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up"));this._browserEvents&&(this._browserEvents.activeEvents=this._sourceEvents)};l.prototype._setLatestPointerType=function(a){this._set("latestPointerType",a)};l.prototype._onEventReceived=function(a,b){"pointer-capture-lost"===a&&this._pointerCaptures.delete(b.native.pointerId);
this._updateKeyModifiers(a,b);this._emitInputEventFromSource(a,b,b.native?b.native.timestamp:void 0)};l.prototype._updateKeyModifiers=function(a,b){var c=this;if(b){var e=!1,f=function(){if(!e){var a=new Set;c._activeKeyModifiers.forEach(function(b){a.add(b)});c._activeKeyModifiers=a;e=!0}},d=function(a,b){b&&!c._activeKeyModifiers.has(a)?(f(),c._activeKeyModifiers.add(a)):!b&&c._activeKeyModifiers.has(a)&&(f(),c._activeKeyModifiers.delete(a))};if("key-down"===a||"key-up"===a){var g=b.key;this._keyModifiers.has(g)&&
d(g,"key-down"===a)}a=b.native;d("Alt",!(!a||!a.altKey));d("Ctrl",!(!a||!a.ctrlKey));d("Shift",!(!a||!a.shiftKey));d("Meta",!(!a||!a.metaKey));d("Primary",this._activeKeyModifiers.has(this.primaryKey))}};l.prototype._installRecognizers=function(){var a=this;this._latestPointerTypeHandler=new e.LatestPointerType(function(b){return a._setLatestPointerType(b)});0<this._recognizers.length&&this.installHandlers("default",this._recognizers);this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler])};
l.prototype._setPointerCapture=function(a,b,c,e){a=a.name+"-"+b.priorityIndex;b=this._pointerCaptures.get(c.pointerId)||new Set;this._pointerCaptures.set(c.pointerId,b);e?(b.add(a),1===b.size&&this._browserEvents&&this._browserEvents.setPointerCapture(c,!0)):b.has(a)&&(b.delete(a),0===b.size&&(this._pointerCaptures.delete(c.pointerId),this._browserEvents&&this._browserEvents.setPointerCapture(c,!1)))};l.prototype._garbageCollectRemovedHandlers=function(){this._handlers=this._handlers.filter(function(a){return!a.removed});
this.updateDependencies()};l.prototype._emitInputEventFromSource=function(a,b,c){this._emitInputEvent(0,a,b,c)};l.prototype._emitInputEvent=function(a,b,c,e,f){e=void 0!==e?e:this._currentPropagation?this._currentPropagation.timestamp:k();b=new t(b,c,e,f||this._activeKeyModifiers);this._currentPropagation?this._currentPropagation.addedEvents.push(b):this._doNewPropagation(a,b)};l.prototype._doNewPropagation=function(a,b){for(a=this._currentPropagation={events:[b],addedEvents:[],currentHandler:this._handlersPriority[a],
needsHandlerGarbageCollect:!1,timestamp:b.timestamp};a.currentHandler;){if(a.currentHandler.removed)a.needsHandlerGarbageCollect=!0;else{b=a.events;var c=[];a.addedEvents=[];for(var e=0;e<b.length;e++){var f=b[e];a.currentHandler.active&&a.currentHandler.eventCallback(f);f.shouldStopPropagation()||c.push(f)}a.events=c.concat(a.addedEvents)}a.currentHandler=this._handlersPriority[a.currentHandler.priorityIndex+1]}a.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers();this._currentPropagation=
null};l.prototype._compareHandlerPriority=function(a,b){if(a.handler.hasSideEffects!==b.handler.hasSideEffects)return a.handler.hasSideEffects?1:-1;for(var c=0,e=a.handler.incomingEventMatches;c<e.length;c++)for(var f=e[c],d=function(a){if(f.eventType!==a.eventType)return"continue";var b=f.keyModifiers.filter(function(b){return-1!==a.keyModifiers.indexOf(b)});if(b.length===f.keyModifiers.length!==(b.length===a.keyModifiers.length))return{value:f.keyModifiers.length>a.keyModifiers.length?-1:1}},g=
0,k=b.handler.incomingEventMatches;g<k.length;g++){var h=d(k[g]);if("object"===typeof h)return h.value}return a.priorityIndex>b.priorityIndex?-1:1};l.prototype._sortHandlersPriority=function(a){for(var b=[],c=0;c<a.length;c++){for(var e=a[c],f=0;f<b.length&&0<=this._compareHandlerPriority(e,b[f]);)f++;b.splice(f,0,e)}return b};a([g.property({readOnly:!0})],l.prototype,"latestPointerType",void 0);return l=a([g.subclass("esri.views.input.InputManager")],l)}(g.declared(l));m.InputManager=n;var t=function(){function a(a,
b,c,e){this.type=a;this.data=b;this.timestamp=c;this.modifiers=e;this._stopPropagation=!1}a.prototype.stopPropagation=function(){this._stopPropagation=!0};a.prototype.shouldStopPropagation=function(){return this._stopPropagation};return a}()})},"esri/views/input/recognizers":function(){define("require exports ./recognizers/Drag ./recognizers/PointerClickHoldAndDrag ./recognizers/SingleAndDoubleClick ./recognizers/VerticalTwoFingerDrag".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",
{value:!0});m.defaults=[a.PointerClickHoldAndDrag,l.SingleAndDoubleClick,h.Drag,d.VerticalTwoFingerDrag]})},"esri/views/input/recognizers/Drag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(n,m,h,a,l){function d(a){var b=[];a.forEach(function(a){b.push(a.event)});return l.fitCircleLSQ(b)}function k(a){var b=d(a),c=0;a.forEach(function(a){for(var e=f(a,b),e=e-a.lastAngle;e>Math.PI;)e-=2*Math.PI;for(;e<-Math.PI;)e+=2*Math.PI;e=
a.lastAngle+e;a.lastAngle=e;c+=e-a.initialAngle});c/=a.size||1;return{angle:c,radius:b.radius,center:b.center}}function g(a){var b=new Map;a.forEach(function(a,e){return b.set(e,a.event)});return b}function f(a,e){a=a.event;return Math.atan2(a.y-e.center.y,a.x-e.center.x)}Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function b(){var b=a.call(this,!1)||this;b.startStateModifiers=new Set;b.activePointerMap=new Map;b.isDragging=!1;b.drag=b.registerOutgoing("drag");b.registerIncoming("pointer-drag",
b.handlePointerDrag.bind(b));b.registerIncoming("pointer-up",b.handlePointerUpAndPointerLost.bind(b));b.registerIncoming("pointer-capture-lost",b.handlePointerUpAndPointerLost.bind(b));b.registerIncoming("pointer-cancel",b.handlePointerUpAndPointerLost.bind(b));return b}h(b,a);b.prototype.createPayload=function(a,b,e,f){return{action:a,pointerType:this.pointerType,button:this.mouseButton,buttons:b.buttons,timestamp:f,pointers:g(this.activePointerMap),pointer:b,angle:e.angle,radius:e.radius,center:e.center}};
b.prototype.addPointer=function(a){var b=a.native.pointerId,c=k(this.activePointerMap).angle;a={event:a,initialAngle:0,lastAngle:0};this.activePointerMap.set(b,a);b=f(a,d(this.activePointerMap));a.initialAngle=b;a.lastAngle=b;this.updatePointerAngles(c)};b.prototype.updatePointer=function(a){if(!a||null!=a.x||null!=a.y){var b=this.activePointerMap.get(a.native.pointerId);b?b.event=a:this.addPointer(a)}};b.prototype.removePointer=function(a){var b=k(this.activePointerMap).angle;this.activePointerMap.delete(a);
this.updatePointerAngles(b)};b.prototype.updatePointerAngles=function(a){var b=k(this.activePointerMap);this.activePointerMap.forEach(function(c){c.initialAngle=f(c,b)-a;c.lastAngle=f(c,b)-a})};b.prototype.emitEvent=function(a,b,e){var c=k(this.activePointerMap);this.drag.emit(this.createPayload(a,b,c,e),void 0,this.startStateModifiers)};b.prototype.handlePointerUpAndPointerLost=function(a){var b=a.data.native.pointerId,c=a.timestamp;this.activePointerMap.get(b)&&(1===this.activePointerMap.size?(this.updatePointer(a.data),
this.emitEvent("end",a.data,c),this.isDragging=!1,this.removePointer(b)):(this.removePointer(b),this.emitEvent("removed",a.data,a.timestamp)))};b.prototype.handlePointerDrag=function(a){var b=a.data,c=b.currentEvent,e=a.timestamp;switch(b.action){case "start":case "update":this.isDragging?this.activePointerMap.has(c.native.pointerId)?(this.updatePointer(c),this.emitEvent("update",c,e)):(this.addPointer(c),this.emitEvent("added",c,e)):(this.updatePointer(c),this.pointerType=a.data.startEvent.pointerType,
this.mouseButton=a.data.startEvent.button,this.startStateModifiers=a.modifiers,this.isDragging=!0,this.emitEvent("start",c,e))}};return b}(a.InputHandler);m.Drag=n;(function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right";a[a.Back=3]="Back";a[a.Forward=4]="Forward";a[a.Undefined=-1]="Undefined"})(m.Button||(m.Button={}))})},"esri/views/input/recognizers/support":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});m.manhattanDistance=
function(h,a){return Math.abs(a.x-h.x)+Math.abs(a.y-h.y)};m.euclideanDistance=function(h,a){var l=a.x-h.x;h=a.y-h.y;return Math.sqrt(l*l+h*h)};m.fitCircleLSQ=function(h,a){a?(a.radius=0,a.center.x=0,a.center.y=0):a={radius:0,center:{x:0,y:0}};if(0===h.length)return a;if(1===h.length)return a.center.x=h[0].x,a.center.y=h[0].y,a;if(2===h.length){var l=h[0];h=h[1];var d=[h.x-l.x,h.y-l.y],k=d[0],d=d[1];a.radius=Math.sqrt(k*k+d*d)/2;a.center.x=(l.x+h.x)/2;a.center.y=(l.y+h.y)/2;return a}for(var g=0,f=
0,b=0;b<h.length;b++)g+=h[b].x,f+=h[b].y;for(var g=g/h.length,f=f/h.length,e=h.map(function(a){return a.x-g}),c=h.map(function(a){return a.y-f}),t=l=a=0,p=0,m=k=0,b=d=0;b<e.length;b++){var r=e[b],q=c[b],n=r*r,A=q*q;a+=n;l+=A;t+=r*q;p+=n*r;k+=A*q;m+=r*A;d+=q*n}b=a;e=t;c=l;p=.5*(p+m);k=.5*(k+d);d=b*c-t*e;m=(p*c-k*e)/d;k=(b*k-t*p)/d;return{radius:Math.sqrt(m*m+k*k+(a+l)/h.length),center:{x:m+g,y:k+f}}}})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler","./support"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});m.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilTouchDrag:6,holdDelay:500};n=function(a){function d(d,f,b,e){void 0===d&&(d=m.DefaultParameters.maximumClickDelay);void 0===f&&(f=m.DefaultParameters.movementUntilMouseDrag);void 0===b&&(b=m.DefaultParameters.movementUntilTouchDrag);void 0===e&&(e=m.DefaultParameters.holdDelay);var c=a.call(this,!1)||this;c.maximumClickDelay=
d;c.movementUntilMouseDrag=f;c.movementUntilTouchDrag=b;c.holdDelay=e;c._pointerState=new Map;c._pointerDrag=c.registerOutgoing("pointer-drag");c._immediateClick=c.registerOutgoing("immediate-click");c._pointerHold=c.registerOutgoing("hold");c.registerIncoming("pointer-down",c._handlePointerDown.bind(c));c.registerIncoming("pointer-up",function(a){c._handlePointerLoss(a,"pointer-up")});c.registerIncoming("pointer-capture-lost",function(a){c._handlePointerLoss(a,"pointer-capture-lost")});c.registerIncoming("pointer-cancel",
function(a){c._handlePointerLoss(a,"pointer-cancel")});c._moveHandle=c.registerIncoming("pointer-move",c._handlePointerMove.bind(c));c._moveHandle.pause();return c}h(d,a);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});a.prototype.onUninstall.call(this)};d.prototype._handlePointerDown=function(a){var f=this,b=a.data,e=b.native.pointerId,c=0;0===this._pointerState.size&&(c=setTimeout(function(){var b=f._pointerState.get(e);
b&&(b.isDragging||(f._pointerHold.emit(b.previousEvent,void 0,a.modifiers),b.holdEmitted=!0),b.holdTimeout=0)},this.holdDelay));c={startEvent:b,previousEvent:b,startTimestamp:a.timestamp,isDragging:!1,downButton:b.native.button,holdTimeout:c,modifiers:new Set};this._pointerState.set(e,c);this.startCapturingPointer(b.native);this._moveHandle.resume();1<this._pointerState.size&&this.startDragging(a)};d.prototype._createPointerDragData=function(a,f,b){return{action:a,startEvent:f.startEvent,previousEvent:f.previousEvent,
currentEvent:b}};d.prototype._handlePointerMove=function(a){var f=a.data,b=this._pointerState.get(f.native.pointerId);b&&(b.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",b,f),void 0,b.modifiers):l.euclideanDistance(f,b.startEvent)>("touch"===f.native.pointerType?this.movementUntilTouchDrag:this.movementUntilMouseDrag)&&this.startDragging(a),b.previousEvent=f)};d.prototype.startDragging=function(a){var f=this,b=a.data,e=b.native.pointerId;this._pointerState.forEach(function(c){0!==
c.holdTimeout&&(clearTimeout(c.holdTimeout),c.holdTimeout=0);c.isDragging||(c.modifiers=a.modifiers,c.isDragging=!0,e===c.startEvent.native.pointerId?f._pointerDrag.emit(f._createPointerDragData("start",c,b)):f._pointerDrag.emit(f._createPointerDragData("start",c,c.previousEvent),a.timestamp))})};d.prototype._handlePointerLoss=function(a,f){var b=a.data,e=b.native.pointerId,c=this._pointerState.get(e);c&&(0!==c.holdTimeout&&clearTimeout(c.holdTimeout),c.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",
c,"pointer-up"===f?b:c.previousEvent),void 0,c.modifiers):"pointer-up"===f&&c.downButton===b.native.button&&a.timestamp-c.startTimestamp<=this.maximumClickDelay&&!c.holdEmitted&&this._immediateClick.emit(b),this._pointerState.delete(e),this.stopCapturingPointer(b.native),0===this._pointerState.size&&this._moveHandle.pause())};return d}(a.InputHandler);m.PointerClickHoldAndDrag=n})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler","./support"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});m.DefaultParameters={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};n=function(a){function d(d,f,b,e){void 0===d&&(d=m.DefaultParameters.maximumDoubleClickDelay);void 0===f&&(f=m.DefaultParameters.maximumDoubleClickDistance);void 0===b&&(b=m.DefaultParameters.maximumDoubleTouchDelay);void 0===e&&(e=m.DefaultParameters.maximumDoubleTouchDistance);
var c=a.call(this,!1)||this;c.maximumDoubleClickDelay=d;c.maximumDoubleClickDistance=f;c.maximumDoubleTouchDelay=b;c.maximumDoubleTouchDistance=e;c._pointerState=new Map;c._click=c.registerOutgoing("click");c._doubleClick=c.registerOutgoing("double-click");c.registerIncoming("immediate-click",c._handleImmediateClick.bind(c));return c}h(d,a);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){0!==a.doubleClickTimeout&&(clearTimeout(a.doubleClickTimeout),a.doubleClickTimeout=0)})};
d.prototype._pointerId=function(a){a=a.native;return"mouse"===a.pointerType?a.pointerId+":"+a.button:""+a.pointerType};d.prototype._handleImmediateClick=function(a){var f=a.data,b=this._pointerId(f),e=this._pointerState.get(b);if(e){clearTimeout(e.doubleClickTimeout);e.doubleClickTimeout=0;var c="touch"===f.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;l.manhattanDistance(e.event.data,f)>c?(this._doubleClickTimeoutExceeded(b),this._startClick(a)):(this._doubleClick.emit(f,
void 0,e.event.modifiers),this._pointerState.delete(b))}else this._startClick(a)};d.prototype._startClick=function(a){var f=this,b=this._pointerId(a.data);this._pointerState.set(b,{event:a,doubleClickTimeout:setTimeout(function(){return f._doubleClickTimeoutExceeded(b)},"touch"===a.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)})};d.prototype._doubleClickTimeoutExceeded=function(a){var f=this._pointerState.get(a);this._click.emit(f.event.data,void 0,f.event.modifiers);
f.doubleClickTimeout=0;this._pointerState.delete(a)};return d}(a.InputHandler);m.SingleAndDoubleClick=n})},"esri/views/input/recognizers/VerticalTwoFingerDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../DragEventSeparator","../InputHandler"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(d){function k(g,f){void 0===g&&(g=20);void 0===f&&(f=40);var b=d.call(this,!1)||this;b._threshold=g;b._maxDelta=f;b.state="ready";b.emittedArtificalEnd2=
!1;b._vertical=b.registerOutgoing("vertical-two-finger-drag");b._artificalDrag=b.registerOutgoing("drag");b.dragEventSeparator=new a.DragEventSeparator({start:function(a,c){return b.observeStart(a,c)},update:function(a,c,f){return b.observeUpdate(a,c,f)},end:function(a,c){return b.observeEnd(a,c)}});b.registerIncoming("drag",function(a){return b.dragEventSeparator.handle(a)});return b}h(k,d);Object.defineProperty(k.prototype,"failed",{get:function(){return"failed"===this.state},enumerable:!0,configurable:!0});
k.prototype.observeStart=function(a,f){1===a&&this.emittedArtificalEnd2&&(this.emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:f.data.button,buttons:f.data.buttons,pointerType:f.data.pointerType,timestamp:f.data.timestamp,pointers:f.data.pointers,pointer:f.data.pointer,angle:f.data.angle,radius:f.data.radius,center:f.data.center,artifical:!0}),f.stopPropagation());this.state=2===a?"ready":"failed"};k.prototype.observeUpdate=function(a,f,b){"failed"!==this.state&&2===a&&("active"===
this.state?(this._vertical.emit({delta:f.data.center.y-this._thresholdReachedCenter.y,action:"update"}),f.stopPropagation()):this.checkMovementWithinLimits(f.data,b.data)?this.checkVerticalThresholdReached(f.data,b.data)&&(this.state="active",this.emittedArtificalEnd2=!0,this._thresholdReachedCenter=f.data.center,this._artificalDrag.emit({action:"end",button:f.data.button,buttons:f.data.buttons,pointerType:f.data.pointerType,timestamp:f.data.timestamp,pointers:f.data.pointers,pointer:f.data.pointer,
angle:f.data.angle,radius:f.data.radius,center:f.data.center,artifical:!0}),this._vertical.emit({delta:f.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),f.stopPropagation()):this.state="failed")};k.prototype.observeEnd=function(a,f){"active"===this.state&&(this._vertical.emit({delta:f.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this.state="ready",f.stopPropagation())};k.prototype.checkMovementWithinLimits=function(a,f){var b=-Infinity,e=Infinity,c=-Infinity,d=Infinity;
f.pointers.forEach(function(a){b=Math.max(b,a.x);e=Math.min(e,a.x);c=Math.max(c,a.y);d=Math.min(d,a.y)});var g=-Infinity,k=Infinity,h=-Infinity,l=Infinity;a.pointers.forEach(function(a){g=Math.max(g,a.x);k=Math.min(k,a.x);h=Math.max(h,a.y);l=Math.min(l,a.y)});return Math.abs(a.center.x-f.center.x)<this._threshold&&Math.abs(g-k-(b-e))<=this._maxDelta&&Math.abs(h-l-(c-d))<=this._maxDelta};k.prototype.checkVerticalThresholdReached=function(a,f){var b=Math.abs(a.center.y-f.center.y);a.pointers.forEach(function(a,
c){c=f.pointers.get(c);b=Math.min(b,Math.abs(a.y-c.y))});return b>=this._threshold};return k}(l.InputHandler);m.VerticalTwoFingerDrag=n})},"esri/views/input/handlers/LatestPointerType":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d){var g=a.call(this,!0)||this;g._onChange=d;g._value="mouse";g.registerIncoming("pointer-down",function(a){g._setValue("touch"===
a.data.native.pointerType?"touch":"mouse")});g._moveHandler=g.registerIncoming("pointer-move",function(a){g._setValue("touch"===a.data.native.pointerType?"touch":"mouse")});g._moveHandler.pause();return g}h(d,a);d.prototype._setValue=function(a){a!==this._value&&("touch"===a?this._moveHandler.resume():this._moveHandler.pause(),this._value=a,this._onChange(a))};return d}(a.InputHandler);m.LatestPointerType=n})},"esri/views/input/ViewEvents":function(){define("require exports ../../core/tsSupport/extendsHelper ../../geometry/ScreenPoint ../3d/support/mathUtils ./InputHandler".split(" "),
function(n,m,h,a,l,d){function k(a){return!!f[a]}function g(a){for(var b=0;b<a.length;b++)if(!k(a[b]))return!1;return!0}Object.defineProperty(m,"__esModule",{value:!0});var f={click:!0,"double-click":!0,"immediate-click":!0,hold:!0,drag:!0,"key-down":!0,"key-up":!0,"pointer-down":!0,"pointer-move":!0,"pointer-up":!0,"pointer-drag":!0,"mouse-wheel":!0,"pointer-enter":!0,"pointer-leave":!0,gamepad:!0},b;(function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right"})(b||(b={}));n=function(){function a(a){this.handlers=
new Map;this.counter=0;this.handlerCounts=new Map;this.view=a;this.inputManager=null}a.prototype.connect=function(a){var b=this;a&&this.disconnect();this.inputManager=a;this.handlers.forEach(function(a,c){return b.inputManager.installHandlers(c,[a])})};a.prototype.disconnect=function(){var a=this;this.inputManager&&this.handlers.forEach(function(b,c){return a.inputManager.uninstallHandlers(c)});this.inputManager=null};a.prototype.destroy=function(){this.disconnect();this.handlers.clear();this.view=
null};a.prototype.register=function(a,b,c){var f=this,d=Array.isArray(a)?a:a.split(",");if(!g(d))return d.some(k)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;a=Array.isArray(b)?b:[];c=Array.isArray(b)?c:b;var h=this.createUniqueGroupName();b=new e(this.view,d,a,c);this.handlers.set(h,b);for(c=0;c<d.length;c++){a=d[c];var l=this.handlerCounts.get(a)||0;this.handlerCounts.set(a,l+1)}this.inputManager&&this.inputManager.installHandlers(h,
[b]);return{remove:function(){return f.removeHandler(h,d)}}};a.prototype.hasHandler=function(a){return!!this.handlerCounts.get(a)};a.prototype.removeHandler=function(a,b){if(this.handlers.has(a)){this.handlers.delete(a);for(var c=0;c<b.length;c++){var e=b[c],f=this.handlerCounts.get(e);void 0===f?console.error("Trying to remove handler for event that has no handlers registered: ",e):1===f?this.handlerCounts.delete(e):this.handlerCounts.set(e,f-1)}}this.inputManager&&this.inputManager.uninstallHandlers(a)};
a.prototype.createUniqueGroupName=function(){this.counter+=1;return"viewEvents_"+this.counter};return a}();m.ViewEvents=n;var e=function(b){function c(a,c,e,f){var d=b.call(this,!0)||this;d.view=a;for(a=0;a<c.length;a++)switch(c[a]){case "click":d.registerIncoming("click",e,function(a){return f(d.wrapClick(a))});break;case "double-click":d.registerIncoming("double-click",e,function(a){return f(d.wrapDoubleClick(a))});break;case "immediate-click":d.registerIncoming("immediate-click",e,function(a){return f(d.wrapImmediateClick(a))});
break;case "hold":d.registerIncoming("hold",e,function(a){return f(d.wrapHold(a))});break;case "drag":d.registerIncoming("drag",e,function(a){(a=d.wrapDrag(a))&&f(a)});break;case "key-down":d.registerIncoming("key-down",e,function(a){return f(d.wrapKeyDown(a))});break;case "key-up":d.registerIncoming("key-up",e,function(a){return f(d.wrapKeyUp(a))});break;case "pointer-down":d.registerIncoming("pointer-down",e,function(a){return f(d.wrapPointer(a,"pointer-down"))});break;case "pointer-move":d.registerIncoming("pointer-move",
e,function(a){return f(d.wrapPointer(a,"pointer-move"))});break;case "pointer-up":d.registerIncoming("pointer-up",e,function(a){return f(d.wrapPointer(a,"pointer-up"))});break;case "pointer-drag":d.registerIncoming("pointer-drag",e,function(a){return f(d.wrapPointerDrag(a))});break;case "mouse-wheel":d.registerIncoming("mouse-wheel",e,function(a){return f(d.wrapMouseWheel(a))});break;case "pointer-enter":d.registerIncoming("pointer-enter",e,function(a){return f(d.wrapPointer(a,"pointer-enter"))});
break;case "pointer-leave":d.registerIncoming("pointer-leave",e,function(a){return f(d.wrapPointer(a,"pointer-leave"))});break;case "gamepad":d.registerIncoming("gamepad",e,function(a){f(d.wrapGamepad(a))})}return d}h(c,b);c.prototype.wrapClick=function(b){var c=b.data,e=c.x,f=c.y;return{type:"click",pointerType:c.pointerType,button:c.button,buttons:c.buttons,x:e,y:f,native:c.native,timestamp:b.timestamp,screenPoint:new a(e,f),mapPoint:this.view.toMap(e,f),stopPropagation:function(){return b.stopPropagation()}}};
c.prototype.wrapDoubleClick=function(a){var b=a.data,c=b.x,e=b.y;return{type:"double-click",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:e,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,e),stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapImmediateClick=function(a){var b=a.data,c=b.x,e=b.y;return{type:"immediate-click",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:e,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,
e),stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapHold=function(a){var b=a.data,c=b.x,e=b.y;return{type:"hold",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:e,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,e),stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapDrag=function(a){var b=a.data,c=b.center,e=c.x,c=c.y,f=b.action,d=b.pointerType,g=b.button;"start"===f&&(this.latestDragStart=b);if(this.latestDragStart){var k=
b.pointer.native,h=b.buttons,p=a.timestamp,t={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};"end"===f&&(this.latestDragStart=void 0);return{type:"drag",action:f,x:e,y:c,origin:t,pointerType:d,button:g,buttons:h,radius:b.radius,angle:l.rad2deg(b.angle),native:k,timestamp:p,stopPropagation:function(){return a.stopPropagation()}}}};c.prototype.wrapKeyDown=function(a){var b=a.data;return{type:"key-down",key:b.key,repeat:b.repeat,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};
c.prototype.wrapKeyUp=function(a){var b=a.data;return{type:"key-up",key:b.key,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapPointer=function(a,b){var c=a.data,e=c.native;return{type:b,x:c.x,y:c.y,pointerId:e.pointerId,pointerType:e.pointerType,button:c.button,buttons:c.buttons,native:e,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapPointerDrag=function(a){var b=a.data.currentEvent;return{type:"pointer-drag",
x:b.x,y:b.y,pointerId:a.data.startEvent.native.pointerId,pointerType:a.data.startEvent.native.pointerType,button:a.data.startEvent.button,buttons:b.buttons,action:a.data.action,origin:{x:a.data.startEvent.x,y:a.data.startEvent.y},native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};c.prototype.wrapMouseWheel=function(a){var b=a.data;return{type:"mouse-wheel",x:b.x,y:b.y,deltaY:b.deltaY,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};
c.prototype.wrapGamepad=function(a){var b=a.data,c=b.state;return{type:"gamepad",device:b.device,timestamp:a.timestamp,action:b.action,buttons:c.buttons,axes:c.axes,stopPropagation:function(){return a.stopPropagation()}}};return c}(d.InputHandler)})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(){var d=a.call(this,
!0)||this;d.registerIncoming("context-menu",function(a){a.data.native.preventDefault()});return d}h(d,a);return d}(a.InputHandler);m.PreventContextMenu=n;m.default=n})},"esri/views/2d/layers/support/GraphicsView2D":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../Graphic ../../../../core/Collection ../../../../core/Handles ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject ../../engine/graphics/GFXSurface ../../../layers/GraphicsView".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t){return function(p){function t(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var f=p.apply(this,a)||this;f._frontGroup=new b;f._handles=new k;f._objects=new Map;f.container=new c;f.container.addChild(f._frontGroup);f.watch("graphics",function(){return f._reset()},!0);return f}h(t,p);t.prototype.hitTest=function(a,b){if(!this.view||!this.view.position)return null;a+=this.view.position[0]-window.pageXOffset;b+=this.view.position[1]-window.pageYOffset;
return(a=this.container.hitTest(a,b))?g.resolve(a.graphic):null};t.prototype.graphicUpdateHandler=function(a){var b=a.graphic,c=a.property;a=a.newValue;if(this._objects.has(b)){var e=this._objects.get(b);switch(c){case "geometry":e.graphic=b;break;case "symbol":e.renderingInfo={symbol:a};break;case "visible":e.visible=a}}};t.prototype._reset=function(){var a=this;this._handles.remove("graphics");this._objects.forEach(function(b,c){a._frontGroup.removeChild(b)});this._objects.clear();this.graphics&&
(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),"graphics"))};t.prototype._add=function(a){if(a&&!this._objects.has(a)){var b=new e;b.graphic=a;b.renderingInfo={symbol:a.symbol};this._objects.set(a,b);this._frontGroup.addChild(b)}};t.prototype._remove=function(a){var b=this._objects.get(a);b&&(this._objects.delete(a),this._frontGroup.removeChild(b))};t.prototype._graphicsChangeHandler=function(a){var b=a.added,c=a.removed;
a.moved.length&&this._reset();for(var e=0;e<b.length;e++)a=b[e],this._add(a);for(b=0;b<c.length;b++)a=c[b],this._remove(a)};a([f.property(),f.cast(d.ofType(l))],t.prototype,"graphics",void 0);a([f.property()],t.prototype,"view",void 0);return t=a([f.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(f.declared(t))})},"esri/views/2d/engine/graphics/GFXGroup":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/tsSupport/extendsHelper","../Container"],
function(n,m,h,a,l){return function(d){function k(){return null!==d&&d.apply(this,arguments)||this}a(k,d);k.prototype.attach=function(a){this.g=a.surface.createGroup();return d.prototype.attach.call(this,a)};k.prototype.detach=function(a){d.prototype.detach.call(this,a);this.g.destroy();this.g=null};k.prototype.prepareChildrenRenderParameters=function(a){return h({},a,{surface:this.g})};k.prototype.detachChild=function(a,f){return a.detach(f)};k.prototype.attachChild=function(a,f){return a.attach(f)};
k.prototype.renderChild=function(a,f){return a.processRender(f)};return k}(l)})},"esri/views/2d/engine/graphics/GFXObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../geometry ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/webMercatorUtils ../DisplayObject ./gfxUtils".split(" "),function(n,m,h,a,l,d,k,g){var f=new Set,b=[];return function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a._prevStateId=null;a.visible=
!0;return a}h(c,e);Object.defineProperty(c.prototype,"graphic",{get:function(){return this._graphic},set:function(a){this._geometry=(this._graphic=a)&&a.geometry||null;this._projected=null;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isPolygonMarkerSymbol",{get:function(){var a=this.renderingInfo.symbol.type,b=this.geometry;return b&&"polygon"===
b.type&&("simple-marker"===a||"picture-marker"===a||"text"===a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"renderingInfo",{get:function(){return this._renderingInfo},set:function(a){this._renderingInfo=a;this.requestRender()},enumerable:!0,configurable:!0});c.prototype.detach=function(){this._revokeShapeUrl();this._removeShape();this._drawInfo=this._projected=null};c.prototype.doRender=function(a){var b=this,c=a.surface,e=a.state,f=a.projector,d=this._prevStateId!==e.id;if(this.renderRequested||
d)if(d&&a.stationary&&(this._prevStateId=e.id),this.visible)if(d=this._projectGeometry(this.geometry,a.state.spatialReference),a=this._getScreenOffsets([],a.state),g.isShapeInvalid(this.renderingInfo.symbol,this._shape)&&this._removeShape(),a.length){var k=this._shape,h=d.type,l=this._shapePromise;l&&!l.isFulfilled()&&l.cancel();if(!k||this._showRedraw(a,e))l="point"===h?g.drawPoint(f,c,d,k,this.renderingInfo,e.rotation,a).then(function(a){g.stylePoint(a,b.renderingInfo);return a}):"multipoint"===
h?g.drawMarkers(f,c,d,k,this.renderingInfo,e.rotation,a,this).then(function(a){g.styleMarkers(a,b.renderingInfo);return a}):g.drawShape(f,c,d,k,a).then(function(a){g.styleShape(a,b.renderingInfo);return a});this._shapePromise=l.then(function(a){b._shape=a;a.getNode().gfxObject=b;return a})}else this._removeShape();else this._removeShape()};c.prototype._getScreenOffsets=function(a,c){var e=c.clippedExtent,d=this._projected.outExtent,g=c.spatialReference;a.length=0;if(!d)return a;if(g.isWrappable){var g=
l.getInfo(g),k=d.cache._partwise,e=e._getParts(g);b.length=0;if(k&&k.length)for(d=0;d<k.length;d++)b.push.apply(b,k[d]._getParts(g));else b.push.apply(b,d._getParts(g));c=c.worldScreenWidth;a.length=0;f.clear();d=b.length;for(g=0;g<d;g++)for(var h=b[g],k=h.extent,h=h.frameIds,p=h.length,m=e.length,t=0;t<m;t++){var n=e[t];if(n.extent.intersects(k))for(var w=p,H=0;H<w;H++){var E=(n.frameIds[0]-h[H])*c;f.has(E)||(a.push(E),f.add(E))}}a.sort()}else e.intersects(d)&&a.push(0);return a};c.prototype._projectGeometry=
function(a,b){var c=this._projected;a=this.isPolygonMarkerSymbol?a.centroid:a;if(c&&c.inGeometry===a&&c.outSpatialReference===b)return c.outGeometry;a&&a.spatialReference.equals(b)?this._projected={inGeometry:a,outGeometry:a,outSpatialReference:b,outExtent:this._getExtent(a)}:d.canProject(a,b)?this._projected={inGeometry:a,outGeometry:d.project(a,b),outSpatialReference:b,outExtent:this._getExtent(a)}:this._projected={inGeometry:a,outGeometry:null,outSpatialReference:b,outExtent:null};return this._projected.outGeometry};
c.prototype._getExtent=function(b){var c=b.extent;if(!c){var e=c=void 0;"esri.geometry.Point"===b.declaredClass?(c=b.x,e=b.y):"esri.geometry.Multipoint"===b.declaredClass&&(c=b.points[0][0],e=b.points[0][1]);c=new a.Extent(c,e,c,e,b.spatialReference)}return c};c.prototype._removeShape=function(){var a=this._shape;a&&(a.removeShape(),a.getNode().gfxObject=null,a.destroy());this._shape=this._drawInfo=null};c.prototype._revokeShapeUrl=function(){var a=this._shape;a&&(a=a.shape)&&"image"===a.type&&g.revokeBlobUrl(a.src)};
c.prototype._showRedraw=function(a,b){return!0};return c}(k)})},"esri/views/2d/engine/graphics/gfxUtils":function(){define("require exports ../../../../core/tsSupport/assignHelper @dojo/framework/shim/array @dojo/framework/shim/Map ../../../../Color ../../../../request ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/urlUtils ../../../../geometry/Polygon ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/support/gfxUtils ../../libs/gl-matrix/mat2d ../../libs/gl-matrix/mat2dExtras".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v){function r(a,b){if(!b)return null;b.toRgba?(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a):(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]);return a}function q(a,b,c){null!=c&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=c);return a}function u(a,b,c){var e=b[0]/b[1];a[0]=a[1]=1;isNaN(c)||(1<e?(a[0]=c/b[0],a[1]=c/e/b[1]):(a[1]=c/b[1],a[0]=c*e/b[0]));return a}function A(a,e,d,h,l,m,q){var r=l.symbol;d=a.toScreenPoint(F,d,q[0]);a=[d.x,d.y];var n=d.x,A=d.y;q=l.heading;d=l.size&&l.size[0];
var w,C;p.identity(D);"number"===typeof d&&(w=isFinite(d)&&d);w=(d=w&&isFinite(w)&&!isNaN(w))?f.pt2px(w):NaN;m&&v.rotategAt(D,D,m,a);q&&v.rotategAt(D,D,q,a);m=f.pt2px(r.xoffset);q=f.pt2px(r.yoffset);var J;if(0!==m||0!==q)J=[m,-q];var E=null;0!==r.angle&&(E=p.create(),v.rotategAt(E,E,r.angle,a));var M;if("simple-marker"===r.type){m=r.style;q=Math.round;w=d?w:f.pt2px(r.size);C=C=void 0;switch(m){case c.STYLE_SQUARE:case c.STYLE_CROSS:case c.STYLE_X:case c.STYLE_DIAMOND:C=isNaN(w)?16:.5*w;C=y(e,h,H(m,
n,A,q(n-C),q(n+C),q(A-C),q(A+C)));break;case c.STYLE_PATH:C=r=y(e,h,r.path);r=r.getBoundingBox();w=u(p.create(),[r.width,r.height],w);1===w[0]&&1===w[3]||v.scaleAt(D,D,w,a);M=[-(r.x+.5*r.width)+n,-(r.y+.5*r.height)+A];break;default:C=isNaN(w)?16:.5*w,C=x(e,h,{cx:n,cy:A,r:C})}C=g.resolve(C)}else if("picture-marker"===r.type){var P=null,K=null;a=f.pt2px(r.width);C=f.pt2px(r.height);d?(K=w,P=a/C*K):(P=a,K=C);J&&(null!=J[0]&&(J[0]=J[0]/a*P),null!=J[1]&&(J[1]=J[1]/C*K));var G=r.url,r=void 0,r=b.isDataProtocol(G)?
g.resolve(G):b.isBlobProtocol(G)?g.resolve(URL.createObjectURL(G)):I.has(G)?g.resolve(I.get(G)):k(G,{responseType:"blob"}).then(function(a){if(I.has(G))return I.get(G);a=URL.createObjectURL(a.data);I.set(G,a);return a}).catch(function(a){if("cancel"!==a.dojoType)return G;g.reject(a)});C=r.then(function(a){a=z(e,h,{x:n-.5*P,y:A-.5*K,width:P,height:K,src:a});var b=a.getNode();b&&(null!=l.opacity?b.setAttribute("opacity",l.opacity.toString()):b.setAttribute("opacity","1"));return a})}else if("text"===
r.type){if(a=r.font&&r.font.clone())a.size=d?w:f.pt2px(a.size);C=B(e,h,{type:"text",text:r.text,x:n,y:A,align:t.getSVGAlign(r),decoration:r.decoration||a&&a.decoration,rotated:r.rotated,kerning:r.kerning});a&&C.setFont(a);w=C.getNode();a=t.getSVGBaseline(r);r=t.getSVGBaselineShift(r);w&&(w.setAttribute("dominant-baseline",a),r&&w.setAttribute("baseline-shift",r));C=g.resolve(C)}return C.then(function(a){J&&p.translate(D,D,J);E&&p.multiply(D,D,E);M&&p.translate(D,D,M);a.setTransform(D);return a})}
function z(a,b,c){return b?b.setShape(c):a.createImage(c)}function x(a,b,c){return b?b.setShape(c):a.createCircle(c)}function y(a,b,c){c=Array.isArray(c)?c.join(" "):c;return b?b.setShape(c):a.createPath(c)}function B(a,b,c){return b?b.setShape(c):a.createText(c)}function w(a,b){b=b&&b.shape&&b.shape.type;var c=a&&a.type;a=a&&a.style;c&&(a=Q[c]||a);N[a]&&(a="path");return!(!b||!a||b===a)}function H(a,b,e,f,d,g,k,h){switch(a){case c.STYLE_SQUARE:return["M",f+","+g,d+","+g,d+","+k,f+","+k,"Z"];case c.STYLE_CROSS:return["M",
b+","+g,b+","+k,"M",f+","+e,d+","+e];case c.STYLE_X:return["M",f+","+g,d+","+k,"M",f+","+k,d+","+g];case c.STYLE_DIAMOND:return["M",b+","+g,d+","+e,b+","+k,f+","+e,"Z"];case c.STYLE_TARGET:return["M",f+","+g,d+","+g,d+","+k,f+","+k,f+","+g,"M",f-h+","+e,f+","+e,"M",b+","+(g-h),b+","+g,"M",d+h+","+e,d+","+e,"M",b+","+(k+h),b+","+k]}}function E(a,b){var e=b.symbol;if("picture-marker"!==e.type){var f=t.getFill(e);if("simple-marker"===e.type){var d=e.style,g=(e=t.getStroke(e))&&e.color,d=d===c.STYLE_X||
d===c.STYLE_CROSS,k=b.opacity;(b=b.color||r([0,0,0,0],d?g:f))&&null!=k&&(b=q([0,0,0,0],b,k));b&&(d?b!==g&&(e=h({},e),e.color=b):b!==f&&(f=b));a.setFill(f).setStroke(e)}else"text"===e.type&&(k=b.opacity,(b=b.color||r([0,0,0,0],f))&&null!=k&&(b=q([0,0,0,0],b,k)),b&&b!==f&&(f=b),a.setFill(f))}}Object.defineProperty(m,"__esModule",{value:!0});var I=new l.default;m.getScalingVector=u;var F={x:0,y:0},D=p.create();m.drawPoint=A;m.drawMarkers=function(a,b,c,e,f,d,k,h){var l=f.symbol,p=c.points,m=e||b.createGroup();
b=[0];m.children[0]&&w(l,m.children[0])&&m.clear();l=0;c=[];e=p.length;for(var q=0;q<e;q++)for(var t=p[q],r=k.length,n=0;n<r;n++)b[0]=k[n],c.push(A(a,m,{x:t[0],y:t[1]},m.children[l++],f,d,b));return g.all(c).then(function(a){a.forEach(function(a){a.getNode().gfxObject=h;m.add(a)});var b=m.children.length;if(p.length*k.length<b)for(a=p.length*k.length,--b;b>=a;b--)m.children[b].removeShape();return m})};m.drawShape=function(a,b,c,f,d){var k=[];"extent"===c.type&&(c=e.fromExtent(c));if("polyline"===
c.type||"polygon"===c.type){for(var h=d.length,l=0;l<h;l++)k=k.concat(a.toScreenPath(c,d[l]));f=y(b,f,k)}return g.resolve(f)};m.drawRect=function(a,b,c){return b?b.setShape(c):a.createRect(c)};m.drawImage=z;m.drawCircle=x;m.drawPath=y;m.drawText=B;var Q={"picture-marker":"image","picture-fill":"path","simple-fill":"path","simple-line":"path",text:"text"},N={square:1,cross:1,x:1,diamond:1,target:1};m.isShapeInvalid=w;m.smsToPath=H;m.stylePoint=E;m.styleMarkers=function(a,b){for(var c=a.children.length,
e=0;e<c;e++)E(a.children[e],b)};m.styleShape=function(a,b){var c=b.symbol,e=b.size,g=b.color,k=b.opacity,l=b.outlineSize;b=t.getStroke(c);var p=t.getFill(c),m=!1,n;"simple-line"===c.type?(m=!0,n="none"!==c.style):n=c.outline&&"none"!==c.outline.style;var u,v,z;if(null!=e||null!=l)if(e=e&&isFinite(e[0])&&e[0],l=m?null:l,null!=e||null!=l)z=f.pt2px(l||e);e="picture-fill"===c.type;!g&&null==k||e||(m?(u=g||b&&b.color&&r([0,0,0,0],b.color))&&null!=k&&(u=q(u,u,k)):p&&(v=g||r([0,0,0,0],p))&&null!=k&&(v=q(v,
v,k)));!n||null==z&&!u?a.setStroke(b):a.setStroke(h({},b,null!=z?{width:z}:null,u&&{color:u}));c=g&&new d(g)||c.color;p&&"pattern"===p.type&&c&&!e?t.getPatternUrlWithColor(p.src,c.toCss(!0)).then(function(b){p.src=b;a.setFill(p)}):a.setFill(v||p);a.rawNode.setAttribute("vector-effect","non-scaling-stroke")};m.revokeBlobUrl=function(c){if(c&&b.isBlobProtocol(c)){for(var e=0,f=a.from(I);e<f.length;e++){var d=f[e],g=d[0];if(d[1]===c){I.delete(g);break}}URL.revokeObjectURL(c)}}})},"@dojo/framework/shim/array":function(){(function(n){"object"===
typeof module&&"object"===typeof module.exports?(n=n(require,exports),void 0!==n&&(module.exports=n)):"function"===typeof define&&define.amd&&define("require exports tslib ./global ./iterator ./number ./support/has ./support/util".split(" "),n)})(function(n,m){Object.defineProperty(m,"__esModule",{value:!0});var h=n("tslib"),a=n("./global"),l=n("./iterator"),d=n("./number"),k=n("./support/has");n=n("./support/util");if(k.default("es6-array")&&k.default("es6-array-fill"))m.from=a.default.Array.from,
m.of=a.default.Array.of,m.copyWithin=n.wrapNative(a.default.Array.prototype.copyWithin),m.fill=n.wrapNative(a.default.Array.prototype.fill),m.find=n.wrapNative(a.default.Array.prototype.find),m.findIndex=n.wrapNative(a.default.Array.prototype.findIndex);else{var g=function(a){if(isNaN(a))return 0;a=Number(a);isFinite(a)&&(a=Math.floor(a));return Math.min(Math.max(a,0),d.MAX_SAFE_INTEGER)},f=function(a){a=Number(a);return isNaN(a)?0:0!==a&&isFinite(a)?(0<a?1:-1)*Math.floor(Math.abs(a)):a},b=function(a,
b){return 0>a?Math.max(b+a,0):Math.min(a,b)};m.from=function(a,b,f){if(null==a)throw new TypeError("from: requires an array-like object");b&&f&&(b=b.bind(f));f=g(a.length);var c="function"===typeof this?Object(new this(f)):Array(f);if(!l.isArrayLike(a)&&!l.isIterable(a))return c;if(l.isArrayLike(a)){if(0===f)return[];for(var e=0;e<a.length;e++)c[e]=b?b(a[e],e):a[e]}else{e=0;try{for(var d=h.__values(a),k=d.next();!k.done;k=d.next()){var m=k.value;c[e]=b?b(m,e):m;e++}}catch(x){t={error:x}}finally{try{k&&
!k.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error;}}}void 0!==a.length&&(c.length=f);return c;var t,n};m.of=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return Array.prototype.slice.call(a)};m.copyWithin=function(a,c,d,k){if(null==a)throw new TypeError("copyWithin: target must be an array-like object");var e=g(a.length);c=b(f(c),e);d=b(f(d),e);k=b(void 0===k?e:f(k),e);k=Math.min(k-d,e-c);e=1;c>d&&c<d+k&&(e=-1,d+=k-1,c+=k-1);for(;0<k;)d in a?a[c]=a[d]:delete a[c],
c+=e,d+=e,k--;return a};m.fill=function(a,c,d,k){var e=g(a.length);d=b(f(d),e);for(k=b(void 0===k?e:f(k),e);d<k;)a[d++]=c;return a};m.find=function(a,b,f){b=m.findIndex(a,b,f);return-1!==b?a[b]:void 0};m.findIndex=function(a,b,f){var c=g(a.length);if(!b)throw new TypeError("find: second argument must be a function");f&&(b=b.bind(f));for(f=0;f<c;f++)if(b(a[f],f,a))return f;return-1}}k.default("es7-array")?m.includes=n.wrapNative(a.default.Array.prototype.includes):m.includes=function(a,b,f){void 0===
f&&(f=0);var c;c=a.length;c=Number(c);isNaN(c)?c=0:(isFinite(c)&&(c=Math.floor(c)),c=Math.min(Math.max(c,0),d.MAX_SAFE_INTEGER));for(;f<c;++f){var e=a[f];if(b===e||b!==b&&e!==e)return!0}return!1}})},"@dojo/framework/shim/number":function(){(function(n){"object"===typeof module&&"object"===typeof module.exports?(n=n(require,exports),void 0!==n&&(module.exports=n)):"function"===typeof define&&define.amd&&define(["require","exports","./global"],n)})(function(n,m){function h(a){return"number"===typeof a&&
l.default.isFinite(a)}function a(a){return h(a)&&Math.floor(a)===a}Object.defineProperty(m,"__esModule",{value:!0});var l=n("./global");m.EPSILON=1;m.MAX_SAFE_INTEGER=Math.pow(2,53)-1;m.MIN_SAFE_INTEGER=-m.MAX_SAFE_INTEGER;m.isNaN=function(a){return"number"===typeof a&&l.default.isNaN(a)};m.isFinite=h;m.isInteger=a;m.isSafeInteger=function(d){return a(d)&&Math.abs(d)<=m.MAX_SAFE_INTEGER}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../core/tsSupport/assignHelper dojox/gfx/_base ../../Color ../../request ../../core/LRUMap ../../core/promiseUtils ../../core/screenUtils".split(" "),
function(n,m,h,a,l,d,k,g,f){function b(a){if(!a)return null;var c,e=a.constructor,d=f.pt2px(a.width);switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":c=b(a.outline);break;case "simple-line":a.style!==e.STYLE_NULL&&0!==d&&(c={color:a.color,style:v(a.style),width:d,cap:a.cap,join:a.join===e.JOIN_MITER?f.pt2px(a.miterLimit):a.join});break;default:c=null}return c}Object.defineProperty(m,"__esModule",{value:!0});var e=n.toUrl("../../symbols/patterns/"),c={left:"start",center:"middle",
right:"end",justify:"start"},t={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},p=new k(1E3);m.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&c[a.toLowerCase()]||"middle"};m.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&t[a.toLowerCase()]||"alphabetic"};m.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};m.getFill=function(b){var c=b.style,d=null;if(b){var g=b.constructor;switch(b.type){case "simple-marker":c!==
g.STYLE_CROSS&&c!==g.STYLE_X&&(d=b.color);break;case "simple-fill":c===g.STYLE_SOLID?d=b.color:c!==g.STYLE_NULL&&(d=h({},a.defaultPattern,{src:e+c+".png",width:8,height:8}));break;case "picture-fill":d=h({},a.defaultPattern,{src:b.url,width:f.pt2px(b.width)*b.xscale,height:f.pt2px(b.height)*b.yscale,x:f.pt2px(b.xoffset),y:f.pt2px(b.yoffset)});break;case "text":d=b.color}}return d};m.getPatternUrlWithColor=function(a,b){var c=a+"-"+b;return p.has(c)?g.resolve(p.get(c)):d(a,{responseType:"image"}).then(function(a){a=
a.data;var e=a.naturalWidth,f=a.naturalHeight,d=document.createElement("canvas");d.width=e;d.height=f;var g=d.getContext("2d");g.fillStyle=b;g.fillRect(0,0,e,f);g.globalCompositeOperation="destination-in";g.drawImage(a,0,0);a=d.toDataURL();p.set(c,a);return a})};m.getStroke=b;m.create2DColorRamp=function(a){var b=a.colors,c=a.numClasses,e=a.size;a=a.surface.createGroup();for(var e=(e||75)/c,f=0;f<c;f++)for(var d=f*e,g=0;g<c;g++){var k=b[f][g];a.createRect({x:g*e,y:d,width:e,height:e}).setFill(k).setStroke(null)}return a};
var v=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();m.defaultThematicColor=new l([128,128,128])})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(n,m,h,a,l,d,k,g,f){var b=m.getObject("dojox.gfx",!0),e=b._base={};b._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+
a+" ").indexOf(" "+b+" ")};b._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};b._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};e._getFontMeasurements=function(){var b={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,e;a("ie")&&(e=l.doc.documentElement.style.fontSize||
"",e||(l.doc.documentElement.style.fontSize="100%"));var f=g.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},l.body());for(c in b)f.style.fontSize=c,b[c]=16*Math.round(12*f.offsetHeight/16)/12/1E3;a("ie")&&(l.doc.documentElement.style.fontSize=e);l.body().removeChild(f);return b};var c=null;e._getCachedFontMeasurements=function(a){if(a||!c)c=e._getFontMeasurements();
return c};var t=null,p={};e._getTextBox=function(a,b,c){var e,d,k=arguments.length,h;t||(t=g.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},l.body()));e=t;e.className="";d=e.style;d.borderWidth="0";d.margin="0";d.padding="0";d.outline="0";if(1<k&&b)for(h in b)h in p||(d[h]=b[h]);2<k&&c&&(e.className=c);e.innerHTML=a;e.getBoundingClientRect?(d=e.getBoundingClientRect(),d={l:d.left,t:d.top,w:d.width||d.right-d.left,h:d.height||d.bottom-d.top}):d=f.getMarginBox(e);
e.innerHTML="";return d};e._computeTextLocation=function(a,b,c,e){var f={};switch(a.align){case "end":f.x=a.x-b;break;case "middle":f.x=a.x-b/2;break;default:f.x=a.x}f.y=a.y-c*(e?.75:1);return f};e._computeTextBoundingBox=function(a){if(!b._base._isRendered(a))return{x:0,y:0,width:0,height:0};var c;c=a.getShape();var f=a.getFont()||b.defaultFont;a=a.getTextWidth();f=b.normalizedLength(f.size);c=e._computeTextLocation(c,a,f,!0);return{x:c.x,y:c.y,width:a,height:f}};e._isRendered=function(a){for(a=
a.parent;a&&a.getParent;)a=a.parent;return null!==a};var v=0;e._getUniqueId=function(){var a;do a=n._scopeName+"xUnique"+ ++v;while(k.byId(a));return a};var r=a("pointer-events")?"touchAction":null;e._fixMsTouchAction=r?function(a){a.rawNode.style[r]="none"}:function(){};m.mixin(b,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",
cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,
color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(c){var e=a[c];if(e)return new e;e=a[c]=new Function;e.prototype=b["default"+c];return new e}}(),normalizeColor:function(a){return a instanceof h?a:new h(a)},normalizeParameters:function(a,
b){var c;if(b){var e={};for(c in a)c in b&&!(c in e)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return m.delegate(a);var e={};for(c in a)c in e||(e[c]=m.clone(c in b?b[c]:a[c]));return e},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var e=c.indexOf(".");0<=e&&5<c.length-e&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=
b.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var e=a[3].indexOf("/");c.size=0>e?a[3]:a[3].substring(0,e);var f=4;0>e&&("/"==a[4]?f=6:"/"==a[4].charAt(0)&&(f=5));f<a.length&&(c.family=a.slice(f).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return b._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*b.px_in_pt()},px2pt:function(a){return a/b.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;
if(2<a.length){var c=b.px_in_pt(),e=parseFloat(a);switch(a.slice(-2)){case "px":return e;case "pt":return e*c;case "in":return 72*e*c;case "pc":return 12*e*c;case "mm":return e*b.mm_in_pt*c;case "cm":return e*b.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var c="string"==typeof a?b[a]:a;c&&(d.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),
function(a){b[a]=c[a]}),"string"==typeof a?b.renderer=a:d.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return b.renderer=b[a]&&b[a].Surface===b.Surface?a:null}))}});return b})},"esri/views/2d/libs/gl-matrix/mat2dExtras":function(){define(["require","exports","./common","./mat2d","./vec2"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});var d=function(){var d=a.create(),g=l.create();return function(f,b,e){a.fromTranslation(d,e);a.multiply(f,d,b);l.negate(g,
e);a.translate(f,f,g);return f}}();m.rotategAt=function(){var k=a.create();return function(g,f,b,e){a.fromRotation(k,h.toRadian(b));d(k,k,e);a.multiply(g,k,f);return g}}();m.scaleAt=function(){var k=a.create();return function(g,f,b,e){a.fromScaling(k,b);d(k,k,e);a.multiply(g,k,f);return g}}()})},"esri/views/2d/engine/graphics/GFXSurface":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../viewpointUtils ../Container ../cssUtils ./Projector ../../libs/gfx ../../libs/gl-matrix/common ../../libs/gl-matrix/mat2d".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e){var c=e.identity(e.create());return function(d){function p(){var a=null!==d&&d.apply(this,arguments)||this;a._transform=e.create();a._projector=new g;a._prevStateId=null;return a}h(p,d);p.prototype.createElement=function(){var a=document.createElement("div");a.setAttribute("class","esri-display-object");return a};p.prototype.setElement=function(a){this.surface&&(this.surface.destroy(),this.surface=null);if(this.element=a)this.surface=f.createSurface(this.element,400,
400)};p.prototype.doRender=function(a){var f=this.element.style;if(this.visible){f.display="block";f.opacity=""+Math.min(this.opacity,this.parent.opacity);var g=this._transform,h=a.state,p=this._prevStateId!==h.id;if(this.renderRequested||p){if(a.stationary)p&&(this._prevStateId=h.id),l.getMatrix(g,h.center,h.size,h.resolution,b.toRadian(h.rotation),1),this.surface.setDimensions(h.size[0],h.size[1]),this._projector.update(g,h.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(c)}),
d.prototype.doRender.call(this,a);else{var m=e.invert(e.create(),g);e.multiply(m,h.transform,m);this.children.forEach(function(a){a.g&&a.g.setTransform(m)})}k.clip(f,h.clipRect);f.transform=k.cssMatrix3d(e.fromRotation(e.create(),b.toRadian(h.rotation)));this.surface.rawNode.style.transform=k.cssMatrix(e.fromRotation(e.create(),b.toRadian(-h.rotation)))}}else f.display="none"};p.prototype.hitTest=function(a,b){if(!this.attached)return null;var c=this.surface.rawNode,c=c.parentElement||c.parentNode;
c.style.zIndex="9000";a=document.elementFromPoint(a,b);c.style.zIndex="";return a&&a.gfxObject||null};p.prototype.prepareChildrenRenderParameters=function(b){return a({},b,{projector:this._projector,surface:this.surface})};p.prototype.beforeRenderChildren=function(a,b){this.surface.openBatch()};p.prototype.attachChild=function(a,b){return a.attach(b)};p.prototype.detachChild=function(a,b){return a.detach()};p.prototype.renderChild=function(a,b){return a.processRender(b)};p.prototype.afterRenderChildren=
function(a,b){this.surface.closeBatch()};return p}(d)})},"esri/views/2d/engine/cssUtils":function(){define(["require","exports","../../../core/has"],function(n,m,h){function a(a){return"matrix3d(\n                    "+a[0].toFixed(10)+", "+a[1].toFixed(10)+", 0, 0,\n                    "+a[2].toFixed(10)+", "+a[3].toFixed(10)+", 0, 0,\n                    0, 0, 1, 0,\n                    "+Math.round(a[4]).toFixed(10)+", "+Math.round(a[5]).toFixed(10)+", 0, 1\n                  )"}function l(a){return"translate("+
Math.round(a[0])+"px, "+Math.round(a[1])+"px)"}function d(a){return"rotateZ( "+a+" deg)"}Object.defineProperty(m,"__esModule",{value:!0});n=h("ff");var k=h("ie"),g=h("webkit");h=h("opera");var f=g&&"-webkit-transform"||n&&"-moz-transform"||h&&"-o-transform"||k&&"-ms-transform"||"transform";m.clip=function(a,e){a.clip=e?"rect( "+e.top+"px, "+e.right+"px, "+e.bottom+"px, "+e.left+"px)":""};m.setTransform=function(b,e){var c=null;2===e.length&&(c=l(e));6===e.length&&(c=a(e));b.transform=b[f]=c};m.setOrigin=
function(a,e){a.transformOrigin=e[0]+"px "+e[1]+"px 0"};m.cssMatrix=function(a){return"matrix(\n                  "+a[0].toFixed(10)+", "+a[1].toFixed(10)+",\n                  "+a[2].toFixed(10)+", "+a[3].toFixed(10)+",\n                  "+a[4]+", "+a[5]+"\n                )"};m.cssMatrix3d=a;m.translate=l;m.rotate=function(a){return d(a.toFixed(3))};m.rotateZ=d})},"esri/views/2d/engine/graphics/Projector":function(){define(["require","exports"],function(n,m){function h(a,g,f,b,e){void 0===b&&(b=
0);void 0===e&&(e=a.length);for(var c=a[b],k=a[e-1],p=0,m=0,n,q=b+1;q<e-1;q++){var u=a[q];n=u[0];var u=u[1],A=c[0],z=c[1],x=k[0],y=k[1];A===x?n=l(n-A):(x=(y-z)/(x-A),n=l(x*n-u+(z-x*A))/d(x*x+1));n>p&&(m=q,p=n)}p>g?(h(a,g,f,b,m+1),h(a,g,f,m,e)):(f(c[0],c[1]),f(k[0],k[1]))}var a=Math.round,l=Math.abs,d=Math.sqrt;return function(){function d(){this._transform=null}d.prototype.update=function(a,f){this._transform=a;this._resolution=f};d.prototype.toScreenPoint=function(a,f,b){this.transformPoint(f.x+
b*this._resolution,f.y,function(b,c){a.x=b;a.y=c});return a};d.prototype.toScreenPath=function(a,f){var b=this,e=null!=a.paths;a=e?a.paths:a.rings;var c="",d=function(a,e){a+=f*b._resolution;b.transformPoint(a,e,function(a,b){isNaN(a)||isNaN(b)||(c+=a,c+=",",c+=b,c+=" ")})};if(a)for(var g=a.length,k=0;k<g;k++)c+="M ",h(a[k],this._resolution,d),e||(c+="Z ");return c};d.prototype.transformPoint=function(d,f,b){var e=this._transform,c=e[1],g=e[3],k=e[5];b(a(e[0]*d+e[2]*f+e[4]),a(c*d+g*f+k))};return d}()})},
"esri/views/2d/libs/gfx":function(){define("require exports ./gfx/Circle ./gfx/Group ./gfx/Image ./gfx/Path ./gfx/Rect ./gfx/Shape ./gfx/Surface ./gfx/svgSurface ./gfx/Text".split(" "),function(n,m,h,a,l,d,k,g,f,b,e){Object.defineProperty(m,"__esModule",{value:!0});m.Circle=h.default;m.Group=a.default;m.Image=l.default;m.Path=d.default;m.Rect=k.default;m.Shape=g.default;m.Surface=f.default;m.createSurface=b.createSurface;m.Text=e.default})},"esri/views/2d/libs/gfx/Circle":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","dojox/gfx/_base","./Shape"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(d){function k(g){var f=d.call(this)||this;f.shape=a.getDefault("Circle");f.rawNode=g;return f}h(k,d);k.prototype.getBoundingBox=function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox};k.nodeType="circle";return k}(l.default);m.default=n})},"esri/views/2d/libs/gfx/Shape":function(){define("require exports dojo/dom dojo/dom-attr dojo/_base/Color dojox/gfx/_base ./svg ../gl-matrix/mat2d".split(" "),
function(n,m,h,a,l,d,k,g){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function f(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null}f.prototype.destroy=function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");(a=k.getRef(a))&&a.parentNode.removeChild(a)}this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null};f.prototype.getNode=function(){return this.rawNode};
f.prototype.getShape=function(){return this.shape};f.prototype.getTransform=function(){return this.matrix};f.prototype.getFill=function(){return this.fillStyle};f.prototype.getStroke=function(){return this.strokeStyle};f.prototype.getParent=function(){return this.parent};f.prototype.getBoundingBox=function(){return this.bbox};f.prototype.setTransform=function(a){this.matrix=this.matrix?g.copy(this.matrix,a):g.clone(a);return this._applyTransform()};f.prototype.setFill=function(a){if(!a)return this.fillStyle=
null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b;if("object"===typeof a&&"type"in a){switch(a.type){case "linear":b=d.makeParameters(d.defaultLinearGradient,a);a=this._setFillObject(b,"linearGradient");a.setAttribute("x1",b.x1.toFixed(8));a.setAttribute("y1",b.y1.toFixed(8));a.setAttribute("x2",b.x2.toFixed(8));a.setAttribute("y2",b.y2.toFixed(8));break;case "radial":b=d.makeParameters(d.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");
a.setAttribute("cx",b.cx.toFixed(8));a.setAttribute("cy",b.cy.toFixed(8));a.setAttribute("r",b.r.toFixed(8));break;case "pattern":b=d.makeParameters(d.defaultPattern,a),a=this._setFillObject(b,"pattern"),a.setAttribute("x",b.x.toFixed(8)),a.setAttribute("y",b.y.toFixed(8)),a.setAttribute("width",b.width.toFixed(8)),a.setAttribute("height",b.height.toFixed(8))}this.fillStyle=b;return this}this.fillStyle=b=d.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());this.rawNode.setAttribute("fill-opacity",
b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this};f.prototype.setStroke=function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"===typeof a||Array.isArray(a)||a instanceof l)a={color:a};a=this.strokeStyle=d.makeParameters(d.defaultStroke,a);a.color=d.normalizeColor(a.color);if(a){var c=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",a.color.a);
b.setAttribute("stroke-width",c);b.setAttribute("stroke-linecap",a.cap);"number"===typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var f=a.style.toLowerCase();f in k.dasharray&&(f=k.dasharray[f]);if(Array.isArray(f)){for(var f=f.slice(0),g=0;g<f.length;++g)f[g]*=c;if("butt"!==a.cap){for(g=0;g<f.length;g+=2)f[g]-=c,1>f[g]&&(f[g]=1);for(g=1;g<f.length;g+=2)f[g]+=c}f=f.join(",")}b.setAttribute("stroke-dasharray",
f);b.setAttribute("dojoGfxStrokeStyle",a.style)}return this};f.prototype._getParentSurface=function(){for(var a=this.parent;a&&!a.defNode;a=a.parent);return a};f.prototype._setFillObject=function(a,e){var b=k.xmlns.svg;this.fillStyle=a;var f=this._getParentSurface().defNode,g=this.rawNode.getAttribute("fill");if(g=k.getRef(g))if(g.tagName.toLowerCase()!==e.toLowerCase()){var h=g.id;g.parentNode.removeChild(g);g=k._createElementNS(b,e);g.setAttribute("id",h);f.appendChild(g)}else for(;g.childNodes.length;)g.removeChild(g.lastChild);
else g=k._createElementNS(b,e),g.setAttribute("id",d._base._getUniqueId()),f.appendChild(g);if("pattern"===e)g.setAttribute("patternUnits","userSpaceOnUse"),b=k._createElementNS(b,"image"),b.setAttribute("x",0),b.setAttribute("y",0),b.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),b.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),k._setAttributeNS(b,k.xmlns.xlink,"xlink:href",a.src),g.appendChild(b);else for(g.setAttribute("gradientUnits","userSpaceOnUse"),e=0;e<a.colors.length;++e){var f=
a.colors[e],h=k._createElementNS(b,"stop"),l=f.color=d.normalizeColor(f.color);h.setAttribute("offset",f.offset.toFixed(8));h.setAttribute("stop-color",l.toCss());h.setAttribute("stop-opacity",l.a);g.appendChild(h)}this.rawNode.setAttribute("fill","url(#"+g.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return g};f.prototype._applyTransform=function(){var a=this.matrix;a?this.rawNode.setAttribute("transform","matrix("+a[0].toFixed(8)+
","+a[1].toFixed(8)+","+a[2].toFixed(8)+","+a[3].toFixed(8)+","+a[4].toFixed(8)+","+a[5].toFixed(8)+")"):this.rawNode.removeAttribute("transform");return this};f.prototype.setRawNode=function(a){a=this.rawNode=a;"image"!==this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",
4);a.__gfxObject__=this};f.prototype.setShape=function(a){this.shape=d.makeParameters(this.shape,a);for(var b in this.shape)if("type"!==b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this};f.prototype._moveToFront=function(){this.rawNode.parentNode.appendChild(this.rawNode);return this};f.prototype._moveToBack=function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this};f.prototype._removeClipNode=
function(){var b,e=a.get(this.rawNode,"clip-path");e&&(b=h.byId(e.match(/gfx_clip[\d]+/)[0]))&&b.parentNode.removeChild(b);return b};f.prototype.moveToFront=function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this};f.prototype.moveToBack=function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this};f.prototype.removeShape=function(a){this.parent&&this.parent.remove(this,a);return this};f.prototype._setParent=function(a,e){this.parent=
a;return this._updateParentMatrix(e)};f.prototype._updateParentMatrix=function(a){this.parentMatrix=a?g.clone(a):null;return this._applyTransform()};f.prototype._getRealMatrix=function(){for(var a=g.clone(this.matrix||g.create()),e=this.parent;e;)e.matrix&&a&&g.multiply(a,e.matrix,a),e=e.parent;return a};return f}();m.default=n})},"esri/views/2d/libs/gfx/svg":function(){define(["require","exports","dojo/dom"],function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});m.xmlns={xlink:"http://www.w3.org/1999/xlink",
svg:"http://www.w3.org/2000/svg"};m.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};m._createElementNS=function(a,h){return document.createElementNS?document.createElementNS(a,h):document.createElement(h)};m._setAttributeNS=function(a,h,d,k){return a.setAttributeNS?a.setAttributeNS(h,d,k):a.setAttribute(d,k)};m._createTextNode=function(a){return document.createTextNode(a)};
m._createFragment=function(){return document.createDocumentFragment()};m.getRef=function(a){return a&&"none"!==a?a.match(/^url\(#.+\)$/)?h.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?h.byId(a.slice(1)):null:null}})},"esri/views/2d/libs/gfx/Group":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base ./Circle ./Container ./Image ./Path ./Rect ./svg ./Text".split(" "),function(n,m,h,a,l,d,k,g,f,b,e){Object.defineProperty(m,"__esModule",{value:!0});n=function(c){function d(){return null!==
c&&c.apply(this,arguments)||this}h(d,c);d.prototype.setRawNode=function(a){this.rawNode=a;this.rawNode.__gfxObject__=this};d.prototype.destroy=function(){c.prototype.clear.call(this,!0);c.prototype.destroy.call(this)};d.prototype.createShape=function(b){switch(b.type){case a.defaultPath.type:return this.createPath(b);case a.defaultRect.type:return this.createRect(b);case a.defaultCircle.type:return this.createCircle(b);case a.defaultImage.type:return this.createImage(b);case a.defaultText.type:return this.createText(b)}console.error("[gfx] unknown shape",
b);return null};d.prototype.createGroup=function(){return this.createObject(d)};d.prototype.createRect=function(a){return this.createObject(f.default,a)};d.prototype.createCircle=function(a){return this.createObject(l.default,a)};d.prototype.createImage=function(a){return this.createObject(k.default,a)};d.prototype.createText=function(a){return this.createObject(e.default,a)};d.prototype.createPath=function(a){return this.createObject(g.default,a)};d.prototype.createObject=function(a,c){if(!this.rawNode)return null;
var e=new a;a=b._createElementNS(b.xmlns.svg,a.nodeType);e.setRawNode(a);e.setShape(c);this.add(e);return e};d.nodeType="g";return d}(d.default);m.default=n})},"esri/views/2d/libs/gfx/Container":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/matrix ./Shape ./svg".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});n=function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a.children=[];a._batch=0;return a}h(g,k);g.prototype.openBatch=
function(){this._batch||(this.fragment=d._createFragment());++this._batch;return this};g.prototype.closeBatch=function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),this.fragment=null);return this};g.prototype.add=function(a){if(this===a.getParent())return this;this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode);var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);a._setParent(this,this._getRealMatrix());
return this};g.prototype.remove=function(a,b){void 0===b&&(b=!1);if(this!==a.getParent())return this;this.rawNode===a.rawNode.parentNode&&this.rawNode.removeChild(a.rawNode);this.fragment&&this.fragment===a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode);for(var e=0;e<this.children.length;++e)if(this.children[e]===a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(e,1);break}return this};g.prototype.clear=function(a){void 0===a&&(a=!1);for(var b=this.rawNode;b.lastChild;)b.removeChild(b.lastChild);
var e=this.defNode;if(e){for(;e.lastChild;)e.removeChild(e.lastChild);b.appendChild(e)}for(e=0;e<this.children.length;++e)b=this.children[e],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this};g.prototype.getBoundingBox=function(){if(!this.children)return null;var f=null;this.children.forEach(function(b){var e=b.getBoundingBox();e&&((b=b.getTransform())&&(e=a.multiplyRectangle(b,e)),f?(f.x=Math.min(f.x,e.x),f.y=Math.min(f.y,e.y),f.endX=Math.max(f.endX,e.x+e.width),f.endY=
Math.max(f.endY,e.y+e.height)):f={x:e.x,y:e.y,endX:e.x+e.width,endY:e.y+e.height,width:0,height:0})});f&&(f.width=f.endX-f.x,f.height=f.endY-f.y);return f};g.prototype._moveChildToFront=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===a){this.children.splice(b,1);this.children.push(a);break}return this};g.prototype._moveChildToBack=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===a){this.children.splice(b,1);this.children.unshift(a);break}return this};
return g}(l.default);m.default=n})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(n,m){var h=n.matrix={},a={};h._degToRad=function(h){return a[h]||(a[h]=Math.PI*h/180)};h._radToDeg=function(a){return a/Math.PI*180};h.Matrix2D=function(a){if(a)if("number"==typeof a)this.xx=this.yy=a;else if(a instanceof Array){if(0<a.length){for(var d=h.normalize(a[0]),k=1;k<a.length;++k){var g=d,f=h.normalize(a[k]),d=new h.Matrix2D;d.xx=g.xx*f.xx+g.xy*f.yx;d.xy=g.xx*f.xy+g.xy*f.yy;d.yx=
g.yx*f.xx+g.yy*f.yx;d.yy=g.yx*f.xy+g.yy*f.yy;d.dx=g.xx*f.dx+g.xy*f.dy+g.dx;d.dy=g.yx*f.dx+g.yy*f.dy+g.dy}m.mixin(this,d)}}else m.mixin(this,a)};m.extend(h.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});m.mixin(h,{identity:new h.Matrix2D,flipX:new h.Matrix2D({xx:-1}),flipY:new h.Matrix2D({yy:-1}),flipXY:new h.Matrix2D({xx:-1,yy:-1}),translate:function(a,d){return 1<arguments.length?new h.Matrix2D({dx:a,dy:d}):new h.Matrix2D({dx:a.x,dy:a.y})},scale:function(a,d){return 1<arguments.length?new h.Matrix2D({xx:a,
yy:d}):"number"==typeof a?new h.Matrix2D({xx:a,yy:a}):new h.Matrix2D({xx:a.x,yy:a.y})},rotate:function(a){var d=Math.cos(a);a=Math.sin(a);return new h.Matrix2D({xx:d,xy:-a,yx:a,yy:d})},rotateg:function(a){return h.rotate(h._degToRad(a))},skewX:function(a){return new h.Matrix2D({xy:Math.tan(a)})},skewXg:function(a){return h.skewX(h._degToRad(a))},skewY:function(a){return new h.Matrix2D({yx:Math.tan(a)})},skewYg:function(a){return h.skewY(h._degToRad(a))},reflect:function(a,d){1==arguments.length&&
(d=a.y,a=a.x);var k=a*a,g=d*d,f=k+g,b=2*a*d/f;return new h.Matrix2D({xx:2*k/f-1,xy:b,yx:b,yy:2*g/f-1})},project:function(a,d){1==arguments.length&&(d=a.y,a=a.x);var k=a*a,g=d*d,f=k+g,b=a*d/f;return new h.Matrix2D({xx:k/f,xy:b,yx:b,yy:g/f})},normalize:function(a){return a instanceof h.Matrix2D?a:new h.Matrix2D(a)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(a){var d=new h.Matrix2D,k;for(k in a)"number"==typeof a[k]&&"number"==typeof d[k]&&d[k]!=
a[k]&&(d[k]=a[k]);return d},invert:function(a){a=h.normalize(a);var d=a.xx*a.yy-a.xy*a.yx;return a=new h.Matrix2D({xx:a.yy/d,xy:-a.xy/d,yx:-a.yx/d,yy:a.xx/d,dx:(a.xy*a.dy-a.yy*a.dx)/d,dy:(a.yx*a.dx-a.xx*a.dy)/d})},_multiplyPoint:function(a,d,k){return{x:a.xx*d+a.xy*k+a.dx,y:a.yx*d+a.yy*k+a.dy}},multiplyPoint:function(a,d,k){a=h.normalize(a);return"number"==typeof d&&"number"==typeof k?h._multiplyPoint(a,d,k):h._multiplyPoint(a,d.x,d.y)},multiplyRectangle:function(a,d){var k=h.normalize(a);d=d||{x:0,
y:0,width:0,height:0};if(h.isIdentity(k))return{x:d.x,y:d.y,width:d.width,height:d.height};a=h.multiplyPoint(k,d.x,d.y);var g=h.multiplyPoint(k,d.x,d.y+d.height),f=h.multiplyPoint(k,d.x+d.width,d.y);d=h.multiplyPoint(k,d.x+d.width,d.y+d.height);var k=Math.min(a.x,g.x,f.x,d.x),b=Math.min(a.y,g.y,f.y,d.y);return{x:k,y:b,width:Math.max(a.x,g.x,f.x,d.x)-k,height:Math.max(a.y,g.y,f.y,d.y)-b}},multiply:function(a){for(var d=h.normalize(a),k=1;k<arguments.length;++k){var g=d,f=h.normalize(arguments[k]),
d=new h.Matrix2D;d.xx=g.xx*f.xx+g.xy*f.yx;d.xy=g.xx*f.xy+g.xy*f.yy;d.yx=g.yx*f.xx+g.yy*f.yx;d.yy=g.yx*f.xy+g.yy*f.yy;d.dx=g.xx*f.dx+g.xy*f.dy+g.dx;d.dy=g.yx*f.dx+g.yy*f.dy+g.dy}return d},_sandwich:function(a,d,k){return h.multiply(h.translate(d,k),a,h.translate(-d,-k))},scaleAt:function(a,d,k,g){switch(arguments.length){case 4:return h._sandwich(h.scale(a,d),k,g);case 3:return"number"==typeof k?h._sandwich(h.scale(a),d,k):h._sandwich(h.scale(a,d),k.x,k.y)}return h._sandwich(h.scale(a),d.x,d.y)},rotateAt:function(a,
d,k){return 2<arguments.length?h._sandwich(h.rotate(a),d,k):h._sandwich(h.rotate(a),d.x,d.y)},rotategAt:function(a,d,k){return 2<arguments.length?h._sandwich(h.rotateg(a),d,k):h._sandwich(h.rotateg(a),d.x,d.y)},skewXAt:function(a,d,k){return 2<arguments.length?h._sandwich(h.skewX(a),d,k):h._sandwich(h.skewX(a),d.x,d.y)},skewXgAt:function(a,d,k){return 2<arguments.length?h._sandwich(h.skewXg(a),d,k):h._sandwich(h.skewXg(a),d.x,d.y)},skewYAt:function(a,d,k){return 2<arguments.length?h._sandwich(h.skewY(a),
d,k):h._sandwich(h.skewY(a),d.x,d.y)},skewYgAt:function(a,d,k){return 2<arguments.length?h._sandwich(h.skewYg(a),d,k):h._sandwich(h.skewYg(a),d.x,d.y)}});n.Matrix2D=h.Matrix2D;return h})},"esri/views/2d/libs/gfx/Image":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base ./Shape ./svg".split(" "),function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});n=function(k){function g(f){var b=k.call(this)||this;b.shape=a.getDefault("Image");b.rawNode=
f;return b}h(g,k);g.prototype.setShape=function(f){this.shape=a.makeParameters(this.shape,f);this.bbox=null;f=this.rawNode;for(var b in this.shape)if("type"!==b&&"src"!==b){var e=this.shape[b];if("width"===b||"height"===b)e=0>e?0:e;f.setAttribute(b,e)}f.setAttribute("preserveAspectRatio","none");d._setAttributeNS(f,d.xmlns.xlink,"xlink:href",this.shape.src);f.__gfxObject__=this;return this};g.prototype.getBoundingBox=function(){return this.shape};g.prototype.setStroke=function(){return this};g.prototype.setFill=
function(){return this};g.nodeType="image";return g}(l.default);m.default=n})},"esri/views/2d/libs/gfx/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base dojox/gfx/matrix ../../../../core/lang ./Shape".split(" "),function(n,m,h,a,l,d,k){Object.defineProperty(m,"__esModule",{value:!0});n=function(g){function f(b){var e=g.call(this)||this;e.segments=[];e.tbbox=null;e.absolute=!0;e.last={};e.segmented=!1;e._validSegments={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,
a:7,z:0};e._2PI=2*Math.PI;e.rawNode=b;e.shape=d.clone(a.defaultPath);return e}h(f,g);f.prototype.setAbsoluteMode=function(a){this._confirmSegmented();this.absolute="string"===typeof a?"absolute"===a:a;return this};f.prototype.getAbsoluteMode=function(){this._confirmSegmented();return this.absolute};f.prototype.getBoundingBox=function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null};f.prototype._getRealBBox=
function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var a=this.bbox,e=this._getRealMatrix();this.bbox=null;for(var c=this.segments.length,f=0;f<c;++f)this._updateWithSegment(this.segments[f],e);e=this.bbox;this.bbox=a;return this.tbbox=e?[{x:e.l,y:e.t},{x:e.r,y:e.t},{x:e.r,y:e.b},{x:e.l,y:e.b}]:null};f.prototype.getLastPosition=function(){this._confirmSegmented();return"x"in this.last?this.last:null};f.prototype._applyTransform=function(){this.tbbox=null;g.prototype._applyTransform.call(this);
return this};f.prototype._updateBBox=function(a,e,c){c&&(e=l.multiplyPoint(c,a,e),a=e.x,e=e.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>e&&(this.bbox.t=e),this.bbox.b<e&&(this.bbox.b=e)):this.bbox={l:a,b:e,r:a,t:e}};f.prototype._updateWithSegment=function(b,e){var c=b.args,f=c.length,d;switch(b.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(d=0;d<f;d+=2)this._updateBBox(c[d],c[d+1],e);this.last.x=c[f-2];this.last.y=c[f-
1];this.absolute=!0;break;case "H":for(d=0;d<f;++d)this._updateBBox(c[d],this.last.y,e);this.last.x=c[f-1];this.absolute=!0;break;case "V":for(d=0;d<f;++d)this._updateBBox(this.last.x,c[d],e);this.last.y=c[f-1];this.absolute=!0;break;case "m":d=0;"x"in this.last||(this._updateBBox(this.last.x=c[0],this.last.y=c[1],e),d=2);for(;d<f;d+=2)this._updateBBox(this.last.x+=c[d],this.last.y+=c[d+1],e);this.absolute=!1;break;case "l":case "t":for(d=0;d<f;d+=2)this._updateBBox(this.last.x+=c[d],this.last.y+=
c[d+1],e);this.absolute=!1;break;case "h":for(d=0;d<f;++d)this._updateBBox(this.last.x+=c[d],this.last.y,e);this.absolute=!1;break;case "v":for(d=0;d<f;++d)this._updateBBox(this.last.x,this.last.y+=c[d],e);this.absolute=!1;break;case "c":for(d=0;d<f;d+=6)this._updateBBox(this.last.x+c[d],this.last.y+c[d+1],e),this._updateBBox(this.last.x+c[d+2],this.last.y+c[d+3],e),this._updateBBox(this.last.x+=c[d+4],this.last.y+=c[d+5],e);this.absolute=!1;break;case "s":case "q":for(d=0;d<f;d+=4)this._updateBBox(this.last.x+
c[d],this.last.y+c[d+1],e),this._updateBBox(this.last.x+=c[d+2],this.last.y+=c[d+3],e);this.absolute=!1;break;case "A":for(d=0;d<f;d+=7)this._updateBBox(c[d+5],c[d+6],e);this.last.x=c[f-2];this.last.y=c[f-1];this.absolute=!0;break;case "a":for(d=0;d<f;d+=7)this._updateBBox(this.last.x+=c[d+5],this.last.y+=c[d+6],e);this.absolute=!1}b=[b.action];for(d=0;d<f;++d)b.push(a.formatNumber(c[d],!0));if("string"===typeof this.shape.path)this.shape.path+=b.join("");else for(d=0,f=b.length;d<f;++d)this.shape.path.push(b[d]);
"string"===typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)};f.prototype._pushSegment=function(a,e){this.tbbox=null;var b=this._validSegments[a.toLowerCase()];"number"===typeof b&&(b?e.length>=b&&(a={action:a,args:e.slice(0,e.length-e.length%b)},this.segments.push(a),this._updateWithSegment(a)):(a={action:a,args:[]},this.segments.push(a),this._updateWithSegment(a)))};f.prototype._collectArgs=function(a,e){for(var b=0;b<e.length;++b){var f=e[b];"boolean"===typeof f?a.push(f?1:
0):"number"===typeof f?a.push(f):f instanceof Array?this._collectArgs(a,f):"x"in f&&"y"in f&&a.push(f.x,f.y)}};f.prototype._confirmSegmented=function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}};f.prototype._setPath=function(b){b=Array.isArray(b)?b:b.match(a.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(b){for(var e="",c=[],f=b.length,d=0;d<f;++d){var g=b[d],k=parseFloat(g);
isNaN(k)?(e&&this._pushSegment(e,c),c=[],e=g):c.push(k)}this._pushSegment(e,c)}};f.prototype.setShape=function(a){g.prototype.setShape.call(this,"string"===typeof a?{path:a}:a);this.segmented=!1;this.segments=[];this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this};f.nodeType="path";return f}(k.default);m.default=n})},"esri/views/2d/libs/gfx/Rect":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","dojox/gfx/_base",
"./Shape"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});n=function(d){function k(g){var f=d.call(this)||this;f.shape=a.getDefault("Rect");f.rawNode=g;return f}h(k,d);k.prototype.getBoundingBox=function(){return this.shape};k.prototype.setShape=function(d){this.shape=a.makeParameters(this.shape,d);this.bbox=null;for(var f in this.shape)if("type"!==f&&"r"!==f){d=this.shape[f];if("width"===f||"height"===f)d=0>d?0:d;this.rawNode.setAttribute(f,d)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",
this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this};k.nodeType="rect";return k}(l.default);m.default=n})},"esri/views/2d/libs/gfx/Text":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base ../../../../core/has ./Shape ./svg".split(" "),function(n,m,h,a,l,d,k){Object.defineProperty(m,"__esModule",{value:!0});var g=l("chrome")?"auto":"optimizeLegibility";n=function(f){function b(b){var c=f.call(this)||this;c.fontStyle=null;c.shape=a.getDefault("Text");
c.rawNode=b;return c}h(b,f);b.prototype.getFont=function(){return this.fontStyle};b.prototype.setFont=function(b){this.fontStyle="string"===typeof b?a.splitFontString(b):a.makeParameters(a.defaultFont,b);this._setFont();return this};b.prototype._setFont=function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)};b.prototype.setShape=
function(b){this.shape=a.makeParameters(this.shape,b);this.bbox=null;b=this.rawNode;var c=this.shape;b.setAttribute("x",c.x);b.setAttribute("y",c.y);b.setAttribute("text-anchor",c.align);b.setAttribute("text-decoration",c.decoration);b.setAttribute("rotate",c.rotated?90:0);b.setAttribute("kerning",c.kerning?"auto":0);b.setAttribute("text-rendering",g);b.firstChild?b.firstChild.nodeValue=c.text:b.appendChild(k._createTextNode(c.text));return this};b.prototype.getTextWidth=function(){var a=this.rawNode,
b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var f=0,d=a.firstChild.nodeValue;b.appendChild(a);if(""!==d)for(;!f;)f=a.getBBox?parseInt(a.getBBox().width,10):68;b.removeChild(a);return f};b.prototype.getBoundingBox=function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(c){a={x:0,y:0,width:0,height:0}}return a};b.nodeType="text";return b}(d.default);m.default=n})},"esri/views/2d/libs/gfx/Surface":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/dom-construct dojox/gfx/_base ../../../../core/has ./Circle ./Container ./Group ./Image ./Path ./Rect ./svg ./Text".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p){Object.defineProperty(m,"__esModule",{value:!0});var v=navigator.userAgent,r=534<function(){var a=/WebKit\/(\d*)/.exec(v);return a?parseInt(a[1],10):0}();n=function(g){function m(){var a=null!==g&&g.apply(this,arguments)||this;a.rawNode=null;a._parent=null;a._nodes=[];a._events=[];return a}h(m,g);m.prototype.destroy=function(){this._nodes.forEach(a.destroy);this._nodes=[];this._events.forEach(function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(d("ie"))for(;this._parent.lastChild;)a.destroy(this._parent.lastChild);
else this._parent.innerHTML="";this.defNode=this._parent=null};m.prototype.setDimensions=function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;this.rawNode.setAttribute("width",a);this.rawNode.setAttribute("height",b);r&&(this.rawNode.style.width=a,this.rawNode.style.height=b);return this};m.prototype.getDimensions=function(){return this.rawNode?{width:l.normalizedLength(this.rawNode.getAttribute("width")),height:l.normalizedLength(this.rawNode.getAttribute("height"))}:null};m.prototype.getEventSource=
function(){return this.rawNode};m.prototype._getRealMatrix=function(){return null};m.prototype.createShape=function(a){switch(a.type){case l.defaultPath.type:return this.createPath(a);case l.defaultRect.type:return this.createRect(a);case l.defaultCircle.type:return this.createCircle(a);case l.defaultImage.type:return this.createImage(a);case l.defaultText.type:return this.createText(a)}console.error("[gfx] unknown shape",a);return null};m.prototype.createGroup=function(){return this.createObject(f.default)};
m.prototype.createRect=function(a){return this.createObject(c.default,a)};m.prototype.createCircle=function(a){return this.createObject(k.default,a)};m.prototype.createImage=function(a){return this.createObject(b.default,a)};m.prototype.createText=function(a){return this.createObject(p.default,a)};m.prototype.createPath=function(a){return this.createObject(e.default,a)};m.prototype.createObject=function(a,b){if(!this.rawNode)return null;var c=new a;a=t._createElementNS(t.xmlns.svg,a.nodeType);c.setRawNode(a);
c.setShape(b);this.add(c);return c};return m}(g.default);m.default=n})},"esri/views/2d/libs/gfx/svgSurface":function(){define(["require","exports","dojo/dom","./Surface","./svg"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});m.createSurface=function(d,k,g){var f=new a.default;f.rawNode=l._createElementNS(l.xmlns.svg,"svg");f.rawNode.setAttribute("overflow","hidden");k&&f.rawNode.setAttribute("width",0>k?0:k);g&&f.rawNode.setAttribute("height",0>g?0:g);k=l._createElementNS(l.xmlns.svg,
"defs");f.rawNode.appendChild(k);f.defNode=k;f._parent=h.byId(d);f._parent.appendChild(f.rawNode);return f}})},"esri/views/layers/GraphicsView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a.graphics=null;a.renderer=null;a.view=null;return a}h(g,k);a([d.property()],
g.prototype,"graphics",void 0);a([d.property()],g.prototype,"renderer",void 0);a([d.property()],g.prototype,"view",void 0);return g=a([d.subclass("esri.views.layers.GraphicsView")],g)}(d.declared(l))})},"esri/views/2d/navigation/MapViewNavigation":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t){var p=new l({targetGeometry:new g}),v=[0,0];return function(d){function g(a){a=d.call(this)||this;a._endTimer=null;a.animationManager=null;return a}h(g,d);g.prototype.initialize=function(){this.pan=new e({navigation:this});this.rotate=new t({navigation:this});this.pinch=new c({navigation:this});this.zoomBox=new b({view:this.view,navigation:this})};g.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};g.prototype.begin=function(){this._set("interacting",
!0)};g.prototype.end=function(){var a=this;this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0);this._endTimer=setTimeout(function(){a._set("interacting",!1)},0)};g.prototype.zoom=function(a,b){void 0===b&&(b=this._getDefaultAnchor());this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>a?this.zoomIn(b):this.zoomOut(b);this.setViewpoint(b,a,0,[0,0])};g.prototype.zoomIn=function(a){void 0===a&&(a=this._getDefaultAnchor());var b=this.view,
c=b.scale,e=b.constraints.snapToNextScale(c);return b.goTo(this._scaleAndRotateViewpoint(p,a,e/c,0))};g.prototype.zoomOut=function(a){void 0===a&&(a=this._getDefaultAnchor());var b=this.view,c=b.scale,e=b.constraints.snapToPreviousScale(c);return b.goTo(this._scaleAndRotateViewpoint(p,a,e/c,0))};g.prototype.setViewpoint=function(a,b,c,e){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,a,b,c,e);this.end()};g.prototype.animateViewpoint=function(a,b,c){return this.view.goTo(this._scaleAndRotateViewpoint(p,
a,b,c))};g.prototype.continousRotateClockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.rotateBy(a,a,-1)})};g.prototype.continousRotateCounterclockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.rotateBy(a,a,1)})};g.prototype.resetRotation=function(){this.view.rotation=0};g.prototype.continousPanLeft=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.translateBy(a,
a,[-10,0])})};g.prototype.continousPanRight=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.translateBy(a,a,[10,0])})};g.prototype.continousPanUp=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.translateBy(a,a,[0,10])})};g.prototype.continousPanDown=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){f.translateBy(a,a,[0,-10])})};g.prototype.stop=function(){this.pan.stopMomentumNavigation();
this.animationManager.stop();this.end();this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0)};g.prototype._getDefaultAnchor=function(){var a=this.view.size;v[0]=.5*a[0];v[1]=.5*a[1];return v};g.prototype._scaleAndRotateViewpoint=function(a,b,c,e){var d=this.view,g=d.size,k=d.padding,h=d.constraints,l=d.viewpoint,m=d.scale*c,d=h.canZoomInTo(m),h=h.canZoomOutTo(m);return 1>c&&!d||1<c&&!h?l:f.padAndScaleAndRotateBy(a,l,c,e,b,g,k)};g.prototype._scaleRotateTranslateViewpoint=function(a,b,c,
e,d){var g=this.view,k=g.size,h=g.padding,l=g.constraints,m=g.viewpoint,p=g.scale*c,g=l.canZoomInTo(p),l=l.canZoomOutTo(p);if(1>c&&!g||1<c&&!l)c=1;f.translateBy(m,m,d);return f.padAndScaleAndRotateBy(a,m,c,e,b,k,h)};a([k.property()],g.prototype,"animationManager",void 0);a([k.property({type:Boolean,readOnly:!0})],g.prototype,"interacting",void 0);a([k.property()],g.prototype,"pan",void 0);a([k.property()],g.prototype,"pinch",void 0);a([k.property()],g.prototype,"rotate",void 0);a([k.property()],g.prototype,
"view",void 0);a([k.property()],g.prototype,"zoomBox",void 0);return g=a([k.subclass("esri.views.2d.navigation.MapViewNavigation")],g)}(k.declared(d))})},"esri/views/2d/navigation/ZoomBox":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d){return function(k){function g(a){a=k.call(this,a)||this;a._container=null;a._overlay=null;a._backgroundShape=
null;a._boxShape=null;a._box={x:0,y:0,width:0,height:0};a._redraw=a._redraw.bind(a);return a}h(g,k);g.prototype.destroy=function(){this.view=null};Object.defineProperty(g.prototype,"view",{set:function(a){var b=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return b._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return b._handleDrag(a,-1)}))},enumerable:!0,configurable:!0});
g.prototype._start=function(a,b,e,c){this._createContainer();this._createOverlay();this.navigation.begin()};g.prototype._update=function(a,b,e,c){this._box.x=a;this._box.y=b;this._box.width=e;this._box.height=c;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};g.prototype._end=function(a,b,e,c,d){var f=this.view;a=f.toMap(a+.5*e,b+.5*c);e=Math.max(e/f.width,c/f.height);-1===d&&(e=1/e);this._destroyOverlay();this.navigation.end();f.goTo({center:a,scale:f.scale*e})};g.prototype._updateBox=
function(a,b,e,c){var f=this._boxShape;f.setAttributeNS(null,"x",""+a);f.setAttributeNS(null,"y",""+b);f.setAttributeNS(null,"width",""+e);f.setAttributeNS(null,"height",""+c);f.setAttributeNS(null,"class","esri-zoom-box__outline")};g.prototype._updateBackground=function(a,b,e,c){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,b,e,c,this.view.width,this.view.height))};g.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";
this.view.root.appendChild(a);this._container=a};g.prototype._createOverlay=function(){var a=this.view.width,b=this.view.height,e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+b+" L 0 "+b+" Z");e.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS("http://www.w3.org/2000/xmlns/",
"xmlns:xlink","http://www.w3.org/1999/xlink");b.setAttributeNS(null,"class","esri-zoom-box__overlay");b.appendChild(e);b.appendChild(a);this._container.appendChild(b);this._backgroundShape=e;this._boxShape=a;this._overlay=b};g.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};g.prototype._toSVGPath=function(a,b,e,c,d,g){e=a+e;c=b+c;return"M 0 0 L "+
d+" 0 L "+d+" "+g+" L 0 "+g+" ZM "+a+" "+b+" L "+a+" "+c+" L "+e+" "+c+" L "+e+" "+b+" Z"};g.prototype._handleDrag=function(a,b){var e=a.x,c=a.y,d=a.origin.x,f=a.origin.y,g;e>d?(g=d,d=e-d):(g=e,d-=e);c>f?(e=f,c-=f):(e=c,c=f-c);switch(a.action){case "start":this._start(g,e,d,c);break;case "update":this._update(g,e,d,c);break;case "end":this._end(g,e,d,c,b)}a.stopPropagation()};g.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,b=a.x,e=a.y,c=a.width,a=a.height;
this._updateBox(b,e,c,a);this._updateBackground(b,e,c,a);this._rafId=requestAnimationFrame(this._redraw)}};a([d.property()],g.prototype,"navigation",void 0);a([d.property()],g.prototype,"view",null);return g=a([d.subclass("esri.views.2d.navigation.ZoomBox")],g)}(d.declared(l))})},"esri/views/2d/navigation/actions/Pan":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../viewpointUtils ../../../3d/lib/gl-matrix ../../../navigation/PanPlanarMomentumEstimator".split(" "),
function(n,m,h,a,l,d,k,g,f){return function(b){function e(a){var c=b.call(this)||this;c.animationTime=0;c.momentumEstimator=new f.PanPlanarMomentumEstimator(500,6,.92);c.momentum=null;c.tmpMomentum=g.vec3d.create();c.momentumFinished=!1;c.viewpoint=k.create();c.watch("momentumFinished",function(a){a&&c.navigation.stop()});return c}h(e,b);e.prototype.begin=function(a,b){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(b);this.previousDrag=b};e.prototype.update=function(a,
b){this.addToEstimator(b);var c=b.center.x,e=b.center.y,d=this.previousDrag,c=d?d.center.x-c:-c,e=d?e-d.center.y:e;a.viewpoint=k.translateBy(this.viewpoint,a.viewpoint,[c||0,e||0]);this.previousDrag=b};e.prototype.end=function(a,b){this.addToEstimator(b);this.momentum=this.momentumEstimator.evaluateMomentum();this.animationTime=0;if(this.momentum)this.onAnimationUpdate(a);this.previousDrag=null;this.navigation.end()};e.prototype.addToEstimator=function(a){var b=g.vec3d.createFrom(-a.center.x,a.center.y,
0);this.momentumEstimator.add(b,b,.001*a.timestamp)};e.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(c,e){b.momentumFinished=!b.momentum||b.momentum.isFinished(b.animationTime);e*=.001;if(!b.momentumFinished){var d=b.momentum.valueDelta(b.animationTime,e);g.vec3d.scale(b.momentum.direction,d,b.tmpMomentum);a.viewpoint=k.translateBy(c,c,b.tmpMomentum)}b.animationTime+=e})};e.prototype.stopMomentumNavigation=function(){this.momentum&&
(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};a([d.property()],e.prototype,"momentumFinished",void 0);a([d.property()],e.prototype,"viewpoint",void 0);a([d.property()],e.prototype,"navigation",void 0);return e=a([d.subclass("esri.views.2d.navigation.actions.Pan")],e)}(d.declared(l))})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("require exports ../../core/tsSupport/extendsHelper ../3d/lib/gl-matrix ./FilteredFiniteDifference ./Momentum".split(" "),
function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});var k=function(a){function d(b,e,c,d,f){b=a.call(this,b,e,c)||this;b.sceneVelocity=d;b.direction=f;return b}h(d,a);d.prototype.value=function(b){return a.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,b)};return d}(d.Momentum);m.PanPlanarMomentum=k;n=function(){function d(d,b,e){void 0===d&&(d=300);void 0===b&&(b=12);void 0===e&&(e=.84);this.minimumInitialVelocity=d;this.stopVelocity=b;this.friction=e;this.time=
new l.FilteredFiniteDifference(.6);this.screen=[new l.FilteredFiniteDifference(.4),new l.FilteredFiniteDifference(.4)];this.scene=[new l.FilteredFiniteDifference(.6),new l.FilteredFiniteDifference(.6),new l.FilteredFiniteDifference(.6)];this.tmpDirection=a.vec3d.create()}d.prototype.add=function(a,b,e){this.time.hasLastValue&&.015>this.time.computeDelta(e)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(b[0]),this.scene[1].update(b[1]),this.scene[2].update(b[2]),this.time.update(e))};
d.prototype.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();this.scene[1].reset();this.scene[2].reset();this.time.reset()};d.prototype.evaluateMomentum=function(){if(!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta,b=this.screen[1].filteredDelta,a=Math.sqrt(a*a+b*b)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};d.prototype.createMomentum=function(d,
b,e){a.vec3d.set3(this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta,this.tmpDirection);var c=a.vec3d.length(this.tmpDirection);0<c&&a.vec3d.scale(this.tmpDirection,1/c);return new k(d,b,e,c/this.time.filteredDelta,this.tmpDirection)};return d}();m.PanPlanarMomentumEstimator=n})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function h(a){this.gain=
a}h.prototype.update=function(a){if(this.hasLastValue){var h=this.computeDelta(a);this.updateDelta(h)}this.lastValue=a};h.prototype.reset=function(){this.filteredDelta=this.lastValue=void 0};Object.defineProperty(h.prototype,"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!0,configurable:!0});h.prototype.computeDelta=function(a){return a-
this.lastValue};h.prototype.updateDelta=function(a){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*a:a};return h}();m.FilteredFiniteDifference=n})},"esri/views/navigation/Momentum":function(){define(["require","exports","../../core/tsSupport/extendsHelper"],function(n,m,h){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function a(a,d,k){this._initialVelocity=a;this._stopVelocity=d;this._friction=k;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/
this._stopVelocity)/Math.log(1-this._friction))}Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0});a.prototype.isFinished=function(a){return a>this.duration};Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});a.prototype.value=function(a){return this.valueFromInitialVelocity(this._initialVelocity,a)};a.prototype.valueDelta=function(a,d){var k=this.value(a);return this.value(a+
d)-k};a.prototype.valueFromInitialVelocity=function(a,d){d=Math.min(d,this.duration);var k=1-this.friction;return a*(Math.pow(k,d)-1)/Math.log(k)};return a}();m.Momentum=n})},"esri/views/2d/navigation/actions/Pinch":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../viewpointUtils ../../libs/gl-matrix/vec2 ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator".split(" "),
function(n,m,h,a,l,d,k,g,f,b){return function(e){function c(a){var c=e.call(this,a)||this;c._animationTime=0;c._momentumFinished=!1;c._rotationMomentumEstimator=new f.RotationMomentumEstimator(.6,.15,.95);c._rotationDirection=1;c._startCenter=null;c._zoomDirection=1;c._zoomMomentumEstimator=new b.ZoomMomentumEstimator;c._zoomOnly=null;c.zoomMomentum=null;c.rotateMomentum=null;c.viewpoint=k.create();c.watch("_momentumFinished",function(a){a&&c.navigation.stop()});return c}h(c,e);c.prototype.begin=
function(a,b){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=b.angle;this._previousRadius=this._startRadius=b.radius;this._previousCenter=this._startCenter=b.center;this._updateTimestamp=null;a.constraints.rotationEnabled&&this.addToRotateEstimator(0,b.timestamp);this.addToZoomEstimator(b,1)};c.prototype.update=function(a,b){null===this._updateTimestamp&&(this._updateTimestamp=b.timestamp);
var c=b.angle,e=b.radius,d=b.center,f=Math.abs(180*(c-this._startAngle)/Math.PI),g=Math.abs(e-this._startRadius),k=this._startRadius/e;if(this._previousRadius){var h=e/this._previousRadius,l=180*(c-this._previousAngle)/Math.PI;this._rotationDirection=0<=l?1:-1;this._zoomDirection=1<=h?1:-1;a.constraints.rotationEnabled?(null===this._zoomOnly&&200<b.timestamp-this._updateTimestamp&&(this._zoomOnly=0<g-f),null===this._zoomOnly||this._zoomOnly?l=0:this.addToRotateEstimator(c-this._startAngle,b.timestamp)):
l=0;this.addToZoomEstimator(b,k);this.navigation.setViewpoint([d.x,d.y],1/h,l,[this._previousCenter.x-d.x,d.y-this._previousCenter.y])}this._previousAngle=c;this._previousRadius=e;this._previousCenter=d};c.prototype.end=function(a,b){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(a);this.navigation.end()};c.prototype.addToRotateEstimator=
function(a,b){this._rotationMomentumEstimator.add(a,.001*b)};c.prototype.addToZoomEstimator=function(a,b){this._zoomMomentumEstimator.add(b,.001*a.timestamp)};c.prototype.canZoomIn=function(a){var b=a.scale;a=a.constraints.effectiveMaxScale;return 0===a||b>a};c.prototype.canZoomOut=function(a){var b=a.scale;a=a.constraints.effectiveMinScale;return 0===a||b<a};c.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(c,e){var d=!b.canZoomIn(a)&&
1<b._zoomDirection||!b.canZoomOut(a)&&1>b._zoomDirection,f=!b.rotateMomentum||b.rotateMomentum.isFinished(b._animationTime),d=d||!b.zoomMomentum||b.zoomMomentum.isFinished(b._animationTime);e*=.001;b._momentumFinished=f&&d;if(!b._momentumFinished){var f=b.rotateMomentum?Math.abs(b.rotateMomentum.valueDelta(b._animationTime,e))*b._rotationDirection*180/Math.PI:0,d=b.zoomMomentum?Math.abs(b.zoomMomentum.valueDelta(b._animationTime,e)):1,h=g.create(),l=g.create();if(b._previousCenter){g.set(h,b._previousCenter.x,
b._previousCenter.y);k.getPaddingScreenTranslation(l,a.size,a.padding);g.add(h,h,l);var l=a.constraints,m=a.scale,n=m*d;1>d&&!l.canZoomInTo(n)?(d=m/l.effectiveMaxScale,b.zoomMomentum=null,b.rotateMomentum=null):1<d&&!l.canZoomOutTo(n)&&(d=m/l.effectiveMinScale,b.zoomMomentum=null,b.rotateMomentum=null);k.scaleAndRotateBy(c,a.viewpoint,d,f,h,a.size)}}b._animationTime+=e})};c.prototype.stopMomentumNavigation=function(){if(this.rotateMomentum||this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),
this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};a([d.property()],c.prototype,"_momentumFinished",void 0);a([d.property()],c.prototype,"viewpoint",void 0);a([d.property()],c.prototype,"navigation",void 0);return c=a([d.subclass("esri.views.2d.navigation.actions.Pinch")],c)}(d.declared(l))})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./MomentumEstimator"],
function(n,m,h,a){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function d(d,g,f,b){void 0===d&&(d=3);void 0===g&&(g=.01);void 0===f&&(f=.95);void 0===b&&(b=12);return a.call(this,d,g,f,b)||this}h(d,a);d.prototype.add=function(d,g){if(this.value.hasLastValue){var f=this.value.lastValue;for(d-=f;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;d=f+d}a.prototype.add.call(this,d,g)};return d}(a.MomentumEstimator);m.RotationMomentumEstimator=n})},"esri/views/navigation/MomentumEstimator":function(){define("require exports ../../core/tsSupport/extendsHelper ../3d/support/mathUtils ./FilteredFiniteDifference ./Momentum".split(" "),
function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function k(a,d,b,e){void 0===a&&(a=2.5);void 0===d&&(d=.01);void 0===b&&(b=.95);void 0===e&&(e=12);this.minimumInitialVelocity=a;this.stopVelocity=d;this.friction=b;this.maxVelocity=e;this.value=new l.FilteredFiniteDifference(.8);this.time=new l.FilteredFiniteDifference(.3)}k.prototype.add=function(a,d){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;if(this.value.hasFilteredDelta){var b=this.value.computeDelta(a);
0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(d);this.value.update(a)};k.prototype.reset=function(){this.value.reset();this.time.reset()};k.prototype.evaluateMomentum=function(){if(!this.value.hasFilteredDelta)return null;var d=this.value.filteredDelta/this.time.filteredDelta,d=a.clamp(d,-this.maxVelocity,this.maxVelocity);return Math.abs(d)<this.minimumInitialVelocity?null:this.createMomentum(d,this.stopVelocity,this.friction)};k.prototype.createMomentum=function(a,f,b){return new d.Momentum(a,
f,b)};return k}();m.MomentumEstimator=n})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./Momentum","./MomentumEstimator"],function(n,m,h,a,l){Object.defineProperty(m,"__esModule",{value:!0});var d=function(a){function d(d,b,e){return a.call(this,d,b,e)||this}h(d,a);d.prototype.value=function(d){d=a.prototype.value.call(this,d);return Math.exp(d)};d.prototype.valueDelta=function(d,b){var e=a.prototype.value.call(this,d);
d=a.prototype.value.call(this,d+b);return Math.exp(d-e)};return d}(a.Momentum);m.ZoomMomentum=d;n=function(a){function g(d,b,e,c){void 0===d&&(d=2.5);void 0===b&&(b=.01);void 0===e&&(e=.95);void 0===c&&(c=12);return a.call(this,d,b,e,c)||this}h(g,a);g.prototype.add=function(d,b){a.prototype.add.call(this,Math.log(d),b)};g.prototype.createMomentum=function(a,b,e){return new d(a,b,e)};return g}(l.MomentumEstimator);m.ZoomMomentumEstimator=n})},"esri/views/2d/navigation/actions/Rotate":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../viewpointUtils ../../libs/gl-matrix/vec2".split(" "),
function(n,m,h,a,l,d,k,g){return function(f){function b(a){a=f.call(this)||this;a.animationTime=0;a.viewpoint=k.create();return a}h(b,f);b.prototype.begin=function(a,b){this.navigation.begin();this.previousCenter=b.center};b.prototype.update=function(a,b){var c=g.create();g.set(c,b.center.x+a.padding.left-a.padding.right,a.height-b.center.y+a.padding.top-a.padding.bottom);var d=g.create();g.set(d,this.previousCenter.x+a.padding.left-a.padding.right,a.height-this.previousCenter.y+a.padding.top-a.padding.bottom);
c=k.angleBetween([a.state.paddedScreenCenter[0]+a.padding.left-a.padding.right,a.state.paddedScreenCenter[1]],c,d);a.viewpoint=k.rotateBy(this.viewpoint,a.content.viewpoint,c);this.previousCenter=b.center};b.prototype.end=function(a,b){this.navigation.end()};a([d.property()],b.prototype,"viewpoint",void 0);a([d.property()],b.prototype,"navigation",void 0);return b=a([d.subclass("esri.views.2d.actions.Rotate")],b)}(d.declared(l))})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(n,m,h,a,l,d,k){return function(d){function f(){var a=null!==d&&d.apply(this,arguments)||this;a.color=new l([0,255,255]);a.haloOpacity=1;a.fillOpacity=.5;return a}h(f,d);a([k.property({type:l})],f.prototype,"color",void 0);a([k.property()],f.prototype,"haloOpacity",void 0);a([k.property()],f.prototype,"fillOpacity",void 0);return f=a([k.subclass("esri.views.2d.support.HighlightOptions")],f)}(k.declared(d))})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI".split(" "),
function(n,m,h,a,l,d){return function(d){function g(a){a=d.call(this)||this;a.components=["attribution","zoom"];return a}h(g,d);a([l.property()],g.prototype,"components",void 0);return g=a([l.subclass("esri.views.ui.2d.DefaultUI2D")],g)}(l.declared(d))})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom-geometry ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ./UI ../../widgets/Attribution ../../widgets/Compass ../../widgets/NavigationToggle ../../widgets/Zoom".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t){return function(f){function m(a){a=f.call(this)||this;a._defaultPositionLookup=null;a.components=[];return a}h(m,f);m.prototype.initialize=function(){this._handles.add([d.init(this,"components",this._componentsWatcher.bind(this)),d.init(this,"view",this._updateViewAwareWidgets.bind(this))])};m.prototype._findComponentPosition=function(a){if(!this._defaultPositionLookup){var b=l.isBodyLtr();this._defaultPositionLookup={attribution:"manual",compass:b?"top-left":"top-right",
"navigation-toggle":b?"top-left":"top-right",zoom:b?"top-left":"top-right"}}return this._defaultPositionLookup[a]};m.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){if(a=b.find(a))b.remove(a),a.destroy()})};m.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b.find(c))&&c.widget)&&void 0!==c.view&&c.set("view",a)})};m.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a);this._adjustPadding(a)};
m.prototype._adjustPadding=function(a){-1!==a.indexOf("attribution")||this._isOverridden("padding")||(this.padding=this.padding.top)};m.prototype._addComponents=function(a){var b=this;this.initialized&&a.forEach(function(a){return b.add(b._createComponent(a),b._findComponentPosition(a))})};m.prototype._createComponent=function(a){var b=this._createWidget(a);if(b)return new g({id:a,node:b})};m.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===
a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};m.prototype._createAttribution=function(){return new b({view:this.view})};m.prototype._createCompass=function(){return new e({view:this.view})};m.prototype._createNavigationToggle=function(){return new c({view:this.view})};m.prototype._createZoom=function(){return new t({view:this.view})};a([k.property()],m.prototype,"components",void 0);return m=a([k.subclass("esri.views.ui.DefaultUI")],
m)}(k.declared(f))})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom dojo/dom-class ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d,k,g){return function(f){function b(){var a=null!==f&&f.apply(this,arguments)||this;a.widget=null;return a}h(b,f);b.prototype.destroy=function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(b.prototype,
"id",{get:function(){return this._get("id")||this.get("node.id")},set:function(a){this._set("id",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&d.add(a,"esri-component"),b&&d.remove(b,"esri-component"),this._set("node",a))},enumerable:!0,configurable:!0});b.prototype.castNode=function(a){if(!a)return this._set("widget",null),null;if("string"===typeof a||a&&"nodeType"in a)return this._set("widget",null),l.byId(a);a&&
"function"===typeof a.render&&!a.domNode&&(a.domNode=document.createElement("div"));this._set("widget",a);return a.domNode};a([g.property()],b.prototype,"id",null);a([g.property()],b.prototype,"node",null);a([g.cast("node")],b.prototype,"castNode",null);a([g.property({readOnly:!0})],b.prototype,"widget",void 0);return b=a([g.subclass("esri.views.ui.Component")],b)}(g.declared(k))})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom-class dojo/dom-construct dojo/dom-style ../../core/Accessor ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./Component".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p){function v(a){return"object"!==typeof a||a&&a.isInstanceOf&&a.isInstanceOf(p)||!("component"in a||"index"in a||"position"in a)?null:a}var r={left:0,top:0,bottom:0,right:0},q={bottom:30,top:15,right:15,left:15};return function(b){function f(){var a=b.call(this)||this;a._cornerNameToContainerLookup={};a._positionNameToContainerLookup={};a._components=[];a._handles=new e;a._componentToKey=new Map;a.view=null;a._initContainers();return a}a(f,b);f.prototype.initialize=
function(){this._handles.add([c.init(this,"view.padding, container",this._applyViewPadding.bind(this)),c.init(this,"padding",this._applyUIPadding.bind(this))])};f.prototype.destroy=function(){this.container=null;this._components.forEach(function(a){a.destroy()});this._components.length=0;this._handles.destroy();this._componentToKey.clear();this._componentToKey=null};Object.defineProperty(f.prototype,"container",{set:function(a){var b=this._get("container");a!==b&&(a&&(d.add(a,"esri-ui"),this._attachContainers(a)),
b&&(d.remove(b,"esri-ui"),g.set(b,{top:"",bottom:"",left:"",right:""}),k.empty(b)),this._set("container",a))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"padding",{get:function(){return this._get("padding")},set:function(a){a?this._override("padding",a):this._clearOverride("padding")},
enumerable:!0,configurable:!0});f.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:h({},q,a)};Object.defineProperty(f.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});f.prototype.add=function(a,b){var c=this,d,e;if(Array.isArray(a))a.forEach(function(a){return c.add(a,b)});else{var f=v(a);f&&(d=f.index,b=f.position,a=f.component,
e=f.key);b&&"object"===typeof b&&(d=b.index,e=b.key,b=b.position);!a||b&&!this._isValidPosition(b)||(a&&a.isInstanceOf&&a.isInstanceOf(p)||(a=new p({node:a})),this._place({component:a,position:b,index:d}),this._components.push(a),e&&this._componentToKey.set(a,e))}};f.prototype.remove=function(a,b){var c=this;if(a){if(Array.isArray(a))return a.map(function(a){return c.remove(a,b)});var d=this.find(a);if(d){var e=this._componentToKey;if(!e.has(a)||e.get(a)===b)return e=this._components.indexOf(d),d.node.parentNode&&
d.node.parentNode.removeChild(d.node),this._componentToKey.delete(a),this._components.splice(e,1)[0]}}};f.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";if("manual"===a)return Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!d.contains(a,"esri-ui-corner")}).map(function(a){return b.remove(a)});if(this._isValidPosition(a))return Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this)};f.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var d,e=v(a)||v(b);e&&(d=e.index,b=e.position,a=e.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:d})}};f.prototype.find=function(a){return a?a&&a.isInstanceOf&&a.isInstanceOf(p)?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||a):null};f.prototype._getViewPadding=function(){return this.get("view.padding")||
r};f.prototype._attachContainers=function(a){k.place(this._manualContainer,a);k.place(this._innerContainer,a)};f.prototype._initContainers=function(){var a=k.create("div",{className:"esri-ui-inner-container esri-ui-corner-container"}),b=k.create("div",{className:"esri-ui-inner-container esri-ui-manual-container"}),c=k.create("div",{className:"esri-ui-top-left esri-ui-corner"},a),d=k.create("div",{className:"esri-ui-top-right esri-ui-corner"},a),e=k.create("div",{className:"esri-ui-bottom-left esri-ui-corner"},
a),f=k.create("div",{className:"esri-ui-bottom-right esri-ui-corner"},a);this._innerContainer=a;this._manualContainer=b;this._cornerNameToContainerLookup={"top-left":c,"top-right":d,"bottom-left":e,"bottom-right":f};this._positionNameToContainerLookup=h({manual:b},this._cornerNameToContainerLookup)};f.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};f.prototype._place=function(a){var b=a.component,c=a.index;a=this._positionNameToContainerLookup[a.position||"manual"];
var d;-1<c?(d=Array.prototype.slice.call(a.children),0===c?this._placeComponent(b,a,"first"):c>=d.length?this._placeComponent(b,a,"last"):this._placeComponent(b,d[c],"before")):this._placeComponent(b,a,"last")};f.prototype._placeComponent=function(a,b,c){var d=a.widget;d&&!d._started&&"function"===typeof d.postMixInProperties&&"function"===typeof d.buildRendering&&"function"===typeof d.postCreate&&"function"===typeof d.startup&&a.widget.startup();k.place(a.node,b,c)};f.prototype._applyViewPadding=
function(){var a=this.container;a&&g.set(a,this._toPxPosition(this._getViewPadding()))};f.prototype._applyUIPadding=function(){this._innerContainer&&g.set(this._innerContainer,this._toPxPosition(this.padding))};f.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};f.prototype._toPxUnit=function(a){return 0===a?0:a+"px"};f.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(d){(c=
d===a)&&(b=d);return c});return b};f.prototype._findById=function(a){var b=null,c;this._components.some(function(d){(c=d.id===a)&&(b=d);return c});return b};f.prototype._findByNode=function(a){var b=null,c;this._components.some(function(d){(c=d.node===a)&&(b=d);return c});return b};l([t.property()],f.prototype,"container",null);l([t.property({dependsOn:["view.height"]})],f.prototype,"height",null);l([t.property({value:q})],f.prototype,"padding",null);l([t.cast("padding")],f.prototype,"castPadding",
null);l([t.property()],f.prototype,"view",void 0);l([t.property({dependsOn:["view.width"]})],f.prototype,"width",null);return f=l([t.subclass("esri.views.ui.UI")],f)}(t.declared(f,b))})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Attribution/nls/Attribution ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attribution/AttributionViewModel ./support/widget".split(" "),function(n,m,
h,a,l,d,k,g,f,b){return function(e){function c(a){a=e.call(this)||this;a._isOpen=!1;a._attributionTextOverflowed=!1;a._prevSourceNodeHeight=0;a.iconClass="esri-icon-description";a.itemDelimiter=" | ";a.label=l.widgetLabel;a.view=null;a.viewModel=new f;return a}h(c,e);c.prototype.postInitialize=function(){var a=this;this.own(d.on(this,"viewModel.items","change",function(){return a.scheduleRender()}))};Object.defineProperty(c.prototype,"attributionText",{get:function(){return this.viewModel.items.reduce(function(a,
b){-1===a.indexOf(b.text)&&a.push(b.text);return a},[]).join(this.itemDelimiter)},enumerable:!0,configurable:!0});c.prototype.render=function(){var a,c=(a={},a["esri-attribution--open"]=this._isOpen,a);return b.tsx("div",{bind:this,class:this.classes("esri-attribution esri-widget",c),onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),b.tsx("div",{class:"esri-attribution__powered-by"},"Powered by"," ",b.tsx("a",{target:"_blank",href:"http://www.esri.com/",class:this.classes("esri-attribution__link",
"esri-widget__anchor")},"Esri")))};c.prototype._renderSourcesNode=function(){var a,c=this._isOpen,d=this._isInteractive(),e=d?0:-1,f=this.attributionText,g=d?"button":void 0,c=(a={},a["esri-attribution__sources--open"]=c,a["esri-interactive"]=d,a);return b.tsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",c),innerHTML:f,role:g,tabIndex:e})};c.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=
a.clientWidth};c.prototype._afterSourcesNodeUpdate=function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var d=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;d&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.scheduleRender()};c.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)};c.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};
a([k.property({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0}),b.renderable()],c.prototype,"attributionText",null);a([k.property()],c.prototype,"iconClass",void 0);a([k.property(),b.renderable()],c.prototype,"itemDelimiter",void 0);a([k.property()],c.prototype,"label",void 0);a([k.aliasOf("viewModel.view")],c.prototype,"view",void 0);a([k.property({type:f}),b.renderable(["state","view.size"])],c.prototype,"viewModel",void 0);a([b.accessibleHandler()],c.prototype,"_toggleState",
null);return c=a([k.subclass("esri.widgets.Attribution")],c)}(k.declared(g))})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/contains ../../geometry/support/webMercatorUtils".split(" "),function(n,m,h,a,l,d,k,g,f,b,e,c){return function(d){function m(a){a=
d.call(this,a)||this;a._handles=new g;a._pendingAttributionItemsByLayerId={};a._attributionDataByLayerId={};a.items=new k;a.view=null;a._updateAttributionItems=a._updateAttributionItems.bind(a);return a}h(m,d);m.prototype.initialize=function(){this._handles.add(f.init(this,"view",this._viewWatcher))};m.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(m.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,
configurable:!0});m.prototype._viewWatcher=function(a){var b=this,c=this._handles;c&&c.remove();a&&(c.add([a.allLayerViews.on("change",function(a){b._addLayerViews(a.added);0<a.removed.length&&(a.removed.forEach(function(a){c.remove(a.uid)}),b._updateAttributionItems())}),f.init(a,"stationary",this._updateAttributionItems)]),this._addLayerViews(a.allLayerViews))};m.prototype._addLayerViews=function(a){var b=this;a.forEach(function(a){b._handles.has(a.uid)||b._handles.add(f.init(a,"suspended",b._updateAttributionItems),
a.uid)})};m.prototype._updateAttributionItems=function(){var a=this,b=[];this._getActiveLayerViews().forEach(function(c){var d=c.layer;if(!d.hasAttributionData){if(c=d.get("copyright")){var e=a._findItem(b,{layer:d,text:c});e||b.push({text:c,layer:d})}}else if(d&&d.tileInfo){var f=a._attributionDataByLayerId;if(f[d.uid]){if(c=a._getDynamicAttribution(f[d.uid],a.view,d))(e=a._findItem(b,{layer:d,text:c}))||b.push({text:c,layer:d})}else{var g=a._pendingAttributionItemsByLayerId;a._inProgress(g[d.uid])||
(g[d.uid]=d.fetchAttributionData().then(function(b){b=a._createContributionIndex(b,a._isBingLayer(d));delete g[d.uid];f[d.uid]=b;a._updateAttributionItems()}))}}});this._itemsChanged(this.items,b)&&(this.items.removeAll(),this.items.addMany(b))};m.prototype._itemsChanged=function(a,b){return a.length!==b.length||a.some(function(a,c){return a.text!==b[c].text})};m.prototype._inProgress=function(a){return a&&!a.isFulfilled()};m.prototype._getActiveLayerViews=function(){return this.get("view.allLayerViews").filter(function(a){return!a.suspended&&
a.get("layer.attributionVisible")})};m.prototype._findItem=function(a,b){var c=b.layer,d=b.text,e;a.some(function(a){var b=a.layer===c&&a.text===d;b&&(e=a);return b});return e};m.prototype._isBingLayer=function(a){return"bing-maps"===a.type};m.prototype._createContributionIndex=function(a,b){a=a.contributors;var d={};if(!a)return d;for(var e=0;e<a.length;e++){var f=a[e],g=f.coverageAreas;if(!g)return;for(var h=0;h<g.length;h++)for(var k=g[h],m=k.bbox,n=k.zoomMin-(b&&k.zoomMin?1:0),p=k.zoomMax-(b&&
k.zoomMax?1:0),k={extent:c.geographicToWebMercator({xmin:m[1],ymin:m[0],xmax:m[3],ymax:m[2],spatialReference:l.SpatialReference.WGS84}),attribution:f.attribution||"",score:null!=k.score?k.score:100,id:e};n<=p;n++)d[n]=d[n]||[],d[n].push(k)}d.maxKey=Math.max.apply(null,Object.keys(d));return d};m.prototype._getDynamicAttribution=function(a,b,d){var f=b.extent;d=d.tileInfo.scaleToZoom(b.scale);d=Math.min(a.maxKey,Math.round(d));if(!f||null==d||-1>=d)return"";a=a[d];var g=c.project(f.center.clone().normalize(),
b.spatialReference),k={};return a.filter(function(a){var b=!k[a.id]&&g&&e.extentContainsPoint(a.extent,g);b&&(k[a.id]=!0);return b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", ")};a([b.property({readOnly:!0,type:k})],m.prototype,"items",void 0);a([b.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);a([b.property()],m.prototype,"view",void 0);return m=a([b.subclass("esri.widgets.Attribution.AttributionViewModel")],
m)}(b.declared(d))})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Compass/nls/Compass ../core/accessorSupport/decorators ./Widget ./Compass/CompassViewModel ./support/widget".split(" "),function(n,m,h,a,l,d,k,g,f){return function(b){function e(a){a=b.call(this)||this;a.goToOverride=null;a.iconClass="esri-icon-locate-circled";a.label=l.widgetLabel;a.view=null;a.viewModel=new g;return a}h(e,b);e.prototype.reset=
function(){};e.prototype.render=function(){var a,b,d=this.viewModel,e=d.orientation,d=d.state,g="disabled"===d,k="compass"===("rotation"===d?"rotation":"compass"),d=g?-1:0,g=(a={},a["esri-disabled"]=g,a["esri-interactive"]=!g,a);a=(b={},b["esri-icon-compass"]=k,b["esri-icon-dial"]=!k,b);return f.tsx("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",g),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:d,"aria-label":l.reset,title:l.reset},f.tsx("span",
{"aria-hidden":"true",class:this.classes("esri-compass__icon",a),styles:this._toRotationTransform(e)}),f.tsx("span",{class:"esri-icon-font-fallback-text"},l.reset))};e.prototype._reset=function(){this.viewModel.reset()};e.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+a.z+"deg)"}};a([d.aliasOf("viewModel.goToOverride")],e.prototype,"goToOverride",void 0);a([d.property()],e.prototype,"iconClass",void 0);a([d.property()],e.prototype,"label",void 0);a([d.aliasOf("viewModel.view")],
e.prototype,"view",void 0);a([d.property({type:g}),f.renderable(["viewModel.orientation","viewModel.state"])],e.prototype,"viewModel",void 0);a([d.aliasOf("viewModel.reset")],e.prototype,"reset",null);a([f.accessibleHandler()],e.prototype,"_reset",null);return e=a([d.subclass("esri.widgets.Compass")],e)}(d.declared(k))})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../support/GoTo".split(" "),
function(n,m,h,a,l,d,k,g,f){return function(b){function e(a){a=b.call(this,a)||this;a._handles=new d;a.orientation={x:0,y:0,z:0};a.view=null;a._updateForCamera=a._updateForCamera.bind(a);a._updateForRotation=a._updateForRotation.bind(a);a._updateRotationWatcher=a._updateRotationWatcher.bind(a);return a}h(e,b);e.prototype.initialize=function(){this._handles.add(k.init(this,"view",this._updateRotationWatcher))};e.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(e.prototype,
"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return a&&(a.isWebMercator||a.isWGS84)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});e.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.callGoTo({target:a})}};e.prototype._updateForRotation=function(a){void 0!==
a&&null!==a&&(this.orientation={z:a})};e.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};e.prototype._updateRotationWatcher=function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(k.init(this,"view.rotation",this._updateForRotation)):this._handles.add(k.init(this,"view.camera",this._updateForCamera)))};a([g.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],e.prototype,"canShowNorth",null);
a([g.property()],e.prototype,"orientation",void 0);a([g.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],e.prototype,"state",null);a([g.property()],e.prototype,"view",void 0);a([g.property()],e.prototype,"reset",null);return e=a([g.subclass("esri.widgets.CompassViewModel")],e)}(g.declared(l,f))})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./NavigationToggle/nls/NavigationToggle ../core/accessorSupport/decorators ./Widget ./NavigationToggle/NavigationToggleViewModel ./support/widget".split(" "),
function(n,m,h,a,l,d,k,g,f){return function(b){function e(a){a=b.call(this)||this;a.iconClass="esri-icon-pan2";a.label=l.widgetLabel;a.view=null;a.viewModel=new g;return a}h(e,b);Object.defineProperty(e.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});e.prototype.toggle=function(){};e.prototype.render=function(){var a,b,d,e="disabled"===this.get("viewModel.state"),g="pan"===this.get("viewModel.navigationMode"),k=(a={},a["esri-disabled"]=
e,a["esri-navigation-toggle--horizontal"]="horizontal"===this.layout,a);a=(b={},b["esri-navigation-toggle__button--active"]=g,b);b=(d={},d["esri-navigation-toggle__button--active"]=!g,d);d=e?-1:0;return f.tsx("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",k),onclick:this._toggle,onkeydown:this._toggle,tabIndex:d,"aria-label":l.toggle,title:l.toggle},f.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--pan",
a)},f.tsx("span",{class:"esri-icon-pan"})),f.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--rotate",b)},f.tsx("span",{class:"esri-icon-rotate"})))};e.prototype._toggle=function(){this.toggle()};a([d.property()],e.prototype,"iconClass",void 0);a([d.property()],e.prototype,"label",void 0);a([d.property({value:"vertical"}),f.renderable()],e.prototype,"layout",null);a([d.aliasOf("viewModel.view"),f.renderable()],e.prototype,"view",void 0);
a([d.property({type:g}),f.renderable(["viewModel.state","viewModel.navigationMode"])],e.prototype,"viewModel",void 0);a([d.aliasOf("viewModel.toggle")],e.prototype,"toggle",null);a([f.accessibleHandler()],e.prototype,"_toggle",null);return e=a([d.subclass("esri.widgets.NavigationToggle")],e)}(d.declared(k))})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),
function(n,m,h,a,l,d,k,g){return function(f){function b(a){a=f.call(this,a)||this;a._handles=new d;a.navigationMode="pan";a.view=null;a.toggle=a.toggle.bind(a);return a}h(b,f);b.prototype.initialize=function(){this._handles.add(k.when(this,"view.inputManager",this._setNavigationMode.bind(this)))};b.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(b.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":
"disabled"},enumerable:!0,configurable:!0});b.prototype.toggle=function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};b.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"};a([g.property({dependsOn:["view.ready"],readOnly:!0})],b.prototype,"state",null);a([g.property()],b.prototype,"navigationMode",void 0);a([g.property()],b.prototype,"view",void 0);
a([g.property()],b.prototype,"toggle",null);return b=a([g.subclass("esri.widgets.NavigationToggleViewModel")],b)}(g.declared(l))})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Zoom/nls/Zoom ../core/accessorSupport/decorators ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel ./support/widget".split(" "),function(n,m,h,a,l,d,k,g,f,b){return function(e){function c(a){a=e.call(this)||this;a.iconClass="esri-icon-zoom-in-magnifying-glass";
a.label=l.widgetLabel;a.view=null;a.viewModel=new f;return a}h(c,e);c.prototype.postInitialize=function(){this._zoomInButton=new g({action:this.zoomIn,iconClass:"esri-icon-plus",title:l.zoomIn});this._zoomOutButton=new g({action:this.zoomOut,iconClass:"esri-icon-minus",title:l.zoomOut})};Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});c.prototype.render=function(){var a,c=this.viewModel,d=(a={},a["esri-zoom--horizontal"]=
"horizontal"===this.layout,a);this._zoomInButton.enabled="ready"===c.state&&c.canZoomIn;this._zoomOutButton.enabled="ready"===c.state&&c.canZoomOut;return b.tsx("div",{class:this.classes("esri-zoom esri-widget",d)},this._zoomInButton.render(),this._zoomOutButton.render())};c.prototype.zoomIn=function(){};c.prototype.zoomOut=function(){};a([d.property()],c.prototype,"iconClass",void 0);a([d.property()],c.prototype,"label",void 0);a([d.property({value:"vertical"}),b.renderable()],c.prototype,"layout",
null);a([d.aliasOf("viewModel.view"),b.renderable()],c.prototype,"view",void 0);a([d.property({type:f}),b.renderable(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],c.prototype,"viewModel",void 0);a([d.aliasOf("viewModel.zoomIn")],c.prototype,"zoomIn",null);a([d.aliasOf("viewModel.zoomOut")],c.prototype,"zoomOut",null);return c=a([d.subclass("esri.widgets.Zoom")],c)}(d.declared(k))})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Widget ../support/widget".split(" "),
function(n,m,h,a,l,d,k){return function(d){function f(){var a=null!==d&&d.apply(this,arguments)||this;a.enabled=!0;a.iconClass="";a.title="";return a}h(f,d);f.prototype.render=function(){var a,d,c=this.enabled?0:-1,f=(a={},a["esri-disabled"]=!this.enabled,a["esri-interactive"]=this.enabled,a);a=(d={},d[this.iconClass]=!!this.iconClass,d);return k.tsx("div",{bind:this,class:this.classes("esri-widget--button esri-widget",f),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:c,
title:this.title},k.tsx("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",a)}),k.tsx("span",{class:"esri-icon-font-fallback-text"},this.title))};f.prototype._triggerAction=function(){this.action.call(this)};a([l.property()],f.prototype,"action",void 0);a([l.property(),k.renderable()],f.prototype,"enabled",void 0);a([l.property({readOnly:!1}),k.renderable()],f.prototype,"iconClass",void 0);a([l.property(),k.renderable()],f.prototype,"title",void 0);a([k.accessibleHandler()],
f.prototype,"_triggerAction",null);return f=a([l.subclass("esri.widgets.IconButton")],f)}(l.declared(d))})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ZoomConditions2D ./ZoomConditions3D".split(" "),function(n,m,h,a,l,d,k,g){return function(f){function b(a){a=f.call(this,a)||this;a.canZoomIn=null;a.canZoomOut=null;a.zoomIn=a.zoomIn.bind(a);
a.zoomOut=a.zoomOut.bind(a);return a}h(b,f);b.prototype.destroy=function(){this.view=null};Object.defineProperty(b.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"view",{set:function(a){a?"2d"===a.type?this._zoomConditions=new k({view:a}):"3d"===a.type&&(this._zoomConditions=new g):this._zoomConditions=null;this._set("view",a)},enumerable:!0,configurable:!0});b.prototype.zoomIn=function(){this.canZoomIn&&
this._zoomToFactor(.5)};b.prototype.zoomOut=function(){this.canZoomOut&&this._zoomToFactor(2)};b.prototype._zoomToFactor=function(a){if("ready"===this.state){var b=this.view;"3d"===this.view.type?b.goTo({zoomFactor:1/a}):b.goTo({scale:this.get("view.scale")*a})}};a([d.property()],b.prototype,"_zoomConditions",void 0);a([d.property({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],b.prototype,"canZoomIn",void 0);a([d.property({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],b.prototype,"canZoomOut",
void 0);a([d.property({dependsOn:["view.ready"],readOnly:!0})],b.prototype,"state",null);a([d.property()],b.prototype,"view",null);a([d.property()],b.prototype,"zoomIn",null);a([d.property()],b.prototype,"zoomOut",null);return b=a([d.subclass("esri.widgets.Zoom.ZoomViewModel")],b)}(d.declared(l))})},"esri/widgets/Zoom/ZoomConditions2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(n,m,h,a,l,d){return function(k){function g(){return null!==k&&k.apply(this,arguments)||this}h(g,k);Object.defineProperty(g.prototype,"canZoomIn",{get:function(){var a=this.get("view.animation.target.scale")||this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"canZoomOut",{get:function(){var a=this.get("view.animation.target.scale")||this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");
return 0===b||a<b},enumerable:!0,configurable:!0});a([d.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],g.prototype,"canZoomIn",null);a([d.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],g.prototype,"canZoomOut",null);a([d.property()],g.prototype,"view",void 0);return g=a([d.subclass("esri.widgets.Zoom.ZoomConditions2D")],g)}(d.declared(l))})},"esri/widgets/Zoom/ZoomConditions3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(n,m,h,a,l,d){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;a.canZoomIn=!0;a.canZoomOut=!0;return a}h(g,k);a([d.property({readOnly:!0})],g.prototype,"canZoomIn",void 0);a([d.property({readOnly:!0})],g.prototype,"canZoomOut",void 0);return g=a([d.subclass("esri.widgets.Zoom.ZoomConditions3D")],g)}(d.declared(l))})},"esri/views/2d/layers/GraphicsLayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Handles ../../../core/promiseUtils ../../../core/accessorSupport/decorators ./LayerView2D ./support/GraphicsView2D".split(" "),
function(n,m,h,a,l,d,k,g,f){return function(b){function e(){var a=null!==b&&b.apply(this,arguments)||this;a._handles=new l;a.graphicsView=new f;a.container=a.graphicsView.container;return a}h(e,b);e.prototype.hitTest=function(a,b){return this.graphicsView.hitTest(a,b)};e.prototype.attach=function(){var a=this;this.layer.createGraphicsController({layerView:this}).then(function(b){a._handles.add(a.layer.on("graphic-update",function(b){return a.graphicsView.graphicUpdateHandler(b)}));a.graphicsView.view=
a.view;a.graphicsView.graphics=b.graphics})};e.prototype.detach=function(){this.graphicsView.graphics=null;this._handles.removeAll()};e.prototype.update=function(a){};e.prototype.moveStart=function(){};e.prototype.viewChange=function(){};e.prototype.moveEnd=function(){};e.prototype.queryGraphics=function(){return d.resolve(this.graphicsView.graphics)};return e=a([k.subclass("esri.views.2d.layers.GraphicsLayerView2D")],e)}(k.declared(g))})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../layers/LayerView".split(" "),
function(n,m,h,a,l,d,k){return function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;a.attached=!1;a.lastUpdateId=-1;a.moving=!1;a.updateRequested=!1;return a}h(f,g);f.prototype.initialize=function(){var a=this;this.when(function(){a.requestUpdate()});l.init(this,"suspended",function(b){a.container.visible=!b;!b&&a.updateRequested&&a.view.requestLayerViewUpdate(a)},!0);l.init(this,"fullOpacity",function(b){a.container.opacity=b},!0);var d=function(){this.notifyChange("rendering")}.bind(this);
this.container.on("post-render",d);this.container.on("will-render",d)};f.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.updateRequested=!1;this.layer=null};Object.defineProperty(f.prototype,"rendering",{get:function(){return this.isRendering()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0});f.prototype.requestUpdate=
function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))};f.prototype.processUpdate=function(a){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",a),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(a)))};f.prototype.isUpdating=function(){return!1};f.prototype.isRendering=function(){return this.attached&&(this.moving||this.container.renderRequested)};f.prototype.canResume=
function(){var a=this.inherited(arguments),d=this.layer;if(a&&null!=d.minScale&&null!=d.minScale){var a=this.view.scale,c=d.minScale,d=d.maxScale,f=!c,g=!d;!f&&a<=c&&(f=!0);!g&&a>=d&&(g=!0);a=f&&g}return a};a([d.property()],f.prototype,"attached",void 0);a([d.property()],f.prototype,"container",void 0);a([d.property()],f.prototype,"moving",void 0);a([d.property({dependsOn:["moving"]})],f.prototype,"rendering",null);a([d.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],f.prototype,
"suspended",void 0);a([d.property({readOnly:!0})],f.prototype,"updateParameters",void 0);a([d.property()],f.prototype,"updateRequested",void 0);a([d.property({dependsOn:["updateRequested","attached"]})],f.prototype,"updating",null);a([d.property()],f.prototype,"view",void 0);return f=a([d.subclass("esri.views.2d.layers.LayerView2D")],f)}(d.declared(k))})},"esri/views/2d/layers/TileLayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../engine/BitmapContainer ../engine/BitmapSource ../engine/BitmapTile ../engine/Canvas2DContainer ./LayerView2D ../tiling/enums ../tiling/TileInfoView ../tiling/TileQueue ../tiling/TileStrategy ../../layers/RefreshableLayerView".split(" "),
function(n,m,h,a,l,d,k,g,f,b,e,c,t,p,v,r,q){var u=[0,0];return function(c){function m(){var a=null!==c&&c.apply(this,arguments)||this;a._tileStrategy=null;a._tileInfoView=null;a._fetchQueue=null;a._tileRequests=new Map;a.container=new e;a.layer=null;return a}h(m,c);m.prototype.initialize=function(){var a=this.layer.tileInfo,a=a&&a.spatialReference,b;a||(b=new l("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));a.equals(this.view.spatialReference)||
(b=new l("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}));b&&this.addResolvingPromise(d.reject(b))};m.prototype.getPopupData=function(a){var b=this.layer;if("tile"!==b.type)return[];var c=this.view.scale;return b.allSublayers.toArray().filter(function(a){var b=0===a.minScale||c<=a.minScale,d=0===a.maxScale||c>=a.maxScale;return a.popupTemplate&&a.popupEnabled&&a.visible&&b&&d}).map(function(b){var c=b.createQuery();
c.geometry=a;c.outFields=b.popupTemplate.requiredFields;return b.queryFeatures(c).then(function(a){return a.features})})};m.prototype.hitTest=function(a,b){return null};m.prototype.update=function(a){this._fetchQueue.pause();this._fetchQueue.state=a.state;this._tileStrategy.update(a);this._fetchQueue.resume();this.notifyChange("updating")};m.prototype.attach=function(){var a=this;this._tileContainer=new g;this.container.addChild(this._tileContainer);this._tileInfoView=new p(this.layer.tileInfo,this.layer.fullExtent);
this._fetchQueue=new v({tileInfoView:this._tileInfoView,tileServers:"tileServers"in this.layer?this.layer.tileServers:null,concurrency:this.layer.url&&-1!==this.layer.url.indexOf("tiles.arcgis.com")?12:6,process:function(b,c){return a.fetchTile(b,c)}});this._tileStrategy=new r({cachePolicy:"keep",acquireTile:function(b){return a.acquireTile(b)},releaseTile:function(b){return a.releaseTile(b)},tileInfoView:this._tileInfoView})};m.prototype.detach=function(){this._tileStrategy.destroy();this._fetchQueue.clear();
this.container.removeChild(this._tileContainer);this._fetchQueue=this._tileStrategy=this._tileInfoView=this._tileContainer=null};m.prototype.moveStart=function(){this.requestUpdate()};m.prototype.viewChange=function(){this.requestUpdate()};m.prototype.moveEnd=function(){this.requestUpdate()};m.prototype.doRefresh=function(){var a=this;this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach(function(b){return a._enqueueTileFetch(b)}),this.notifyChange("updating"))};
m.prototype.isUpdating=function(){var a=!0;this._tileRequests.forEach(function(b){a=a&&b.isFulfilled()});return!a};m.prototype.getTileBounds=function(a,b){return this._tileInfoView.getTileBounds(a,b)};m.prototype.getTileCoords=function(a,b){return this._tileInfoView.getTileCoords(a,b)};m.prototype.getTileResolution=function(a){return this._tileInfoView.getTileResolution(a)};m.prototype.acquireTile=function(a){var c=b.default.pool.acquire();c.key.set(a);a=this._tileInfoView.getTileCoords(u,c.key);
c.x=a[0];c.y=a[1];c.resolution=this._tileInfoView.getTileResolution(c.key);a=this._tileInfoView.tileInfo.size;c.width=a[0];c.height=a[1];this._enqueueTileFetch(c);this.requestUpdate();return c};m.prototype.releaseTile=function(a){var c=this,d=this._tileRequests.get(a);d&&!d.isFulfilled()&&d.cancel();this._tileRequests.delete(a);this._tileContainer.removeChild(a);a.once("detach",function(){b.default.pool.release(a);c.requestUpdate()});this.requestUpdate()};m.prototype.fetchTile=function(a,b){var c=
this;if(b="tilemapCache"in this.layer?this.layer.tilemapCache:null){var d=a.level,e=a.row,f=a.col;return b.fetchAvailabilityUpsample(d,e,f,a).then(function(){return c._fetchImage(a)}).catch(function(){a.level=d;a.row=e;a.col=f;return c._fetchImage(a)})}return this._fetchImage(a)};m.prototype._enqueueTileFetch=function(a){var b=this;if(!this._fetchQueue.has(a.key)){var c=this._fetchQueue.push(a.key).then(function(c){a.status=t.TileStatus.READY;a.source=c;a.once("attach",function(){return b.requestUpdate()});
b._tileContainer.addChild(a);b.requestUpdate()});this._tileRequests.set(a,c)}};m.prototype._fetchImage=function(a){var b=this;return this.layer.fetchTile(a.level,a.row,a.col,{timestamp:this.refreshTimestamp}).then(function(c){var d=f.default.pool.acquire(c);c=b.getTileCoords(u,a);d.x=c[0];d.y=c[1];d.resolution=b.getTileResolution(a);return d})};return m=a([k.subclass("esri.views.2d.layers.TileLayerView2D")],m)}(k.declared(c,q))})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../ViewState ../viewStateUtils ./Container".split(" "),
function(n,m,h,a,l,d,k){var g=[0,0];return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._childrenCanvas=null;b._childrenRenderParameters={context:null,pixelRatio:1,state:new l,stationary:!0};return b}h(b,a);b.prototype.attach=function(b){this._childrenCanvas||(this._childrenCanvas=document.createElement("canvas"),this._childrenRenderParameters.context=this._childrenCanvas.getContext("2d"));return a.prototype.attach.call(this,b)};b.prototype.detach=function(b){a.prototype.detach.call(this,
b);this._childrenCanvas=null;this._childrenRenderParameters.context=null};b.prototype.doRender=function(b){this.visible&&a.prototype.doRender.call(this,b)};b.prototype.prepareChildrenRenderParameters=function(a){var b=this._childrenCanvas,e=this._childrenRenderParameters,f=a.state,k=f.pixelRatio,h=e.state;h.copy(f);var l=d.getOuterSize(g,f),f=l[0],l=l[1],f=f*k,l=l*k;h.size=g;h.viewpoint.rotation=0;b.width!==f||b.height!==l?(b.width=f,b.height=l):e.context.clearRect(0,0,f,l);e.pixelRatio=a.pixelRatio;
return e};b.prototype.beforeRenderChildren=function(a,b){this.sortChildren(function(a,b){return b.resolution-a.resolution})};b.prototype.afterRenderChildren=function(a,b){var c=a.context;a=a.state;var d=b.context;b=b.state;0===a.rotation?c.drawImage(d.canvas,0,0):(c.save(),c.translate(.5*a.width,.5*a.height),c.rotate(a.rotation*Math.PI/180),c.translate(.5*-a.width,.5*-a.height),c.drawImage(d.canvas,.5*(a.width-b.width),.5*(a.height-b.height)),c.restore())};return b}(k)})},"esri/views/2d/viewStateUtils":function(){define(["require",
"exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});var h=Math.PI/180;m.snapToPixel=function(a,h,d){var k=d.resolution;d=d.size;a[0]=k*(Math.round(h[0]/k)+d[0]%2*.5);a[1]=k*(Math.round(h[1]/k)+d[1]%2*.5);return a};m.getOuterSize=function(a,l){var d=l.rotation*h,k=Math.abs(Math.cos(d)),d=Math.abs(Math.sin(d)),g=l.size;l=g[0];g=g[1];a[0]=Math.round(g*d+l*k);a[1]=Math.round(g*k+l*d);return a};m.getBBox=function(a,h,d,k){var g=h[0];h=h[1];var f=k[0];k=k[1];d*=.5;a[0]=g-d*f;a[1]=
h-d*k;a[2]=g+d*f;a[3]=h+d*k;return a};m.bboxIntersects=function(a,h){var d=a[1],k=a[2],g=a[3],f=h[0],b=h[1],e=h[3];return!(a[0]>h[2]||k<f||d>e||g<b)}})},"esri/views/2d/engine/BitmapSource":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/ObjectPool","../support/Evented"],function(n,m,h,a,l){function d(a){return a&&"render"in a}Object.defineProperty(m,"__esModule",{value:!0});n=function(k){function g(a){var b=k.call(this)||this;b._height=0;b.pixelRatio=
1;b.resolution=0;b.rotation=0;b._width=0;b.x=0;b.y=0;b.data=a;return b}h(g,k);g.prototype.release=function(){this.data=null};Object.defineProperty(g.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a;this._width=this._height=0;a&&!d(a)&&(a instanceof HTMLImageElement?(this._width=a.naturalWidth,this._height=a.naturalHeight):0<a.width&&0<a.height&&(this._width=a.width,this._height=a.height))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){return d(this._data)?
this._data.height:this._height},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"ready",{get:function(){return d(this._data)?0<this._data.width&&0<this._data.height:0<this._width},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"width",{get:function(){return d(this.data)?this._data.width:this._width},enumerable:!0,configurable:!0});g.prototype.draw=function(a,b,e,c,g,h,k,l,m){if(this.ready)if(d(this._data))this._data.render(a,b,e,c,g,h,k,l,m);else{var f=this._data;
f&&!("render"in f)&&c&&g&&l&&m&&a.drawImage(this._data,b,e,c,g,h,k,l,m)}};g.pool=new a(g,!0);return g}(l.default);m.default=n})},"esri/views/2d/support/Evented":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=function(){function h(){this._listeners={}}h.prototype.on=function(a,h){var d=this;null==this._listeners[a]&&(this._listeners[a]=new Map);var k={};this._listeners[a].set(k,h);return{remove:function(){return d._listeners[a].delete(k)}}};
h.prototype.once=function(a,h){var d=this.on(a,function(a){d.remove();h(a)});return d};h.prototype.emit=function(a,h){this.hasEventListener(a)&&this._listeners[a].forEach(function(a){return a(h)})};h.prototype.hasEventListener=function(a){return null!=this._listeners[a]&&0<this._listeners[a].size};return h}();m.default=n})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/ObjectPool ../tiling ./Bitmap ./Tiled ../tiling/enums".split(" "),
function(n,m,h,a,l,d,k,g,f){Object.defineProperty(m,"__esModule",{value:!0});n=function(a){function b(b){b=a.call(this,b)||this;b.key=new d.TileKey(0,0,0,0);return b}h(b,a);b.prototype.acquire=function(a){};b.prototype.release=function(){this.key.set(0,0,0,0);this.status=f.TileStatus.INITIALIZED;this.source=null};b.pool=new l(b,!0);return b}(g(k));m.default=n})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),
function(n,m,h,a,l,d){Object.defineProperty(m,"__esModule",{value:!0});m.TileInfoView=h;m.TileKey=a;m.TileQueue=l;m.TileStrategy=d})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/QueueProcessor ../../../core/accessorSupport/decorators ../libs/gl-matrix/vec2".split(" "),function(n,m,h,a,l,d,k,g){function f(a,b){a.length=0;b.forEach(function(b){return a.push(b)});
return a}var b=new Set,e=[],c=new Map,t=[0,0];return function(l){function m(a){a=l.call(this,a)||this;a._keysToRequests=new Map;a.concurrency=6;a.process=null;a.strategy="scale-first";a.tileInfoView=null;a.tileServers=null;return a}h(m,l);m.prototype.initialize=function(){var a=this,b="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this),c=this.tileServers,e=this.concurrency,f=this.process;this._queues=c&&0<c.length?c.map(function(c){return new d({concurrency:e,
process:function(b){b=a._keysToRequests.get(b);return f(b,c)},peeker:b})}):[new d({concurrency:e,process:function(b){b=a._keysToRequests.get(b);return f(b)},peeker:b})]};Object.defineProperty(m.prototype,"length",{get:function(){return this._queues.reduce(function(a,b){return a+b.length},0)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"onGoingCount",{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"updating",
{get:function(){return 0<this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});m.prototype.clear=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].clear();this._keysToRequests.clear();this.notifyChange("updating")};m.prototype.find=function(a,b){var c=this;b=0;for(var d=this._queues;b<d.length;b++){var e=d[b].find(function(b){return a(c._keysToRequests.get(b).key)});if(e)return e}};m.prototype.getPromise=function(a){a="string"===typeof a?a:a.id;for(var b=0,c=this._queues;b<c.length;b++){var d=
c[b].get(a);if(d)return d}};m.prototype.getRequest=function(a){return this._keysToRequests.get("string"===typeof a?a:a.id)};m.prototype.has=function(a){return"string"===typeof a?this._keysToRequests.has(a):this._keysToRequests.has(a.id)};m.prototype.isOngoing=function(a){var b="string"===typeof a?a:a.id;return this.has(b)&&this._queues.some(function(a){return a.isOngoing(b)})};m.prototype.pause=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].pause()};m.prototype.push=function(a){var b=this,
c=a.key.id;if(this.has(c))return this.getPromise(c);var d=this._queues[a.key.row%this._queues.length].push(c),e=function(){b._keysToRequests.delete(c);b.notifyChange("updating")};this._keysToRequests.set(c,a);d.then(e,e);this.notifyChange("updating");return d};m.prototype.reset=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].reset();this.notifyChange("updating")};m.prototype.resume=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].resume()};m.prototype._peekByScaleFirst=function(a){if(!this.state)return a[0];
for(var d=this.tileInfoView,g=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,k=0;k<a.length;k++){var l=this._keysToRequests.get(a[k]),m=this.tileInfoView.getTileScale(l.key);c.has(m)||(c.set(m,[]),g=Math.max(m,g),h=Math.min(m,h));c.get(m).push(l.key);b.add(m)}var n=this.state.scale;c.has(n)||(f(e,b),e.sort(),n=e.reduce(function(a,b,c,d){return Math.abs(b-n)<Math.abs(a-n)?b:a},e[0]));n=Math.min(n,g);n=Math.max(n,h);a=c.get(n);var p=d.getClosestInfoForScale(n),t=p.getColumnForX(this.state.center[0]),
r=p.getRowForY(this.state.center[1]);a.sort(function(a,b){var c=p.denormalizeCol(a.col,a.world),d=p.denormalizeCol(b.col,b.world);return Math.sqrt((t-c)*(t-c)+(r-a.row)*(r-a.row))-Math.sqrt((t-d)*(t-d)+(r-b.row)*(r-b.row))});b.clear();c.clear();return a[0].id};m.prototype._peekByCenterFirst=function(a){if(!this.state)return a[0];for(var b=this.tileInfoView,c=this.state.center,d=Number.POSITIVE_INFINITY,e=null,f=0;f<a.length;f++){var h=this._keysToRequests.get(a[f]);b.getTileCoords(t,h.key);var k=
g.distance(t,c);k<d&&(d=k,e=h.key)}return e.id};a([k.property({constructOnly:!0})],m.prototype,"concurrency",void 0);a([k.property({constructOnly:!0})],m.prototype,"process",void 0);a([k.property()],m.prototype,"state",void 0);a([k.property({constructOnly:!0})],m.prototype,"strategy",void 0);a([k.property({constructOnly:!0})],m.prototype,"tileInfoView",void 0);a([k.property({constructOnly:!0})],m.prototype,"tileServers",void 0);a([k.property({readOnly:!0})],m.prototype,"updating",null);return m=a([k.subclass()],
m)}(k.declared(l))})},"esri/core/QueueProcessor":function(){define(["require","exports","dojo/Deferred","./Queue","./scheduling"],function(n,m,h,a,l){return function(){function d(d){this._apiPromises=new Map;this._processingItems=new Map;this._isPaused=!1;this._scheduledNextHandle=null;this.concurrency=1;this.ordered=!1;d.concurrency&&(this.concurrency=d.concurrency);this.ordered=!!d.ordered;this._queue=new a(d.peeker?{peeker:d.peeker}:void 0);this.process=d.process}Object.defineProperty(d.prototype,
"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});d.prototype.clear=function(){this._queue.clear();var a=[];this._processingItems.forEach(function(d){return a.push(d.resultPromise)});this._processingItems.clear();a.forEach(function(a){return a.cancel()});a.length=0;this._apiPromises.forEach(function(d){return a.push(d)});this._apiPromises.clear();a.forEach(function(a){return a.cancel()});this._cancelNext()};d.prototype.find=function(a,d){var f=
this,b=void 0;this._apiPromises.forEach(function(e,c){a.call(d,c)&&(b=f._apiPromises.get(c).promise)});return b};d.prototype.get=function(a){return(a=this._apiPromises.get(a))&&a.promise||void 0};d.prototype.isOngoing=function(a){return this._processingItems.has(a)};d.prototype.has=function(a){return this._apiPromises.has(a)};d.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};d.prototype.push=function(a){var d=this;if(this._apiPromises.has(a))return this._apiPromises.get(a).promise;
var f=new h(function(b){var e=d._processingItems.get(a);e?e.resultPromise.cancel(b):(d._remove(a),d._scheduleNext())});this._add(a,f);this._scheduleNext();return f.promise};d.prototype.reset=function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var d=0;d<a.length;d++){var f=a[d];f.resultPromise.isFulfilled()?this._processReset(f):(f.isReset=!0,f.resultPromise.cancel())}};d.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};
d.prototype._scheduleNext=function(){var a=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=l.schedule(function(){a._scheduledNextHandle=null;a._next()}))};d.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};d.prototype._processResult=function(a,d){this._remove(a.item);this._scheduleNext();a.dfd.resolve(d)};d.prototype._processError=function(a,d){a.isReset?this._processReset(a):(this._remove(a.item),
this._scheduleNext(),a.dfd.reject(d))};d.prototype._processReset=function(a){this._remove(a.item);this._add(a.item,a.dfd);this._scheduleNext()};d.prototype._processOrdered=function(a,d){var f=this,b=!1;if(a.isReset)this._processReset(a);else{a.result=d;this._itemsToProcess||(this._itemsToProcess=[]);this._processingItems.forEach(function(a){b||(a.result?f._itemsToProcess.push(a):b=!0)});a=0;for(d=this._itemsToProcess;a<d.length;a++){var e=d[a];!1===e.result.ok?this._processError(e,e.result.error):
this._processResult(e,e.result.value)}this._itemsToProcess.length=0}};d.prototype._process=function(a){var d=this;if(null!=a){var f=this._apiPromises.get(a),b=this.process(a);if(b&&"function"===typeof b.then){var e={item:a,resultPromise:b,result:null,dfd:f,isReset:!1};this._processingItems.set(a,e);this.ordered?b.then(function(a){return d._processOrdered(e,{ok:!0,value:a})},function(a){return d._processOrdered(e,{ok:!1,error:a})}):b.then(function(a){return d._processResult(e,a)},function(a){return d._processError(e,
a)})}else f.resolve(b),this._remove(a)}};d.prototype._add=function(a,d){this._apiPromises.set(a,d);this._queue.push(a)};d.prototype._remove=function(a){this._queue.remove(a);this._apiPromises.delete(a);this._processingItems.delete(a)};d.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};return d}()})},"esri/core/Queue":function(){define(["require","exports"],function(n,m){return function(){function h(a){this._items=[];this._itemSet=
new Set;this._peeker=function(a){return a[0]};this._length=0;a&&a.peeker&&(this._peeker=a.peeker)}Object.defineProperty(h.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0});h.prototype.clear=function(){this._itemSet.clear();this._length=this._items.length=0};h.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)};h.prototype.push=function(a){this.contains(a)||this._add(a)};h.prototype.contains=function(a){return 0<this._length&&this._itemSet.has(a)};
h.prototype.pop=function(){if(0!==this._length){var a=this.peek();this._remove(a);return a}};h.prototype.remove=function(a){this.contains(a)&&this._remove(a)};h.prototype._add=function(a){this._items.push(a);this._itemSet.add(a);this._length++};h.prototype._remove=function(a){this._itemSet.delete(a);this._items.splice(this._items.indexOf(a),1);this._length--};return h}()})},"esri/views/2d/tiling/TileStrategy":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./TileKey"],
function(n,m,h,a){var l=new a(0,0,0,0),d=new Map,k=[],g=[];return function(){function a(a){this._previousResolution=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);null!=a.buffer&&(this.buffer=a.buffer)}a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var b=this,c=this.tileIndex,
f=this.tileInfoView.getTileCoverage(a.state,this.buffer);if(f){var h=f.spans,m=f.lodInfo,n=m.level,q=a.state.resolution,u=!a.stationary&&q>this._previousResolution;this._previousResolution=q;c.forEach(function(a){return a.visible=!0});this.tiles.length=0;d.clear();var A=0,z=0;if(0<h.length)for(var x=0;x<h.length;x++){a=h[x];for(var y=a.row,B=a.colTo,w=a.colFrom;w<=B;w++)A++,a=l.set(n,y,m.normalizeCol(w),m.getWorldForColumn(w)).id,c.has(a)?(q=c.get(a),q.attached?(d.set(a,q),z++):q.attached||u||this._addParentTile(a,
d)):(q=this.acquireTile(l),this.tileIndex.set(a,q),u||this._addParentTile(a,d))}var H=z===A;g.length=0;k.length=0;c.forEach(function(a,c){l.set(c);if(!d.has(c)){var e=b.tileInfoView.intersects(f,l);!e||!u&&H?"purge"===b.cachePolicy?l.level===n&&e||k.push(c):(l.level>n||!e)&&k.push(c):a.attached?g.push(c):l.level>n&&k.push(c)}});for(h=0;h<g.length;h++)a=g[h],(q=c.get(a))&&q.attached&&d.set(a,q);for(h=0;h<k.length;h++)a=k[h],q=c.get(a),this.releaseTile(q),c["delete"](a);d.forEach(function(a){return b.tiles.push(a)});
c.forEach(function(a){d.has(a.key.id)||(a.visible=!1)});g.length=0;k.length=0;d.clear();return H}};a.prototype.clear=function(){var a=this,d=this.tileIndex;d.forEach(function(b){a.releaseTile(b)});d.clear()};a.prototype._addParentTile=function(a,d){for(var b=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)&&(b=this.tileIndex.get(a))&&b.attached){d.has(b.key.id)||d.set(b.key.id,b);break}}};return a}()})},"esri/views/2d/engine/Bitmap":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(n,m,h,a){var l=[0,0];return function(a){function d(d){var f=a.call(this)||this;f.height=0;f.resolution=0;f.rotation=0;f._source=null;f._sourceHandle=null;f.width=0;f.x=0;f.y=0;f.source=d;f.requestRender=f.requestRender.bind(f);return f}h(d,a);Object.defineProperty(d.prototype,"source",{get:function(){return this._source},set:function(a){this._sourceHandle&&(this._sourceHandle.remove(),this._sourceHandle=null);if(this._source=
a)this._sourceHandle=this._source.on("update",this.requestRender);this.requestRender()},enumerable:!0,configurable:!0});d.prototype.doRender=function(a){this.source&&this.source.ready&&this.renderCanvas2D(a)};d.prototype.renderCanvas2D=function(a){var d=this.source,b=a.context,e=a.state;a=e.rotation;var c=this.resolution/e.resolution*e.pixelRatio;if(!(.05>c)){b.save();var g=e.toScreen(l,this.x,this.y),e=g[0],g=g[1];.99<c&&1.01>c?b.translate(Math.round(e),Math.round(g)):(b.translate(e,g),b.scale(c,
c));a&&b.rotate(a*Math.PI/180);d.rotation&&(b.translate(.5*this.width,.5*this.height),b.rotate(-d.rotation*Math.PI/180),b.translate(.5*-this.width,.5*-this.height));g=d.resolution||this.resolution;a=(this.x-d.x)/g;c=-(this.y-d.y)/g;e=this.resolution/g*(d.width||this.width);g=this.resolution/g*(d.height||this.height);b.clearRect(0,0,this.width,this.height);d.draw(b,Math.round(a),Math.round(c),Math.round(e),Math.round(g),0,0,this.width,this.height);b.restore()}};return d}(a)})},"esri/views/2d/engine/Tiled":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./Evented","../tiling/enums"],function(n,m,h,a,l){return function(d){d=function(a){function d(){for(var d=0;d<arguments.length;d++);d=a.call(this)||this;d.status=l.TileStatus.INITIALIZED;return d}h(d,a);return d}(d);return a.EventedMixin(d)}})},"esri/views/2d/tiling/enums":function(){define(["require","exports"],function(n,m){Object.defineProperty(m,"__esModule",{value:!0});n=m.TileStatus||(m.TileStatus={});n[n.INITIALIZED=0]="INITIALIZED";n[n.NO_DATA=
1]="NO_DATA";n[n.READY=2]="READY";n[n.MODIFIED=3]="MODIFIED";n[n.INVALID=4]="INVALID"})},"esri/views/2d/engine/Canvas2DContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/promiseUtils ../ViewState ./Container ../../support/screenshotUtils".split(" "),function(n,m,h,a,l,d,k){return function(d){function f(){var a=null!==d&&d.apply(this,arguments)||this;a._childrenRenderParameters={context:null,pixelRatio:1,state:new l,stationary:!0};a.hidpi=!1;return a}
h(f,d);f.prototype.createElement=function(){var a=document.createElement("canvas");a.setAttribute("class","esri-display-object");return a};f.prototype.setElement=function(a){this.element=a};f.prototype.takeScreenshot=function(b){var d=this._childrenRenderParameters.state,c={context:null,pixelRatio:b.pixelRatio,state:new l,stationary:!0};c.opacity=this._childrenRenderParameters.opacity;c.state.copy(d);var f=b.framebufferWidth,g=b.framebufferHeight,d=b.region,h=document.createElement("canvas");h.width=
f;h.height=g;c.context=h.getContext("2d");this.beforeRenderChildren(c,c);void 0!==b.rotation&&null!==b.rotation?(f=c.state,g=f.clone(),g.viewpoint.rotation=b.rotation,c.state=g,this.renderChildren(c),c.state=f):this.renderChildren(c);this.afterRenderChildren(c,c);var m;try{m=c.context.getImageData(d.x,d.y,d.width,d.height)}catch(q){return a.reject(q)}return a.resolve(k.encodeResult(m,b,h,{flipY:!1,premultipliedAlpha:!1}))};f.prototype.doRender=function(a){var b=this.element,c=b.style;if(this.visible){var f=
a.state,g=a.pixelRatio,h=f.width,f=f.height;b.width=h*(this.hidpi?g:1);b.height=f*(this.hidpi?g:1);c.display="block";c.opacity=""+Math.min(this.opacity,this.parent.opacity);c.width=h+"px";c.height=f+"px";d.prototype.doRender.call(this,a)}else c.display="none"};f.prototype.prepareChildrenRenderParameters=function(a){var b=this._childrenRenderParameters;b.context=this.element.getContext("2d");b.pixelRatio=a.pixelRatio;b.state.copy(a.state);b.state.pixelRatio=this.hidpi?a.pixelRatio:1;b.stationary=a.stationary;
return b};f.prototype.beforeRenderChildren=function(a,d){a=d.context;var b=d.state;a.save();if(b.spatialReference.isWrappable){var e=b.width;d=b.height;var f=b.pixelRatio,g=this.hidpi?f:1,f=b.rotation*Math.PI/180,h=Math.round(e*g*Math.abs(Math.cos(f))+d*g*Math.abs(Math.sin(f))),b=b.worldScreenWidth*g;b<h&&(e=e*g*.5,d=d*g*.5,f&&(a.translate(e,d),a.rotate(f),a.translate(-e,-d)),a.beginPath(),a.rect(e-.5*b,d-.5*h,b,h),a.closePath(),f&&(a.translate(e,d),a.rotate(-f),a.translate(-e,-d)),a.clip("evenodd"))}};
f.prototype.afterRenderChildren=function(a,d){d.context.restore()};f.prototype.renderChild=function(a,d){d.context.save();a.processRender(d);d.context.restore()};return f}(d)})},"esri/views/layers/RefreshableLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(n,m,h,a,l,d){return function(k){function g(){var a=null!==k&&k.apply(this,arguments)||this;
a.refreshTimestamp=null;return a}h(g,k);g.prototype.refresh=function(a){void 0===a&&(a=Date.now());this._set("refreshTimestamp",a);this.doRefresh&&this.doRefresh()};a([d.property()],g.prototype,"layer",void 0);a([d.aliasOf("layer.refreshInterval")],g.prototype,"refreshInterval",void 0);a([d.property({readOnly:!0})],g.prototype,"refreshTimestamp",void 0);return g=a([d.subclass("esri.layers.mixins.RefreshableLayerView")],g)}(d.declared(l))})},"*now":function(n){n(['dojo/i18n!*preload*esri/views/nls/MapView*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/promise/all ../core/Handles ../core/promiseUtils ../core/workers ../core/accessorSupport/decorators ../geometry/ScreenPoint ./BreakpointsOwner ./MapViewBase ./2d/LabelManager ./2d/engine/Stage ./2d/input/MapViewInputManager ./2d/layers/support/GraphicsView2D ./2d/navigation/MapViewNavigation ./2d/support/HighlightOptions ./support/screenshotUtils ./ui/2d/DefaultUI2D".split(" "),function(n,m,h,a,l,
d,k,g,f,b,e,c,t,p,v,r,q,u,A,z){return function(c){function e(a){a=c.call(this,a)||this;a._graphicsView=null;a._mapViewHandles=new d;a._stage=null;a.highlightOptions=new u;a.inputManager=new v({view:a});a.mapViewNavigation=null;a.ui=new z;a.rendering=!1;g.initialize();return a}h(e,c);Object.defineProperty(e.prototype,"interacting",{get:function(){return this.mapViewNavigation&&this.mapViewNavigation.interacting||!1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"resolution",{get:function(){return this.state?
this.state.resolution:null},enumerable:!0,configurable:!0});e.prototype.hitTest=function(a,c){var d;d=null!=a&&a.x?a:new b({x:a,y:c});if(!this._setup||isNaN(d.x)||isNaN(d.y))return k.resolve({screenPoint:d,results:[]});var e=this.toMap(d);a=[this._graphicsView];a.push.apply(a,this.allLayerViews.toArray().reverse());return l(a.map(function(a){return a&&a.hitTest?a.hitTest(d.x,d.y):null})).then(function(a){return{screenPoint:d,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:e,
graphic:a}})}})};e.prototype.takeScreenshot=function(a){return this._setup?this._stage.takeScreenshot(A.toRenderSettings(a,this)):k.reject("Map view cannot be used before it is ready")};e.prototype.on=function(a,b,c){var d=this.inputManager&&this.inputManager.viewEvents.register(a,b,c);return d?d:this.inherited(arguments)};e.prototype.hasEventListener=function(a){return this.inherited(arguments)||this.inputManager&&this.inputManager.viewEvents.hasHandler(a)};e.prototype.destroyLayerViews=function(){this.inherited(arguments);
this._stage&&(this._stage.destroy(),this._stage=null)};e.prototype._startup=function(){var a=this;this.inherited(arguments);var b=new p(this.surface),c=new r({view:this,graphics:this.graphics}),d=new q({view:this,animationManager:this.animationManager}),e=new t.default({view:this});this._stage=b;this._graphicsView=c;this._set("mapViewNavigation",d);this._set("labelManager",e);this._mapViewHandles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),b.on("post-render",function(){return a._set("rendering",
a.allLayerViews.some(function(a){return!0===a.rendering}))}),this.watch("stationary",function(a){return b.stationary=a},!0),this.watch("state.viewpoint",function(c){return b.state=a.state},!0)]);b.state=this.state;this._updateStageChildren()};e.prototype._tearDown=function(){this._setup&&(this._graphicsView.destroy(),this._mapViewHandles.removeAll(),this._stage.destroy(),this.mapViewNavigation.destroy(),this._graphicsView=this._stage=null,this.labelManager.destroy(),this._set("labelManager",null),
this._set("mapViewNavigation",null),this.inherited(arguments))};e.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(function(a){return null!=a.container}).forEach(function(b,c){a._stage.addChildAt(b.container,c)});this._stage.addChild(this._graphicsView.container)};a([f.property({type:u})],e.prototype,"highlightOptions",void 0);a([f.property({readOnly:!0})],e.prototype,"inputManager",void 0);a([f.property({readOnly:!0})],e.prototype,"mapViewNavigation",
void 0);a([f.property({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],e.prototype,"interacting",null);a([f.property({type:z})],e.prototype,"ui",void 0);a([f.property({readOnly:!0})],e.prototype,"rendering",void 0);a([f.property({dependsOn:["state.resolution"],readOnly:!0})],e.prototype,"resolution",null);return e=a([f.subclass("esri.views.MapView")],e)}(f.declared(c,e))});
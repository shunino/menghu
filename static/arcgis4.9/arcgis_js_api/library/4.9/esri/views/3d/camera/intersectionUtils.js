// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.9/esri/copyright.txt for details.
//>>built
define("require exports ../../../geometry/Point ../../../geometry/support/aaBoundingRect ../lib/gl-matrix ../support/earthUtils ../webgl-engine/lib/Selector".split(" "),function(y,k,u,v,f,m,w){function l(a,b){return a.renderCoordsHelper.fromRenderCoords(b,n,a.basemapTerrain.spatialReference)?a.basemapTerrain.getElevation(n)||0:0}function p(a,b,e){if(!a.state.isGlobal)return!1;var d=l(a,b);a=a.stateManager.constraintsManager.nearFarHeuristic.compute(b,e,a.dataExtent,d,x).far;a*=a;return f.vec3d.dist2(b,
e)>a}function q(a,b,e,d){void 0===d&&(d=f.vec3d.create());var c=r[a.viewingMode];c||(c=new w(a.viewingMode),c.enableBackfacesTerrain=!a.state.isGlobal,c.enableInvisibleTerrain=!0,r[a.viewingMode]=c);var g=a.state.isGlobal;if(a.sceneIntersectionHelper.pickPointFromSegment(b,e,d,c)&&!p(a,b,d))return d;c=f.vec3d.direction(e,b,h);if(!a.renderCoordsHelper.intersectManifold(b,c,0,d)||p(a,b,d))g?(a=d,g=f.vec3d.dot(b,b)-m.earthRadius*m.earthRadius,g=0<g?Math.sqrt(g)/3:1,f.vec3d.subtract(e,b,a),f.vec3d.scale(a,
g/f.vec3d.length(a),a),f.vec3d.add(a,b)):e!==d&&f.vec3d.set(e,d);return d}Object.defineProperty(k,"__esModule",{value:!0});k.eyeWithinExtent=function(a,b,e,d){return a.renderCoordsHelper.fromRenderCoords(b.eye,t,d)&&v.containsPoint(e,t)};k.surfaceElevationBelowEye=function(a,b){return l(a,b.eye)};k.surfaceElevationBelowRenderPoint=l;k.cameraOnContentAlongViewDirection=function(a,b,e,d){var c=a.state.camera.copy();b&&(c.eye=b);e&&(c.center=e);d&&(c.up=d);q(a,c.eye,c.center,g);e=a.state.constraints;
d=e.minimumPoiDistance;f.vec3d.dist2(c.eye,g)<d&&(b=e.collision.enabled,f.vec3d.set(c.viewForward,h),f.vec3d.scale(h,d),b?f.vec3d.subtract(g,h,c.eye):f.vec3d.add(c.eye,h,g),a=a.renderCoordsHelper,d=a.getAltitude(c.eye),e=e.collision.elevationMargin,b&&d<e&&(f.vec3d.subtract(g,c.eye,h),a.setAltitude(e,c.eye),f.vec3d.add(c.eye,h,g)));c.center=g;return c};k.contentAlongViewDirection=q;var r={},t=f.vec3d.create(),g=f.vec3d.create(),n=new u,h=f.vec3d.create(),x={near:0,far:0}});
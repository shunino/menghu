// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.9/esri/copyright.txt for details.
//>>built
define("require exports ./resources/SimpleAtmosphereTexture ../lib/gl-matrix ../support/imageUtils ../support/buffer/glUtil ../support/buffer/InterleavedLayout ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/Util ../webgl-engine/shaders/SimpleAtmospherePrograms ../../webgl/BufferObject ../../webgl/programUtils ../../webgl/Texture ../../webgl/Util ../../webgl/Util ../../webgl/VertexArrayObject".split(" "),function(h,E,q,k,r,t,u,v,w,
x,l,m,y,z,A,B,C,D){h=function(){function e(c){this.needsRender=!1;this.didRender=!0;this.slot=x.POSTPROCESSING_ATMOSPHERE_OPAQUE;this.view=c}e.prototype.destroy=function(){this._program&&(this._program.dispose(),this._program=null);this._texture&&(this._texture.dispose(),this._texture=null)};e.prototype.when=function(c){return this._readyPromise.then(c)};e.prototype.initializeRenderContext=function(c){var a=this,b=c.rctx;this._program=z.createProgram(b,m.colorPass,{panoramic:!0});this._vao=this._createVertexArrayObject(b);
this._vaoCount=C.vertexCount(this._vao,"geometry");this._readyPromise=r.requestImage(q).then(function(b){a._texture=new A(c.rctx,{pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0},b);a.needsRender=!0})};e.prototype.uninitializeRenderContext=function(c){this.destroy()};e.prototype.render=function(c){if(c.slot!==this.slot||c.pass!==w.MATERIAL||null==this._texture)return!1;var a=c.rctx,b=this._program;a.bindProgram(b);a.bindTexture(this._texture);b.setUniform1i("tex",0);b.setUniformMatrix4fv("proj",
c.camera.projectionMatrix);k.mat4d.toRotationMat(c.camera.viewMatrix,n);b.setUniformMatrix4fv("view",n);b.setUniform4f("color",1,1,1,1);b.setUniform3fv("lightDirection",c.lightingData.direction);a.setDepthTestEnabled(!0);a.setFaceCullingEnabled(!0);a.setDepthFunction(515);a.setBlendingEnabled(!0);a.setDepthWriteEnabled(!1);a.bindVAO(this._vao);B.assertCompatibleVertexAttributeLocations(this._vao,b);a.drawArrays(4,0,this._vaoCount);a.setDepthWriteEnabled(!0);a.setBlendingEnabled(!1);a.setDepthFunction(513);
a.setFaceCullingEnabled(!1);return!0};e.prototype._createVertexArrayObject=function(c){for(var a=v.createPolySphereGeometry(1,2,!1),b=a.indices[l.VertexAttrConstants.POSITION],d=0;d<b.length;d+=3){var e=b[d];b[d]=b[d+2];b[d+2]=e}for(var a=a.vertexAttributes[l.VertexAttrConstants.POSITION].data,e=p.createBuffer(b.length),f=e.position,d=0;d<b.length;++d){var g=3*b[d];f.set(d,0,a[g]);f.set(d,1,a[g+1]);f.set(d,2,a[g+2])}return new D(c,m.colorPass.attributes,{geometry:t.glLayout(p)},{geometry:y.createVertex(c,
35044,e.buffer)})};return e}();var n=k.mat4d.create(),p=u.newLayout().vec3f("position");return h});